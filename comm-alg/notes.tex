\documentclass[12pt]{article}
\usepackage[lmargin=1in,rmargin=1in,tmargin=1in,bmargin=1in]{geometry}

\def\univname{}
\def\coursenum{}
\def\coursename{Commutative Algebra Notes}
\def\professor{}
\def\student{Aryaman Maithani}
\def\semesteryear{}
\def\imagename{}		  
\def\scalesize{0.20}
\usepackage{aryaman}
\setcounter{tocdepth}{2}

\begin{document}
\coverpage
\thispagestyle{empty}
\updated{\today}
\thispagestyle{empty}
% \setcounter{tocdepth}{1}
\tableofcontents
\pagestyle{fancy}
\setcounter{page}{1}
% \setcounter{section}{-1}

\section{Artinian and Noetherian rings}

We assume basic results about Artinian and Noetherian rings. We prove some others.

\subsection{Primary decompositions}

\subsection{Artinian rings}

\begin{prop}
	Let $R$ be a ring, and $I \subset R$ an ideal. Let $M$ be an $R$-module such that $IM = 0$. Equivalently, $M$ is an $R/I$-module.

	Then, $M$ is Artinian (resp. Noetherian) as an $R$-module if it is so as an $R/I$-module.
\end{prop}
\begin{proof} 
	Check that the family of submodules is the same in both cases.
\end{proof}

\begin{prop} \label{prop:artinian-noetherian-two-of-three}
	Let $0 \to N \to M \to L \to 0$ be an exact sequence of $R$-modules. The following are equivalent:
	\begin{enumerate}
		\item $M$ is Artinian (resp. Noetherian).
		\item $N$ and $L$ are Artinian (resp. Noetherian).
	\end{enumerate}
\end{prop}

\begin{cor}
	Any quotient of an Artinian ring is Artinian (as a ring).
\end{cor}

\begin{cor} \label{cor:artin-primes-maximal}
	Every prime ideal in an Artinian ring is maximal. In other words, the (Krull) dimension of an Artinian ring is zero.
\end{cor}

Since it is convenient to refer to this, we make a special definition of dimension now. We have an elaborate discussion of dimension later.

\begin{defn}
	A ring $R$ is said to be of \deff{dimension zero}, denoted $\dim(R) = 0$, if every prime ideal of $R$ is maximal.
\end{defn}

\begin{prop}
	An Artinian ring has finitely many prime (maximal) ideals.
\end{prop}
\begin{proof} 
	Suppose not. Let $\mathfrak{m}_{1}, \mathfrak{m}_{2}, \ldots$ be a sequence of distinct prime (and hence, maximal) ideals. Note that the chain
	\begin{equation*} 
		\mathfrak{m}_{1} \supset \mathfrak{m}_{1} \cap \mathfrak{m}_{2} \supset \cdots
	\end{equation*}
	must stabilise. Thus, there exists $n$ such that
	\begin{equation*} 
		\mathfrak{m}_{1} \cap \cdots \cap \mathfrak{m}_{n} = \mathfrak{m}_{1} \cap \cdots \cap \mathfrak{m}_{n} \cap \mathfrak{m}_{n + 1}.
	\end{equation*}
	Note that the ideal on the right is contained in $\mathfrak{m}_{n + 1}$. Thus, $\mathfrak{m}_{n + 1}$ contains the intersection on the left. But then, since $\mathfrak{m}_{n + 1}$ is prime, it must contain some $\mathfrak{m}_{i}$ with $i \le n$. This contradicts that $\mathfrak{m}_{i}$ and $\mathfrak{m}_{n + 1}$ are distinct maximal ideals.
\end{proof}

\begin{prop}
	Let $R$ be a field, and $M$ an $R$-module, i.e., an $R$-vector space. Then, $M$ is Noetherian iff $M$ is Artinian (iff $\dim_{R}(M) < \infty$).
\end{prop}

\begin{prop}
	Let $M$ be an $R$-module. Suppose there exists a filtration of submodules
	\begin{equation*} 
		0 = M_{0} \subset M_{1} \subset M_{2} \subset \cdots \subset M_{n} = M
	\end{equation*}
	such that each $M_{i + 1}/M_{i}$ is Artinian (resp. Noetherian). Then, $M$ is Artinian (resp. Noetherian).

	Conversely, if $M$ is an Artinian (resp. Noetherian) module and we have a filtration as above, then each $M_{i + 1}/M_{i}$ is Artinian (resp. Noetherian).
\end{prop}
\begin{proof} 
	By hypothesis, $M_{1} \cong M_{1}/M_{0}$ is Artinian (resp. Noetherian). The exact sequence
	\begin{equation*} 
		0 \to M_{1} \to M_{2} \to M_{2}/M_{1}
	\end{equation*}
	shows the same for $M_{2}$. Induct.

	The converse is again an easy consequence of \Cref{prop:artinian-noetherian-two-of-three}.
\end{proof}

\begin{cor} \label{cor:annihilated-maximals-artinian-noetherian}
	Let $R$ be any ring, and $M$ an $R$-module. Let $\mathfrak{m}_{1}, \ldots, \mathfrak{m}_{n}$ be maximal ideals of $R$ (not necessarily distinct) such that $\mathfrak{m}_{1} \cdots \mathfrak{m}_{n} M = 0$.

	Then, $M$ is Noetherian iff $M$ is Artinian.
\end{cor}
\begin{proof} 
	Consider the filtration
	\begin{equation*} 
		0 = \mathfrak{m}_{1} \cdots \mathfrak{m}_{n} M \subset \mathfrak{m}_{1} \cdots \mathfrak{m}_{n - 1} M \subset \cdots \subset \mathfrak{m}_{1} M \subset M.
	\end{equation*}
	Note that $\mathfrak{m}_{1} \cdots \mathfrak{m}_{i} M/\mathfrak{m}_{1} \cdots \mathfrak{m}_{i + 1} M$ is an $R/\mathfrak{m}_{i + 1}$-module. 

	Now use the previous two propositions.
\end{proof}

\begin{prop}
	Let $R$ be an Artinian ring. The nilradical $\mathcal{N}$ is nilpotent, i.e., $\mathcal{N}^{k} = 0$ for some $k \ge 0$.
\end{prop}
\begin{proof} 
	The descending chain of powers of $\mathcal{N}$ must stabilise to some $\mathcal{N}^{k}$. We claim $\mathcal{N}^{k} = 0$. 

	Suppose not. Let $I \vcentcolon= \mathcal{N}^{k}$. By hypothesis, $I I = I \neq 0$. Thus, by the Artinian condition, we may pick $J$ minimal with respect to the property that $IJ \neq 0$.

	Thus, there exists $z \in J$ with $Iz \neq 0$. But also, $I(Iz) = Iz \neq 0$. \newline
	Since $Iz \subset (z) \subset J$, minimality forces $Iz = (z)$. Thus, we can write $z = xz$ for some $x \in I$. Thus, we have $z = xz = x^{2} z = x^{3} z = \cdots$. \newline
	But $x$ is nilpotent, since $I \subset \mathcal{N}$. Thus, $z = 0$, contradicting that $Iz \neq 0$.
\end{proof}

\begin{cor} \label{cor:artin-local-nilpotent-maximal}
	If $(R, \mathfrak{m})$ is an Artinian local ring, then $\mathfrak{m}$ is nilpotent.
\end{cor}
\begin{proof} 
	By \Cref{cor:artin-primes-maximal}, all primes of $R$ are maximal and there is only one such maximal ideal. Thus, the nilradical of $R$ is $\mathfrak{m}$.
\end{proof}

\begin{cor}
	Any Artinian ring is Noetherian.
\end{cor}
\begin{proof} 
	Let $R$ an an Artinian ring. Note that $\mathcal{N} = \bigcap_{\mathfrak{p} \in \Spec R} \mathfrak{p}$. Since $R$ is Artinian, $\mathcal{N}$ is the intersection of all the finitely many maximal ideals of $R$. \newline
	But this is just the product $\prod \mathfrak{m}_{i}$ since the ideals are comaximal. In turn, $\mathcal{N}^{k}$ is a product of maximal ideals. Now use \Cref{cor:annihilated-maximals-artinian-noetherian}.
\end{proof}

\begin{cor} \label{cor:artinian-noetherian-dimension-zero}
	Let $R$ be a ring. The following are equivalent:
	\begin{enumerate}[label=(\roman*)]
		\item $R$ is Artinian.
		\item $R$ is Noetherian and $\dim(R) = 0$.
	\end{enumerate}
\end{cor}
\begin{proof} 
	(i) $\Rightarrow$ (ii) follows from earlier.

	(ii) $\Rightarrow$ (iii): Since $R$ is Noetherian, $R$ has finitely many minimal primes. Since $\dim(R) = 0$, all of these are maximal as well. Since every prime contains a minimal prime, it follows that there are only finitely many primes. Then, we have $\mathcal{N} = \bigcap_{i} \mathfrak{p}_{i} = \prod_{i} \mathfrak{p}_{i}$. But in a Noetherian ring, the nilradical is nilpotent and thus, $\mathcal{N}^{k} = 0$ for some $k$. Using \Cref{cor:annihilated-maximals-artinian-noetherian}, we get that $R$ is Artinian.
\end{proof}

\section{Valuation rings}

\subsection{Definitions}

\begin{defn}
	A \deff{valuation ring} is an integral domain $R$ such that for all $a, b \in R$: either $a$ divides $b$ or $b$ divides $a$.

	Equivalently, the set of principal ideals is totally ordered by inclusion.

	Equivalently, if $K = \Frac(R)$, then for every $x \in K^{\times}$, either $x \in R$ or $x^{-1} \in R$.
\end{defn}

Recall that a totally ordered abelian group is an abelian group $(A, +)$ with a total order $\le$ such that $x \le y \Rightarrow x + z \le y + z$ for all $x, y, z \in A$. \newline
We often consider the ordered set $A_{\infty} \vcentcolon= A \sqcup \{\infty\}$, this extends the order from $A$ by defining $a < \infty$ for all $a \in A$.

\begin{defn}
	Let $K$ be a field, and $A$ a totally ordered abelian group. A \deff{valuation} is a map
	\begin{equation*} 
		\nu : K \to A \sqcup \{\infty\}
	\end{equation*}
	such that
	\begin{itemize}
		\item $\nu(0) = \infty$,
		\item $\nu(K^{\times}) \subset A$,
		\item $\nu(xy) = \nu(x) + \nu(y)$ for all $x, y \in K^{\times}$,
		\item $\nu(x + y) \ge \min(\nu(x), \nu(y))$ for all $x, y \in K$.
	\end{itemize}
\end{defn}
Note that the third point is simply stating that $\nu$ is a group homomorphism when restricted to $K^{\times} \to A$. We often just specify valuations by defining them on $K^{\times}$.

\begin{obs}
	Since $\nu$ is a group homomorphism, we have $\nu(1) = 0$ and $\nu(x^{-1}) = -\nu(x)$ for $x \in K^{\times}$.
\end{obs}

\begin{prop}
	Let $R$ be an integral domain, and $K = \Frac(R)$. The following are equivalent:
	\begin{enumerate}[label=(\roman*)]
		\item $R$ is a valuation ring.
		\item There exists a totally ordered abelian group $A$ and a valuation $\nu : K \to A_{\infty}$ such that $R = \{x \in K : \nu(x) \ge 0\}$.
	\end{enumerate}
\end{prop}
\begin{proof} 
	We prove the nontrivial direction, namely (i) $\Rightarrow$ (ii).

	Assume that $R$ is a valuation ring. Define a preorder on $K^{\times}$ as follows: $x \le y$ iff $y/x \in R$. By hypothesis, any two elements are comparable. \newline
	Define the equivalence relation $\sim$ on $K^{\times}$ as $x \sim y$ iff $x \le y$ and $y \le x$. \newline
	Let $A \vcentcolon= K^{\times}/{\sim}$. Note that we can define multiplication on $A$ by $[x] \cdot [y] = [xy]$. (Check that this is well-defined.) \newline
	The map $\nu : K^{\times} \to A$ defined by $x \mapsto [x]$ does the job. 
\end{proof}

In view of the above proposition, whenever we talk about a valuation ring $R$, we always have an associated valuation with it. Proceeding forward, $K$ will denote the fraction field of $R$. We have the relation $R = \{x \in K : \nu(x) \ge 0\}$. \newline
For $x, y \in R$, we see that $x \mid y$ is equivalent to $\nu(x) \le \nu(y)$.

\begin{prop}
	Any valuation ring $R$ is normal.
\end{prop}
\begin{proof} 
	Let $x \in K$ be integral over $R$. We wish to show $\nu(x) \ge 0$. Write
	\begin{equation*} 
		x^{n} = a_{n - 1} x^{n - 1} + \cdots + a_{1} x + a_{0}
	\end{equation*}
	for $a_{i} \in R$. Applying $\nu$, we get
	\begin{equation*} 
		n \nu(x) \ge \min(\nu(a_{n - 1}) + (n - 1) \nu(x), \ldots, \nu(a_{0})).
	\end{equation*}
	Thus, there exists some $i \in \{0, \ldots, n - 1\}$ such that $n \nu(x) \ge \nu(a_{i}) + i \nu(x)$. Thus, $(n - i) \nu(x) \ge \nu(a_{i}) \ge 0$. This proves the result.
\end{proof}

\begin{prop}
	Any valuation ring $R$ is normal. The unique maximal ideal is given by $\{x\in R : \nu(x) > 0\} = \{x \in K : \nu(x) > 0\}$.
\end{prop}
\begin{proof} 
	Let $\mathfrak{m} \vcentcolon= \{x \in R : \nu(x) > 0\}$. The properties of valuation imply that $\mathfrak{m}$ is indeed an ideal. $\mathfrak{m}$ is proper since $\nu(1) = 0$ and thus, $1 \notin \mathfrak{m}$.

	On the other hand, if $x \in R \setminus \mathfrak{m}$, then $\nu(x) = 0$. This means that $x^{-1} \in K$ also satisfies $\nu(x^{-1}) = -\nu(x) = 0$ and thus, $x^{-1} \in R$, i.e., $x$ is a unit.
\end{proof}

\begin{thm}
	Let $R$ be a domain, not necessarily a valuation ring. \newline
	Let $\mathfrak{p} \in \Spec R$, and $K = \Frac(R)$. \newline
	Then, there exists a valuation ring $V$ such that
	\begin{itemize}
		\item $R \subset V \subset K$,
		\item the maximal ideal of $V$ contracts to $\mathfrak{p}$.
	\end{itemize}
	In particular, if $\nu$ is the associated valuation to $V$, we have $\mathfrak{p} = \{x \in R : \nu(x) > 0\}$.
\end{thm}
\begin{proof} 
	Throughout this proof, localisations of $R$ (and of other subrings of $K$) will be considered as subrings of $K$ in the natural way.

	Let $\Sigma$ denote the collection of intermediate subrings $R$': $R_{\mathfrak{p}} \subset R' \subset K$ such that $\mathfrak{p} R' \neq R'$. 

	$\Sigma$ is nonempty since $R_{\mathfrak{p}} \in \Sigma$. Ordering $\Sigma$ by inclusion, we note that $\Sigma$ satisfies the hypothesis of Zorn's Lemma\footnote{Note that $1 \in \mathfrak{p}R'$ is a ``finite condition''.} and thus, there exists a maximal $V$. We show that $V$ has the desired properties.

	\claim{1} $V$ is local. 
	\begin{proof} 
		By construction, $\mathfrak{p}V \neq V$. Thus, $\mathfrak{p}V$ is contained in some maximal ideal $\mathfrak{m} \subset V$. In turn, $\mathfrak{p} V_{\mathfrak{m}}$ is a proper subset of $V_{m}$ and hence, $V_{\mathfrak{m}} \in \Sigma$. By maximality, we must have $V = V_{\mathfrak{m}}$, proving that $V$ is a local ring.
	\end{proof}

	Going forth, let $\mathfrak{m}$ denote the maximal ideal of $V$. Note that $\mathfrak{p} V \subset \mathfrak{m}$. In particular, intersecting with $R_{\mathfrak{p}}$ shows that
	\begin{equation*} 
		\mathfrak{p} V \cap R_{\mathfrak{p}} = \mathfrak{m} \cap R_{\mathfrak{p}}.
	\end{equation*}
	But $\mathfrak{p} R_{\mathfrak{p}}$ is clearly contained in the left ideal. Thus, we have
	\begin{equation*} 
		\mathfrak{p} R_{\mathfrak{p}} = \mathfrak{m} \cap R_{\mathfrak{p}}.
	\end{equation*}
	Further contracting to $R$ gives us
	\begin{equation*} 
		\mathfrak{p} = \mathfrak{m} \cap R.
	\end{equation*}
	Thus, we now only need to prove that $V$ is a valuation ring.

	\claim{2} $V$ is normal.
	\begin{proof} 
		Let $x \in K$ be integral over $V$. Showing $x \in V$ is equivalent to saying $V = V[x]$. Using maximality of $V$ in $\Sigma$, it suffices to prove that $V[x] \in \Sigma$.

		Note that $V \into V[x]$ is an integral extension. Thus, there is a prime $\mathfrak{m}' \subset V[x]$ lying over $V$. In particular, $\mathfrak{p} \subset \mathfrak{m}'$ showing that $\mathfrak{p} V[x] \neq V[x]$.
	\end{proof}

	We are now ready to show that $V$ is a valuation ring. Let $x \in K^{\times}$ with $x \notin V$. We need to show that $x^{-1} \in V$. \newline
	
	Consider the subring $V[x]$. This is strictly larger than $V$. By maximality, we must have that $V[x] \notin \Sigma$ and thus, $1 \in \mathfrak{p} V[x]$. We can then write
	\begin{equation*} 
		1 = p_{0} + p_{1} x + \cdots + p_{t} x^{t}
	\end{equation*}
	for some $p_{i} \in \mathfrak{p} V$.

	Rearrange the above to get
	\begin{equation*} 
		1 - p_{0} = p_{1} x + \cdots + p_{t} x^{t}.
	\end{equation*}
	Note that $p_{0} \in \mathfrak{p} V \subset \mathfrak{m}$ and thus, $1 - p_{0}$ is a unit in $V$. Thus, we can write
	\begin{equation*} 
		\frac{1}{x^{t}} = \frac{1}{1 - p_{0}}\left(\frac{p_{1}}{x^{t - 1}} + \cdots + p_{t}\right).
	\end{equation*}
	The above shows that $x^{-1}$ is integral over $V$. By Claim 2, it follows that $x^{-1} \in V$, as desired.
\end{proof}

\begin{cor}
	Let $R$ be an integral domain, and let $\mathfrak{q} \subset \mathfrak{p}$ be primes. There exists a valuation ring $V$ and a ring homomorphism $f : R \to V$ such that $f^{-1}(\mathfrak{m}_{V}) = \mathfrak{p}$ and $f^{-1}(0) = \mathfrak{q}$. \newline
	($\mathfrak{m}_{V}$ denotes the maximal ideal of $V$.)
\end{cor}
\begin{proof} 
	Applying the previous proposition to $R/\mathfrak{q}$, there exists a valuation ring $V$ and an injection $g : R/\mathfrak{q} \into V$ such that $g^{-1}(\mathfrak{m}_{V}) = \mathfrak{p}/\mathfrak{q}$ (and necessarily $g^{-1}(0) = 0$). \newline
	Compose this with the projection $R \onto R/\mathfrak{q}$.
\end{proof}

\begin{cor}
	If $R$ is a normal domain, then
	\begin{equation*} 
		R = \bigcap_{\substack{R \subset V \subset K \\ V \text{ is a valuation ring}}} V.
	\end{equation*}
	More generally, if $R$ is any integral domain, and $\overline{R}$ is its integral closure in $K$, then
	\begin{equation*} 
		\overline{R} = \bigcap_{\substack{R \subset V \subset K \\ V \text{ is a valuation ring}}} V.
	\end{equation*}
\end{cor}
\begin{proof} 
	Note that since valuation rings are integrally closed, it follows that $\overline{R}$ is contained the intersection. 

	Conversely, suppose $x$ belongs to the intersection. This means that $\nu(x) \ge 0$ for every valuation $\nu$ on $K$. We must show that $x$ is integral over $R$.

	Let $R' = R\left[\frac{1}{x}\right]$ and $I = \left(\frac{1}{x}\right) R'$. 

	\claim{} $I = R'$.
	\begin{proof} 
		If not, then $I \subset \mathfrak{m}$ for some maximal ideal $\mathfrak{m} \subset R'$. By the previous proposition, there exists a valuation ring $V \supset R'$ such that $x^{-1} \in \mathfrak{m}_{V}$. This implies that $\nu(x) = -\nu(x^{-1}) > 0$. A contradiction.
	\end{proof}

	Thus, $I = R'$. In other words, $1/x$ is a unit in $R'$ and hence, $x \in R'$. This means we can write
	\begin{equation*} 
		x = r_{0} + \frac{r_{1}}{x} + \cdots + \frac{r_{n}}{x^{n}}
	\end{equation*}
	for some $r_{i} \in R$. Multiplying with $x^{n}$ shows that $x$ satisfies a monic polynomial over $R$, as desired.
\end{proof}

\begin{prop} \label{prop:valuation-local-bezout}
	Let $R$ be an integral domain. The following are equivalent:
	\begin{enumerate}[label=(\roman*)]
		\item $R$ is a valuation ring.
		\item $R$ is a local B\'ezout domain. (That is, $R$ is a local ring, where every finitely generated ideal is principal.)
	\end{enumerate}
\end{prop}
\begin{proof} 
	(i) $\Rightarrow$ (ii): Suppose $R$ is a valuation ring. We have already seen that $R$ is local. Let $I = (f_{1}, \ldots, f_{n})$ be a finitely generated ideal. By definition of a valuation ring, we may pick a maximal ideal among the principal ideals $(f_{1}), \ldots, (f_{n})$. Then, $I$ is equal to that principal ideal.

	(ii) $\Rightarrow$ (i): Let $x, y \in R$ be nonzero. We wish to show that either $x \mid y$ or $y \mid x$. \newline
	By hypothesis, we can write $(x, y) = (d)$ for some $d \in R$. In turn, we have the relations
	\begin{equation*} 
		x = dx',\, y = dy',\, d = ax + by,
	\end{equation*}
	for some $a, b, x', y' \in R$. 

	Plugging the first two relations in the last gives us
	\begin{equation*} 
		d = (ax' + by')d.
	\end{equation*}
	We may cancel $d$ to see that $(x', y') = (1)$. Since $R$ is a local ring, this implies that one of $x'$ or $y'$ is a unit. Without loss of generality, $x'$ is a unit (in $R$).

	Then, we have
	\begin{equation*} 
		y = dy' = \frac{y'}{x'} x. \qedhere
	\end{equation*}
\end{proof}

\subsection{Discrete Valuation Rings}

\begin{defn}
	A valuation $\nu : K \to A_{\infty}$ is said to be a \deff{discrete valuation} if $\nu(K^{\times})$ is isomorphic to $\mathbb{Z}$.

	A \deff{discrete valuation ring (DVR)} is a ring that is of the form $\{x \in K : \nu(x) \ge 0\}$ for some discrete valuation $\nu : K \to A_{\infty}$.
\end{defn}
Note that the trivial valuation is not a discrete valuation. Equivalently, a field is not a discrete valuation ring. \newline
Note that given a discrete valuation, we may always assume that $A = \mathbb{Z}$ and that $\nu(x) \neq 0$ for some $x \in K$.

\begin{prop} \label{prop:valuation-noetherian}
	Let $R$ be a valuation ring. The following are equivalent.
	\begin{enumerate}[label=(\roman*)]
		\item $R$ is Noetherian.
		\item $R$ is a DVR or a field.
		\item $R$ is a local PID.
	\end{enumerate}
	((ii) and (iii) are equivalent even without the a priori assumption that $R$ is a valuation ring. See \Cref{cor:local-PID-DVR})
\end{prop}
\begin{proof} 
	Let $\nu : K \to A_{\infty}$ and $\mathfrak{m} \subset R$ be as usual

	(i) $\Leftrightarrow$ (iii) is clear by \Cref{prop:valuation-local-bezout}.

	(iii) $\Rightarrow$ (ii): Assume $R$ is a local PID and not a field. \newline
	By hypothesis, we have $\mathfrak{m} = (x)$ with $0 < \nu(x) < \infty$. In turn,
	\begin{equation*} 
		\nu(x) = \min\{\nu(r) : r \in K,\, \nu(r) > 0\}.
	\end{equation*}
	(The above follows since $\nu(r) > 0 \Rightarrow r \in \mathfrak{m} = (x) \Rightarrow x \mid r$.) \newline
	In other words, $\nu(x)$ is the smallest positive valuation.

	We show that $\nu(K^{\times})$ is generated by $\nu(x)$. Let $y \in K^{\times}$ be arbitrary. We may assume $y$ is not a unit. By replacing $y$ with $y^{-1}$, we may assume that $\nu(y) > 0$ and hence, $y \in R$. 

	Consider the following subsets of $K$:
	\begin{equation*} 
		y R \subsetneq \frac{y}{x} R \subsetneq \frac{y}{x^{2}} R \subsetneq \cdots.
	\end{equation*}
	Note that as long as $y/x^{n} \in R$, the set $(y/x^{n}) R$ is an ideal of $R$. Since $R$ is Noetherian, the chain must eventually escape $R$, i.e., there exists $n \ge 0$ such that $y/x^{n + 1} \notin R$. Choose the smallest such $n$. Then, we have
	\begin{equation*} 
		\nu(y/x^{n}) \ge 0 > \nu(y/x^{n + 1}).
	\end{equation*}
	If $\nu(y/x^{n}) = 0$, then we are done since we have $\nu(y) = n \nu(x)$. If this is not the case, then we have strict inequalities above, which gives
	\begin{equation*} 
		\nu(y/x^{n}) > 0 > \nu(y/x^{n + 1}).
	\end{equation*}
	Rearranging gives
	\begin{equation*} 
		\nu(x) > \nu(x^{n + 1}/y) > 0.
	\end{equation*}
	But this contradicts that $x$ had smallest positive valuation.

	(ii) $\Rightarrow$ (i): Clearly we may assume that $R$ is a DVR. Let $\nu : K \to \mathbb{Z}_{\infty}$ be the associated valuation. Consider the ideals $I_{n}$ defined as
	\begin{equation*} 
		I_{n} \vcentcolon= \{x \in R : \nu(x) \ge n\},
	\end{equation*}
	for $n \ge 0$. ($I_{n}$ is an ideal by properties of valuation.)

	We claim that any nonzero ideal in $R$ is of the form. Indeed, given a nonzero ideal $J$, let $n \ge 0$ and $x \in J$ be such that $\nu(x) = n$ is the smallest valuation among elements of $J$. \newline
	In particular, $J \subset I_{n}$. Conversely, if $y \in I_{n}$, then $\nu(x) \le \nu(y)$ shows that $x \mid y$ in $R$ and hence, $y \in (x) \subset J$.

	Thus, the ideals of $R$ all appear in the following chain:
	\begin{equation*} 
		I_{0} \supset I_{1} \supset I_{2} \supset \cdots \supset 0.
	\end{equation*}
	It follows that $R$ is Noetherian.
\end{proof}

Note that if $\nu : K \to \mathbb{Z}_{\infty}$ is a valuation, then $\nu(K^{\times})$ is a nonzero subgroup of $\mathbb{Z}$ and thus, of the form $n \mathbb{Z}$ for some $n > 0$. This gives us a new valuation $\nu' : K \to \mathbb{Z}_{\infty}$ defined by $\nu'(x) = \nu(x)/n$. \newline
Both of these define the same valuation ring. Thus, we may always assume that a discrete valuation surjects onto $\mathbb{Z}_{\infty}$.

From the last part of the above proof, we extract the following.

\begin{por}[Description of ideals in DVRs]
	Let $R$ be a DVR, and $\nu : K \onto \mathbb{Z}_{\infty}$ the associated valuation. \newline
	Pick any $t \in K$ with $\nu(t) = 1$. Then, the ideals
	\begin{equation*} 
		(1), (t), (t^{2}), (t^{3}), \ldots, (0)
	\end{equation*}
	are all the distinct ideals of $R$. 

	In particular, $R$ is a local PID.
\end{por}

\begin{cor} \label{cor:local-PID-DVR}
	Let $R$ be a ring which is not a field. The following are equivalent:
	\begin{enumerate}[label=(\roman*)]
		\item $R$ is a local PID.
		\item $R$ is a DVR.
	\end{enumerate}
\end{cor}
\begin{proof} 
	In either case, we need to show that $R$ is a valuation ring and then we can appeal to \Cref{prop:valuation-noetherian}. If we assume (ii), then this follows tautologically. If we assume (i), then this follows from \Cref{prop:valuation-local-bezout}.
\end{proof}

\section{Graded rings and modules}

Going forth, we make the convention that $0 \in \mathbb{N}$.

\subsection{Graded rings and modules}

\begin{defn}
	A \deff{($\mathbb{N}$-)graded ring} is a ring $R$ with a sequence of additive subgroups $\langle R_{n} \rangle_{n \ge 0}$ such that
	\begin{equation*} 
		R = \bigoplus_{n \ge 0} R_{n} \andd R_{m} R_{n} \subset R_{m + n}
	\end{equation*}
	for all $n, m \ge 0$.

	Elements of $R_{0} \cup R_{1} \cup \cdots$ are called \deff{homogeneous elements}. A nonzero homogeneous element $x$ belongs to $R_{n}$ for some unique $n$, this is called the \deff{degree} of $x$.

	$R_{+} \vcentcolon= \bigoplus_{n \ge 1} R_{n}$ is an ideal of $R$, called the \deff{irrelevant ideal}.
\end{defn}

Note that $0 \in R_{n}$ for all $n$. There is some care that must be taken when defining the degree of $0$. We do not bother about it and leave the edge cases to the reader.

Note that being graded is not a property of a ring. Rather, it consists of additional data given to a ring. (In contrast to something like how being a field is a property of a ring.) \newline
However, we still often say ``$R$ is a graded ring'' and tacitly assume that we are given a \emph{grading} $\langle R_{n} \rangle_{n \in \mathbb{N}}$.

\begin{defn}
	Let $R$ be a graded ring. A \deff{graded $R$-module} is an $R$-module $M$ with a sequence of additive subgroups $\langle M_{n} \rangle_{n \in \mathbb{Z}}$ such that
	\begin{equation*} 
		M = \bigoplus_{n \in \mathbb{Z}} M_{n} \andd R_{m} M_{n} \subset M_{m + n}
	\end{equation*}
	for all $n, m \ge 0$.

	A \deff{homogeneous element} and its \deff{degree} is defined as before.
\end{defn}

\begin{prop}
	Let $R$ be a graded ring, and $M$ a graded $R$-module. \newline
	Then, $R_{0}$ is a subring of $R$. In particular, $1 \in R$. \newline
	Moreover, each $M_{n}$ is an $R_{0}$-module.
\end{prop}
Note that $M_{n}$ will typically \emph{not} be an $R$-module.
\begin{proof} 
	The only nontrivial thing to check is that $1 \in R$. By hypothesis, we can write
	\begin{equation} \label{eq:001}
		1 = r_{0} + r_{1} + \cdots,
	\end{equation}
	where $r_{i} \in R_{i}$ and $r_{n} = 0$ for $n \gg 0$.

	We show that $r_{i} = 0$ for all $i > 0$ and hence, $1 = r_{0} \in R_{0}$. \newline
	Multiplying \Cref{eq:001} with $r_{0}$ shows
	\begin{equation*} 
		r_{0} = r_{0}^{2} + r_{0}r_{1} + \cdots .
	\end{equation*}
	Comparing the homogeneous components on each side shows that $r_{0} r_{i} = 0$ for $i > 0$. \newline

	Now, fix $i > 0$ and multiply \Cref{eq:001} with $r_{i}$ to get
	\begin{equation*} 
		r_{i} = r_{0} r_{i} + r_{1} r_{i} + \cdots.
	\end{equation*}
	Again, comparing the homogeneous components gives
	\begin{equation*} 
		r_{i} = r_{0} r_{i}.
	\end{equation*}
	But by the earlier calculation, the element on the right is $0$. 
\end{proof}

\begin{ex}
	\begin{enumerate}
		\item If $k$ is a field, and $R = k[x_{1}, \ldots, x_{d}]$, then $R$ has a natural grading with $R_{n}$ consisting of the $k$-vector space generated by monomials of degree $n$. 
		%
		\item Let $R$ be a graded ring, and $f \in R$ be a nonzero homogeneous element. Then, $R_{f} = R[f^{-1}]$ has a natural $R$-module structure. (Note that unless $f$ is nilpotent (in which case, $R_{f} = 0$) or $\deg(f) = 0$, $R_{f}$ will have graded pieces in the negative component. Thus, $R_{f}$ is not an $\mathbb{N}$-graded ring.)
		%
		\item More generally, let $S \subset R$ be a multiplicative subset consisting of homogeneous elements. Then, $S^{-1}R$ is a graded $R$-module: $(S^{-1} R)_{n}$ consists of elements of the form $r/s$ where $r \in R$ and $s \in S$ are homogeneous with $\deg(r) - \deg(s) = n$. (If $r/s = r'/s'$ with $r'$ and $s'$ also homogeneous, it will follow that $\deg(r') - \deg(s') = n$.) 

		By the above definition, it follows that $R_{n} (S^{-1} R)_{m} \subset (S^{-1} R)_{m + n}$. In fact, it even follows that $S^{-1}R$ is a $\mathbb{Z}$-graded ring (the definition is the obvious one). 

		Even in this case, the homogeneous elements of degree $0$ form a subring of $S^{-1} R$. 

		If $\mathfrak{p} \subset R$ is a graded homogeneous prime ideal (defined just below), then one can consider $S$ to be the set of homogeneous elements not contained in $\mathfrak{p}$. This is a multiplicative subset. The $0$-degree subring of $S^{-1} R$ is sometimes denoted $R_{(\mathfrak{p})}$.	
	\end{enumerate}
\end{ex}

\begin{ex}[Rees algebra] \label{ex:rees-algebra}
	Given a ring $R$ and an ideal $I$, we can construct the \deff{Rees algebra} as follows: \newline
	Let $S_{0} \vcentcolon= R$, $S_{n} \vcentcolon= I^{n}$ for $n \ge 1$. Then,
	\begin{equation*} 
		\bigoplus_{n \ge 0} S_{n}
	\end{equation*}
	has a natural ring structure.

	There is a notational issue as to how one would write an element of $S$. One way is to write them as tuples, this is unwieldy. We would like to write them as sums, but then there's the issue of whether one interprets an element $x \in I$ as sitting in $S_{1}$ or $S_{0}$. 

	To combat this, we attach a dummy variable and define
	\begin{equation*} 
		R[It] \vcentcolon= \bigoplus_{n \ge 0} I^{n} t^{n} \cong \bigoplus_{n \ge 0} S_{n}.
	\end{equation*}
	The upshot is that the variable $t$ now succinctly acts as a bookkeeping device. 
\end{ex}

\begin{defn}
	Let $M, N$ be graded $R$-modules. A \deff{graded module homomorphism} $f : M \to N$ is a module homomorphism $f$ such that $f(M_{n}) \subset N_{n}$. 

	A sequence of graded modules is defined similarly.
\end{defn}

\begin{defn}
	Given a graded $R$-module $M$, and an integer $d$, we defined the \deff{shift} $M(d)$ to be the graded $R$-module $M$ with new grading
	\begin{equation*} 
		(M(d))_{n} = M_{d + n}.
	\end{equation*}
\end{defn}

\begin{obs}
	Let $M$ be a graded $R$-module, and $x \in R$ a homogeneous element of degree $d$. Note that 
	\begin{equation*} 
		M \xrightarrow{x} M
	\end{equation*}
	is a map of $R$-modules, but not a graded map (barring some trivial cases). 

	However, by shifting the domain, we do get a graded map as
	\begin{equation*} 
		M(-d) \xrightarrow{x} M.
	\end{equation*}
	Indeed, note that if $m \in (M(-d))_{n}$, then
	\begin{equation*} 
		xm \in R_{d}M_{-d + n} \subset M_{n},
	\end{equation*}
	as desired.
\end{obs}

\begin{defn}
	Let $M$ be a graded $R$-module. A submodule $N \subset M$ is said to be a \deff{graded (or homogeneous) $R$-submodule} if $N$ satisfies any of the following equivalent properties:
	\begin{enumerate}
		\item $N$ is generated by homogeneous elements.
		\item $N = \bigoplus_{n \in \mathbb{Z}} (N \cap M_{n})$.
		\item Whenever $x \in N$, every homogeneous component (in $M$) of $x$ is an element of $N$.
	\end{enumerate}
\end{defn}

\begin{obs}
	If $N \le M$ is a graded submodule, then $M/N$ has a natural grading given by
	\begin{equation*} 
		(M/N)_{n} \vcentcolon= M_{n}/(N \cap M_{n}).
	\end{equation*}
	Note that by definition, we have $N = \bigoplus_{n \in \mathbb{Z}} (N \cap M_{n})$, where this is an internal direct sum. Thus, one has the natural isomorphism $M/N \cong \bigoplus_{n \in \mathbb{Z}} (M/N)_{n}$.

	Under this grading, we have an exact sequence of graded $R$-modules given as
	\begin{equation*} 
		0 \to N \to M \to M/N \to 0.
	\end{equation*}
\end{obs}

For homogeneous ideals, primality can be checked on homogeneous elements:

\begin{prop}
	Let $I \subset R$ be a graded ideal with the property that if $x$, $y$ are homogeneous elements with $xy \in I$, then either $x \in I$ or $y \in I$. Then, $I$ is prime.
\end{prop}

\begin{prop} \label{prop:graded-ideal-algebra-generator}
	Let $R$ be a graded ring. Let $S \subset R_{+}$ be any subset. The following are equivalent:
	\begin{enumerate}[label=(\roman*)]
		\item $S$ generates $R_{+}$ as an $R$-ideal.
		\item $S$ generates $R$ as an $R_{0}$-algebra.
	\end{enumerate}
\end{prop}
\begin{proof} 
	Only (i) $\Rightarrow$ (ii) is nontrivial. Let $T \vcentcolon= R_{0}[S]$. We show that $R = T$ by proving $R_{n} \subset R$ for all $n \ge 0$. 

	We prove this by induction. $n = 0$ is clear. Let $n > 0$. By hypothesis, we have $R_{n} \subset R_{+} = RS$. Thus,
	\[\begin{WithArrows}[displaystyle]
		R_{n} &= (R \cdot S) \cap R_{n} \Arrow{If $m \ge n$, then $R_{m} S \cap R_{n} = 0$ } \\
		&= (R_{0} + \cdots + R_{n - 1}) S \cap R_{n} \Arrow{by induction} \\
		&\subset TS \cap R_{n} \\
		&\subset T,
	\end{WithArrows}\]
	as desired.
\end{proof}

\begin{cor} \label{cor:graded-noetherian-rings}
	Let $R$ be a graded ring. \newline
	$R$ is a Noetherian ring iff $R_{0}$ is a Noetherian ring and $R$ is a finitely generated $R_{0}$-algebra.
\end{cor}
\begin{proof} 
	\backward Follows from Hilbert's Basis Theorem since we can write $R$ as a quotient of $R[x_{1}, \ldots, x_{d}]$. 

	\forward $R_{+}$ is a finitely generated as an ideal and thus, $R$ is finitely generated as an $R_{0}$-algebra. $R_{0}$ is Noetherian since $R_{0} = R/R_{+}$.
\end{proof}

\begin{defn}
	Let $R$ be a graded ring with grading $\langle R_{n} \rangle_{n \ge 0}$. Let $d > 0$. \newline
	We define the \deff{twisted} graded ring $R^{(d)}$ to be the graded ring with
	\begin{equation*} 
		\left(R^{(d)}\right)_{n} = R_{dn}.
	\end{equation*}

	This is also called the \deff{$d$-th Veronese subalgebra}.
\end{defn}

$R^{(d)}$ can be visualised as follows: We have the additive subgroups $R_{0}, R_{d}, R_{2d}, \ldots$ of $R$ such that their \emph{internal} sum is direct. This realises $R^{(d)}$ as a subset (subgroup even) of $R$. We now just scale the grading by $d$.

\begin{ex}
	Consider $R = k[x, y]$ with the standard grading. Then, $R^{(2)}$, when considered as a subring of $R$ consists of those polynomials such that each monomial has even degree. 

	This can be written as $k[x^{2}, xy, y^{2}]$, as a set. However, $x^{2}$ now has degree $1$ in $R^{(2)}$.

	Similarly, $R^{(3)} = k[x^{3}, x^{2}y, xy^{2}, y^{3}]$.
\end{ex}

\begin{defn}
	Let $M$ be a graded $R$-module, and $d > 0$. Let $\ell \in \{0, \ldots, d - 1\}$. Then, we define
	\begin{equation*} 
		M^{(d, \ell)} \vcentcolon= \bigoplus_{k : k \equiv \ell (d)} M_{k}.	
	\end{equation*}
	The above has the structure of a graded $R^{(d)}$-module.
\end{defn}
A slightly more precise way of writing the above would be to specify that the $n$-th graded component of $M^{(d, \ell)}$ is $nd + \ell$. Note that
\begin{equation*} 
	R^{(d)}_{m} M^{(d, \ell)}_{n} = R_{md} M_{nd + \ell} \subset M_{(m + n)d + \ell} = M^{(d, \ell)}_{m + n}
\end{equation*}
and thus, $M^{(d, \ell)}$ is indeed a graded $R^{(d)}$-module.

\begin{defn}
	Given a graded ring $R$, $\Proj(R)$ denotes the set of homogeneous primes of $R$ not containing $R_{+}$.
\end{defn}

Fact: $\Proj(R)$ is in bijection with $\Proj(R^{(d)})$ for all $d > 0$. 

\begin{prop} \label{prop:finite-module-over-graded-ring}
	Let $R$ be a graded ring such that $R$ is a finitely generated $R_{0}$-algebra. Let $M$ be a finitely generated graded $R$-module. (For example, if $R$ and $M$ are both Noetherian.) Let $d > 0$. \newline
	Then, 
	\begin{enumerate}[label=(\roman*)]
		\item $M_{i}$ is a finitely generated $R_{0}$-module for all $i$. Moreover, $M_{i} = 0$ for $i \ll 0$.
		\item $M^{(d, \ell)}$ is a finitely generated $R^{(d)}$-module for all $\ell$ and thus,
		\begin{equation*} 
			M \cong \bigoplus_{\ell = 0}^{d - 1} M^{(d, \ell)}
		\end{equation*}
		is so. 
		\item In particular, $R$ is a finitely generated $R^{(d)}$-module.
		\item $R^{(d)}$ is a finitely generated $R_{0}$-algebra.
	\end{enumerate}
\end{prop}
Note that in the above, $M$ (and similarly $R$) is an ordinary $R^{(d)}$-module, not a graded one. (The module structure is the one inherited by virtue of $R^{(d)}$ being a subring of $R$, ignoring grading.)
\begin{proof} 
	We may assume that $m_{1}, \ldots, m_{t}$ are nonzero homogeneous and generate $M$. Let $d = \min_{i} \deg(m_{i})$. Then, $M_{n}$ must be zero for $i < d$ since any $R$-linear combination of the $m_{i}$ has degree at least $d$.\footnote{It was crucial here that $R$ is $\mathbb{N}$-graded.}

	Now, let $r_{1}, \ldots, r_{p} \in R_{+} \setminus \{0\}$ be homogeneous elements that generate $R$ as an $R_{0}$-algebra. Let $d_{i} \vcentcolon= \deg(r_{i})$. 

	Now, note that elements of $M_{i}$ can be written as $R_{0}$-linear combination of elements of the form
	\begin{equation*} 
		r_{1}^{a_{1}} \cdots r_{p}^{a_{p}} m_{s},
	\end{equation*}
	where $s \in \{1, \ldots, t\}$ and $a_{1}, \ldots, a_{p} \ge 0$ satisfy
	\begin{equation*} 
		\deg(m_{s}) + \sum_{j} a_{j} d_{j} = i.
	\end{equation*}

	But there are only finitely many such ways to pick $s$ and $a_{1}, \ldots, a_{p}$ (once we fix $i$). Thus, each $M_{i}$ is a finite $R_{0}$-module. This proves (i).

	Note that each $M^{(d, \ell)}$ is a quotient of $M$ and hence it suffices to prove that $M$ is finitely generated. $M$ can be generated \emph{over $R_{0}$} by elements of the form
	\begin{equation*} 
		r_{1}^{a_{1}} \cdots r_{p}^{a_{p}} m_{s}
	\end{equation*}
	where $a_{1}, \ldots, a_{p} \ge 0$ and $s \in \{1, \ldots, t\}$. 

	Since all powers of the form $r_{i}^{kd}$ are in $R^{(d)}$, we see that we have a finite generating set by restricting the $a_{i}$ to be in $[0, d - 1]$. This proves (ii) and (iii).

	Since $R$ is a finitely generated $R_{0}$-algebra, $R_{+}$ is a finitely generated $R$-module (\Cref{prop:graded-ideal-algebra-generator}). By (ii), we see that $R_{+}$ is a finitely generated $R^{(d)}$-module. But $(R^{(d)})_{+} = (R_{+})^{(d, 0)}$ and thus, part (ii) tells us that this is a finitely generated $R^{(d)}$-module. Using \Cref{prop:graded-ideal-algebra-generator} again, we see that $R^{(d)}$ is a finitely generated $R_{0}$-algebra. (Note that $(R^{(d)})_{0} = R_{0}$.) \newline
	This proves (iv). 
\end{proof}

\begin{cor}
	If $R$ is a Noetherian graded ring, then so is $R^{(d)}$ for all $d > 0$.
\end{cor}
\begin{proof} 
	Use \Cref{cor:graded-noetherian-rings} and part (iv) of the previous proposition.
\end{proof}

\begin{prop} \label{prop:n-d-stabilise}
	Let $R$ be a graded ring, finitely generated as an $R_{0}$-algebra. Let $M$ be a finitely generated graded $R$-module. \newline
	Then, there exist integers $n_{0}, d \ge 0$ such that
	\begin{equation*} 
		R_{d} M_{n} = M_{d + n}
	\end{equation*}
	for all $n \ge n_{0}$.
\end{prop}
Note that we always have $R_{d} M_{n} \subset M_{d + n}$. 
\begin{proof} 
	Let notation be as in the earlier proof: $m_{1}, \ldots, m_{t}$ are nonzero homogeneous and generate $M$ over $R$; $r_{1}, \ldots, r_{p} \in R_{+} \setminus \{0\}$ are homogeneous elements that generate $R$ as an $R_{0}$-algebra, with $d_{i} \vcentcolon= \deg(r_{i})$.

	Set $d \vcentcolon= \lcm_{i} d_{i}$ and $n_{0} \vcentcolon= 1 + pd + \max_{i} \deg(m_{i})$. For $1 \le i \le p$, define $s_{i} \vcentcolon= r_{i}^{d/d_{i}} \in R_{d}$. \newline
	We show that $d$ and $n_{0}$ have the properties as desired. To this end, let $n \ge n_{0}$. Pick $m \in M_{n}$. As seen earlier, we can write $m$ as an $R_{0}$-linear combination of elements of the form
	\begin{equation} \label{eq:002}
		r_{1}^{a_{1}} \cdots r_{p}^{a_{p}} m_{s}
	\end{equation}
	such that $a_{1} d_{1} + \cdots + a_{p} d_{p} + \deg(m_{s}) = n$. Note that
	\begin{equation*} 
		a_{1} d_{1} + \cdots + a_{p} d_{p} = n - \deg(m_{s}) > pd.
	\end{equation*}
	Thus, there is some $i \in \{1, \ldots, p\}$ such that $a_{i} d_{i} > d$ and thus, $a_{i} > d/d_{i}$. Thus, we may write
	\begin{equation*} 
		r_{i}^{a_{i}} = r_{i}^{d/d_{i}} r_{i}^{a_{i} - d/d_{i}} = s_{i} r_{i}^{a_{i} - d/d_{i}}.
	\end{equation*}

	Thus, each term of the form in \Cref{eq:002} can be written as an element of $R_{d} M_{n - d}$.
\end{proof}

Looking at the above proof, we may in fact extract a special result.

\begin{por} \label{por:n-d-stabilise}
	With the same hypothesis as earlier, assume further that $R = R_{0}[r_{1}, \ldots, r_{p}]$ with $\deg(r_{i}) = 1$ for all $i$. \newline
	Then, we may take $d = 1$ above, i.e., $R_{1} M_{n} = M_{n + 1}$ for $n \gg 0$.
\end{por}

\begin{cor}
	Suppose $R$ is a graded ring and a finitely generated $R_{0}$-algebra. Then, there exists $d > 0$ such that $R^{(d)}$ is generated over $R_{0}$ by $(R^{(d)})_{1} = R_{d}$.
\end{cor}
In other words, by taking a high enough Veronese subalgebra, we can ensure that it is generated in degree $1$.
\begin{proof} 
	By \Cref{prop:n-d-stabilise}, there exist $d', n_{0} > 0$ such that $R_{d'} R_{n} = R_{n + d'}$ for all $n \ge n_{0}$. \newline
	Let $d$ be a multiply of $d'$ which is greater than $n_{0}$. Then, for $n \ge d$, we have
	\begin{equation*} 
		R_{d + n} = R_{d'} R_{d - d_{0} + n} = \cdots = R_{d} R_{n}.
	\end{equation*}
	In particular, we have $R_{kd} = (R_{d})^{k}$ for all $k \ge 1$, as desired.
\end{proof}

\subsection{Filtrations and Topology}

\begin{defn}
	Let $R$ be a ring. A \deff{filtration} on $R$ is a sequence of ideals $\langle I_{n} \rangle_{n \in \mathbb{N}}$ satisfying
	\begin{equation*} 
		R = I_{0} \supset I_{1} \supset I_{2} \supset \cdots \andd I_{n} I_{m} \subset I_{n + m}
	\end{equation*}
	for all $n, m \ge 0$. \newline
	We say that $(R, \langle I_{n} \rangle_{n \in \mathbb{N}})$ is a \deff{filtered ring}.

	Given such a filtered ring, and an $R$-module $M$, a \deff{filtration} on $M$ is a sequence of $R$-submodules $\langle M_{n} \rangle_{n \in \mathbb{N}}$ satisfying
	\begin{equation*} 
		M = M_{0} \supset M_{1} \supset M_{2} \supset \cdots \andd I_{n} M_{m} \subset M_{n + m}
	\end{equation*}
	for all $n, m \ge 0$.
\end{defn}

\begin{ex}
	Let $R$ be any ring, $I \subset R$ an ideal, and $M$ an $R$-module. The \deff{$I$-adic filtration} on $R$ is the sequence $\langle I^{n} \rangle_{n \ge 0}$. Corresponding to this filtration, we have the filtration on $M$ given by $\langle I^{n} M \rangle_{n \ge 0}$.
\end{ex}

\begin{ex}
	Let $R$ be a graded ring with grading $\langle R_{n} \rangle_{n \ge 0}$. Set $I_{n} \vcentcolon= R_{\ge n} = \bigoplus_{i \ge n} R_{i}$. \newline
	Then, $\langle I_{n} \rangle_{n \ge 0}$ is a filtration on $R$.
\end{ex}

\begin{defn} \label{defn:associated-graded}
	Let $(R, \langle I_{n} \rangle_{n \ge 0})$ be a filtered ring. The \deff{associated graded ring} $\gr(R)$ is defined by
	\begin{equation*} 
		\gr(R) \vcentcolon= R/I_{1} \oplus I_{1}/I_{2} \oplus I_{2}/I_{3} \oplus \cdots.
	\end{equation*}
	This has the natural structure of a graded ring.

	Correspondingly, if we have a filtered module $(M, \langle M_{n} \rangle_{n \ge 0})$, then we define
	\begin{equation*} 
		\gr(M) \vcentcolon= M/M_{1} \oplus M_{1}/M_{2} \oplus M_{2}/M_{3} \oplus \cdots.
	\end{equation*}
	$\gr(M)$ is a graded $\gr(R)$-module.
\end{defn}

\begin{defn}
	A \deff{topological ring} $R$ is a ring with a topology such that the following three maps are continuous:
	\begin{itemize}
		\item $+ : R \times R \to R$, $(x, y) \mapsto x + y$;
		\item $\cdot : R \times R \to R$, $(x, y) \mapsto x y$;
		\item $- : R \to R$, $x \mapsto -x$.
	\end{itemize}

	$R$ is said to have a \deff{linear topology} if $0$ has a neighbourhood basis of ideals (that is, there is a collection of ideals $\mathcal{I}$ such that any neighbourhood of $0$ contains an ideal $I \in \mathcal{I}$).
\end{defn}

Note for any fixed $x \in R$, the translation map $T_{x} : R \to R$ defined by $y \mapsto x + y$ is a homeomorphism which takes $0$ to $x$. Thus, studying neighbourhoods of $0$ is sufficient.

Note that if $\langle I_{n} \rangle_{n \ge 0}$ is a filtration on a ring $R$, then the collection of all cosets $\{x + I_{n} : x \in R,\, n \ge 0\}$ is a basis for a topology on $R$. Indeed, it is clear that the union is all of $R$. Suppose that $z \in (x + I_{n}) \cap (y + I_{m})$. Then, check that
\begin{equation*} 
	z \in (z + I_{n + m}) \subset (x + I_{n}) \cap (y + I_{m}).
\end{equation*}

\begin{defn}
	Given a filtration $\langle I_{n} \rangle_{n \ge 0}$ on $R$, the topology generated by the basis $\{x + I_{n} : x \in R,\, n \ge 0\}$ is called the \deff{topology induced} by $\langle I_{n} \rangle_{n \ge 0}$.

	Similarly, given a filtration $\langle M_{n} \rangle_{n \ge 0}$ on an $R$-module $M$, one gives $M$ a topology.
\end{defn}

This is the topology that we will be focusing on now.

\begin{prop}
	Let $\langle I_{n} \rangle_{n \ge 0}$ be a filtration on $R$. Then, $R$ is a topological ring under the induced topology. (Similarly, $M$ is a topological $R$-module.)
\end{prop}
\begin{proof} 
	For $x, y \in R$ and $n \ge 0$, note that
	\begin{align*} 
		(x + I_{n}) + (y + I_{n}) &\subset x + y + I_{n}, \\
		(x + I_{n}) \cdot (y + I_{n}) &\subset xy + I_{n}, \\
		-(x + I_{n}) = -x + I_{n}.
	\end{align*}
	The continuity of the three operations now follows. The reader may formulate the definition of a topological module and prove the result similarly.
\end{proof}

\begin{obs}
	Note that the $I_{n}$ are clopen subsets of $R$. Indeed, each $I_{n}$ by virtue of being a basis element. On the other hand, we can write the complement as a union of open sets as well: $R \setminus I_{n} = \bigcup_{x \notin I_{n}} (x + I_{n})$. 

	Similarly, each $x + I_{n}$ is a clopen subset.
\end{obs}

\begin{ex}
	We consider the $\mathfrak{m}$-adic topology on $R$ for the following cases.
	\begin{enumerate}
		\item $R = \mathbb{Z}$, $\mathfrak{m} = (p)$ for some prime $p$. \newline
		In this topology, $x$ and $y$ are ``close'' if $x - y$ is divisible by a ``large'' power of $p$.
		%
		\item $R = k[x, y]$, $\mathfrak{m} = (x, y)$. \newline
		Here, $f$ and $g$ are ``close'' if $f - g \in \mathfrak{m}^{i}$ for ``large'' $i$ (i.e., all monomials appearing in $f - g$ have degree $\ge i$).
	\end{enumerate}
\end{ex}

\begin{prop} \label{prop:hausdorff-iff-trivial-intersection}
	$\langle I_{n} \rangle_{n \ge 0}$ induces a Hausdorff topology iff $\bigcap_{n \ge 0} I_{n} = 0$. \newline
	Similarly, a filtered $R$-module $M$ is Hausdorff iff $\bigcap_{n \ge 0} M_{n}$.
\end{prop}
\begin{proof} 
	We prove the statement about rings and leave the other one to the reader.

	\forward Suppose $\bigcap_{n \ge 0} I_{n} \neq 0$. Pick a nonzero $y$ in the intersection. Then, $y$ and $0$ cannot be separated.

	\backward As noted, each $I_{n}$ is closed. Thus, the intersection being $0$ implies that $\{0\}$ is closed. By continuity of multiplication, the diagonal is then closed in $R \times R$, which is equivalent to $R$ being Hausdorff.
\end{proof}

An alternate proof for \backward direction: Let $x, y \in R$ be distinct. Pick $N$ large such that $x - y \notin I_{N}$. Then, $x + I_{N}$ and $y + I_{N}$ are disjoint neighbourhoods.

\begin{prop}
	Let $M$ be a filtered $R$-module, and $N \le M$ a submodule. Then,
	\begin{equation*} 
		\overline{N} = \bigcap_{n \ge 0} (N + M_{n}).
	\end{equation*}
\end{prop}
\begin{proof} 
	Let $x \in M$. $x \in \overline{N}$ iff every basic neighbourhood of $x$ intersects $N$ iff $(x + M_{n}) \cap N \neq \emptyset$ for all $n$. This happens iff $x \in N + M_{n}$ for all $n$.
\end{proof}

\subsection{The Artin-Rees Lemma}

We wish to prove the Artin-Rees Lemma. Loosely speaking, it tells us the following (under Noetherian hypotheses): Suppose $N \subset M$ is a submodule, and $I \subset R$ an ideal. Give $M$ the $I$-adic topology. Now, we can give $N$ a topology in two ways: either the subspace topology, or the $I$-adic topology. The Artin-Rees lemma gives us that the two are the same.

We will assume the following setup for this subsection.

\begin{tcolorbox}
	\textbf{Setup.} $R$ is a Noetherian ring. $I \subset R$ is an ideal, and $R$ is given the $I$-adic filtration. \newline
	$M$ is a finitely generated $R$-module with some filtration $\langle M_{n} \rangle_{n \ge 0}$. $N \subset M$ is an $R$-submodule. \newline
	$S \vcentcolon= R[It]$ is the Rees algebra (as defined in \Cref{ex:rees-algebra}).
\end{tcolorbox}

\begin{defn}
	The filtration $\langle M_{n} \rangle_{n \ge 0}$ is said to be $I$-good if $I M_{n} = M_{n + 1}$ for $n \gg 0$.
\end{defn}

\begin{lem} \label{lem:I-good-finitely-generated}
	$\langle M_{n} \rangle_{n \ge 0}$ is $I$-good iff $F = \bigoplus_{n \ge 0} M_{n} t^{n}$ is a finitely generated $S$-module.
\end{lem}
As before, the variable $t^{n}$ in the direct sum above is for bookkeeping. This definition makes $F$ a graded $S$-module. (Indeed, the definition of filtration implies that $I_{n}t^{n} M_{m}t^{m} \subset M_{n + m}t^{n + m}$.)
\begin{proof} 
	\backward Suppose $F$ is a finitely generated $S$-module. Note that $S$ is finitely generated in degree $1$. Thus, \Cref{por:n-d-stabilise} tells us that $S_{1} M_{n} = M_{n + 1}$ for $n \gg 0$. This translates to $I M_{n} = M_{n + 1}$ for $n \gg 0$, which is precisely being $I$-good.

	\forward Let $n_{0}$ be such that $I M_{n} = M_{n + 1}$ holds for all $n \ge n_{0}$. \newline
	Now, each of $M_{0}, \ldots, M_{n_{0}}$ is finitely generated (over $R = S_{0}$) and the above equation shows that using generators for these is enough to generate everything.
\end{proof}

\begin{lem} \label{lem:rees-algebra-noetherian}
	$S$ is Noetherian.
\end{lem}
\begin{proof} 
	Note that $S_{0} = R$ is Noetherian, and $S$ is a finitely generated $R$-algebra. (Indeed, if $x_{1}, \ldots, x_{n}$ generate $I$ as an $R$-ideal, then $x_{1} t, \ldots, x_{n} t$ generate $S$ as an $R_{0}$-algebra.)
\end{proof}

\begin{thm}[Artin-Rees Lemma] \label{thm:artin-rees}
	Let $R$ be a Noetherian ring, $I \subset R$ an ideal, $M$ a finitely generated $R$-module, and $N \subset M$ a submodule. \newline
	Then,
	\begin{enumerate}[label=(\roman*)]
		\item there exists $c \ge 1$ such that $I^{n + c} M \cap N = I^{n}(I^{c} M \cap N)$ for all $n \ge 1$;
		\item there exists $c \ge 1$ such that $I^{n + c} M \cap N \subset I^{n} N$ for all $n \ge 1$;
		\item the subspace topology on $N$ (when $M$ is given the $I$-adic topology) agrees with the $I$-adic topology on $N$.
	\end{enumerate}
\end{thm}
In the statement of (ii), we can add some more obvious inclusions:
\begin{equation*} 
	I^{n + c} M \subset I^{n + c} M \cap N \subset I^{n} N \subset I^{n} M.
\end{equation*}
This shows how (ii) implies (iii). It is also clear that (i) implies (ii). So we shall only prove (i).

\begin{proof} 
	Note that (i) is equivalent to proving the filtration $\langle I^{n} M \cap N \rangle_{n \ge 0}$ on $N$ is $I$-good. \newline
	Clearly, the $I$-adic filtration on $M$ is $I$-good. Thus, $\bigoplus_{n \ge 0} I^{n} M$ is a finitely generated $S$-module (\Cref{lem:I-good-finitely-generated}). \newline
	Since $S$ is Noetherian (\Cref{lem:rees-algebra-noetherian}), it follows that the submodule $\bigoplus_{n \ge 0} (I^{n} M \cap N)$ is finitely generated. \newline
	Now, using \Cref{lem:I-good-finitely-generated} again shows that $\langle I^{n} M \cap N \rangle_{n \ge 0}$ is $I$-good, as desired.
\end{proof}

\subsection{Krull's intersection theorems}

We now use the Artin-Rees lemma to deduce that certain infinite intersections are zero. In view of \Cref{prop:hausdorff-iff-trivial-intersection}, it is saying that a certain module is Hausdorff.

\begin{thm}[Krull's Intersection Theorem] \label{thm:KIT}
	Let $(R, \mathfrak{m})$ be a local Noetherian ring, and $I \subsetneq R$ a proper ideal. If $M$ is a finitely generated $R$-module, then
	\begin{equation*} 
		\bigcap_{n \ge 0} I^{n} M = 0.
	\end{equation*}
	That is, the $I$-adic topology on $M$ is Hausdorff. 

	In particular, $\bigcap_{n \ge 0} I^{n} = 0$. 
\end{thm}
A special case is $I = \mathfrak{m}$. 
\begin{proof} 
	Let $N \vcentcolon= \bigcap_{n \ge 0} \mathfrak{m}^{n} M$. We wish to show that $N = 0$. Let $c$ be as given by the \mynameref{thm:artin-rees}. Note that $N \subset \mathfrak{m}^{1 + c} M$, by definition of $N$. Thus, we have
	\begin{equation*} 
		N \subset \mathfrak{m}^{1 + c} M \cap N \subset \mathfrak{m} N.
	\end{equation*}
	Now, using NAK, we see that $N = 0$, as desired.
\end{proof}
\begin{proof}[Aliter.]
	We use topological language in this proof. As before, let $N$ be the intersection. \newline
	\mynameref{thm:artin-rees} tells us that the $\mathfrak{m}$-adic topology on $N$ is the restriction of the $\mathfrak{m}$-adic topology on $M$. Note that $N$ is contained in every $\mathfrak{m}$-adic neighbourhood of $0$ in $M$. Thus, only neighbourhood of $0$ in $N$ is $N$ itself. \newline
	It follows that $N$ has the indiscrete topology. But $\mathfrak{m} N$ is a nonempty open subset in the $\mathfrak{m}$-adic topology. Thus, $N = \mathfrak{m} N$ and hence, $N = 0$ by NAK.
\end{proof}

\begin{por}
	If $R$ is a commutative ring, $M$ a finitely generated $R$-module, and $I$ is contained in the Jacobson radical of $R$, then $\bigcap_{n \ge 0} I^{n} M = 0$.
\end{por}

\begin{cor}
	Let $R$ be a Noetherian ring, $M$ a finitely generated $R$-module, and $I$ be an ideal contained in the Jacobson radical. Then, every submodule $N \le M$ is closed in the $I$-adic topology. In particular, every ideal of $R$ is closed in the $I$-adic topology.
\end{cor}
\begin{proof} 
	$M/N$ is a Hausdorff space in the $I$-adic topology. In particular, $\{0\}$ is closed. The map $\pi : M \to M/N$ is continuous (both have the $I$-adic topology). Thus, $N = \pi^{-1}(0)$ is closed.
\end{proof}

\begin{thm}
	Let $R$ be a Noetherian integral domain (not necessarily local). \newline
	Let $I \subsetneq R$ be a proper ideal. Then,
	\begin{equation*} 
		\bigcap_{n \ge 0} I^{n} = 0.
	\end{equation*}
\end{thm}
\begin{proof} 
	Let $\mathfrak{m} \supset I$ be maximal. Since $R$ is a domain, have the inclusion $R \into R_{\mathfrak{m}}$. Thinking of $R$ and $R_{\mathfrak{m}}$ as subrings of the fraction field, we note the containments
	\begin{align*} 
		\bigcap_{n \ge 0} I^{n} &\subset \left(\bigcap_{n \ge 0} I^{n}\right) R_{\mathfrak{m}} \\
		&\subset \bigcap_{n \ge 0} (I R_{\mathfrak{m}})^{n} = 0,
	\end{align*} 
	where the last equality follows from \Cref{thm:KIT}, since $R_{\mathfrak{m}}$ is local.
\end{proof}

\begin{ex}
	The theorems breaks down if drop both the hypotheses of being local and integral domain. \newline
	Indeed, take any ring $R$ with a nontrivial idempotent $e$. Then, the ideal $(e)$ is an idempotent ideal and hence $\bigcap_{n \ge 0} (e)^{n} = (e) \neq 0$. (Note that this is possible when $R$ is Noetherian, finite even.)

	If $R$ is not assumed Noetherian, then one cannot conclude even with the integral domain and local hypothesis. Consider $R = \mathbb{Z}_{(p)}[p^{1/p}, p^{1/p^{2}}, \ldots]$. \newline
	Then, $R$ is a local domain with maximal ideal $\mathfrak{m} = (p^{1/p}, p^{1/p^{2}}, \ldots)$. But $\mathfrak{m}$ is idempotent.
\end{ex}

\section{Dimension Theory}

We may tacitly be assuming that $M \neq 0$ in many places, when we talk about dimension. It may be safe to assume that we are defining $\dim(M) = -1$ when $M = 0$.

\subsection{Integer valued polynomials}

As before, we continue with the notation that $0 \in \mathbb{N}$. We use $\mathbb{N}_{\ge 1}$ to denote the set of positive integers.

\begin{defn}
	A function $f : \mathbb{Z} \to \mathbb{Z}$ is an \deff{eventual polynomial} if there exists a polynomial $P(t) \in \mathbb{Q}[t]$ such that 
	\begin{equation*} 
		f(n) = P(n) \quad \text{for all $n \gg 0$}.
	\end{equation*}
	The \deff{degree} of $f$ is defined to be the degree of $P$.
\end{defn}
Note that the polynomial $P$ is uniquely determined. For if $Q$ is another such polynomial, then $P - Q$ vanishes at infinitely many points. Thus, the degree is well-defined.

\begin{defn}
	For a function $f : \mathbb{Z} \to \mathbb{Z}$, we define the \deff{difference function} $\Delta f : \mathbb{N}_{\ge 1} \to \mathbb{Z}$ by
	\begin{equation*} 
		(\Delta f)(n) \vcentcolon= f(n) - f(n - 1).
	\end{equation*}
\end{defn}

\begin{prop} \label{prop:eventually-polynomial-iff-difference}
	Let $f : \mathbb{Z} \to \mathbb{Z}$ be any function. The following are equivalent:
	\begin{enumerate}
		\item $f$ is eventually polynomial.
		\item $\Delta f$ is eventually polynomial.
	\end{enumerate}
	In this case, we have $\deg(f) = \deg(\Delta f) + 1$.
\end{prop}
We are not worrying about degree of the zero polynomial. The reader can take care of that.
\begin{proof} 
	If $f$ agrees with $P$ eventually, then $\Delta f$ agrees with $\Delta P$ eventually. In this case, we clearly have $\deg(f) = \deg(\Delta f)$.

	Now suppose that $\Delta f$ is eventually a polynomial. Assume $Q(t) \in \mathbb{Q}[t]$ and $N > 1$ are such that
	\begin{equation*} 
		\Delta f(n) = Q(n)
	\end{equation*}
	for $n \ge N$.

	For $n > N$, note that we have $f(n) = f(n - 1) + \Delta f(n)$. Adding such equalities gives us
	\begin{equation*} 
		f(n) = f(N) + \sum_{k = N}^{n - 1} \Delta f(k) = f(N) + \sum_{k = N}^{n - 1} Q(k).
	\end{equation*}
	Thus, for a constant $C \in \mathbb{Z}$, we can write
	\begin{equation*} 
		f(n) = C + \sum_{k = 0}^{n - 1} Q(k).
	\end{equation*}
	But now note that the sum is itself a polynomial of degree $\deg(Q) + 1$. This finishes the proof.
\end{proof}

\begin{defn}
	For $n \ge 0$, define the rational polynomial $\binom{t}{n} \in \mathbb{Q}[t]$ as
	\begin{equation*} 
		\binom{t}{n} \vcentcolon= \frac{t(t - 1) \cdots (t - (n - 1))}{n!}.
	\end{equation*}
\end{defn}

Note that $\binom{t}{n}$ is a polynomial with (non-integer) rational coefficients, but takes integer values at all integers. We show that these polynomials are essentially all.

\begin{prop}
	Let $P(t) \in \mathbb{Q}[t]$. The following are equivalent:
	\begin{enumerate}[label=(\roman*)]
		\item $P(t) = \sum_{n} c_{n} \binom{t}{n}$ for some sequence of integers $\langle c_{n} \rangle_{n \ge 0}$ eventually zero.
		\item $P(n) \in \mathbb{Z}$ for all $n \in \mathbb{Z}$.
		\item $P(n) \in \mathbb{Z}$ for all $n \gg 0$.
	\end{enumerate}
\end{prop}
\begin{proof}
	(i) $\Rightarrow$ (ii) $\Rightarrow$ (iii) is clear.

	(iii) $\Rightarrow$ (ii): Write $P(x) = Q(x)/M$ for $Q(x) \in \mathbb{Z}[x]$ and $M \in \mathbb{N}_{\ge 1}$. \newline
	If there exists $n \in \mathbb{Z}$ such that $M$ does not divide $Q(n)$, then $M$ does not divide $Q(n + M)$ either. \newline
	In other words, if $P(n) \notin \mathbb{Z}$, then $P(n + M)$, $P(n + 2M)$, $\ldots$ are also not in $\mathbb{Z}$.

	(ii) $\Rightarrow$ (i): Let $d \vcentcolon= \deg(P)$. By linear algebra, we can write
	\begin{equation*} 
		P(t) = \sum_{k = 0}^{d} a_{k} \binom{t}{k},
	\end{equation*}
	for some choice of rationals $a_{k} \in \mathbb{Q}$. 

	Now, evaluating the above sequentially at $t = 0, \ldots, d$ shows that each $a_{k}$ is an integer. (Note that for such $t$, $\binom{t}{k}$ vanishes when $k > t$ and equals $1$ when $k = t$.)
\end{proof}

\begin{rem}
	The above holds even if we started with $P(t) \in \mathbb{R}[t]$ or $\mathbb{C}[t]$. Lagrange interpolation immediately tells us that such a $P$ must have rational coefficients.
\end{rem}

\subsection{Embedding dimension}

\begin{defn}
	Let $(R, \mathfrak{m}, k)$ be a local Noetherian ring. The \deff{embedding dimension} of $R$ is defined as
	\begin{equation*} 
		\edim(R) \vcentcolon= \dim_{k}(\mathfrak{m}/\mathfrak{m}^{2}).
	\end{equation*}
\end{defn}

By Nakayama's lemma, the above is equal to the minimum number of generators needed to generate $\mathfrak{m}$ (as an $R$-ideal). This is not a very good notion. We try capture information by looking at all quotients of the form $\mathfrak{m}^{k}/\mathfrak{m}^{k + 1}$.

\subsection{Dimension \`{a} la Hilbert polynomials}

We now define some functions, which we show are eventually polynomial. Then we define dimension using the degree.

\begin{defn} \label{defn:hilbert-samuel-function}
	Let $(R, \mathfrak{m}, k)$ be a local Noetherian ring. The function
	\begin{equation*} 
		n \mapsto \ell(R/\mathfrak{m}^{n})
	\end{equation*}
	is eventually polynomial. This function is called the \deff{Hilbert-Samuel function}. \newline
	The corresponding polynomial is called the \deff{Hilbert-Samuel polynomial}. Its degree is defined to be the \deff{dimension} of $R$, denoted $\dim(R)$.

	More generally, if $M \neq 0$ is a finitely generated $R$-module, then
	\begin{equation*} 
		n \mapsto \ell(M/\mathfrak{m}^{n} M)
	\end{equation*}
	is eventually polynomial, whose degree defines $\dim(M)$. We define the \deff{Hilbert-Samuel polynomial} $H_{M}(t) \in \mathbb{Q}[t]$ to be the polynomial such that $H_{M}(n) = \ell(M/\mathfrak{m}^{n} M)$ for $n \gg 0$.

	Moreover, $\dim(M) \le \edim(R)$. (In particular, $\dim(R) \le \edim(R)$.)
\end{defn}
These assertions are \Cref{prop:hilbert-samuel-function}.

In the above, $\ell$ denotes the length of the $R$-module. Note that $M/\mathfrak{m}^{n} M$ is annihilated by $\mathfrak{m}^{n}$ and is hence, Artinian (\Cref{cor:annihilated-maximals-artinian-noetherian}) and therefore has finite length. We also have
\begin{equation*} 
	\ell(M/\mathfrak{m}^{n}) = \sum_{i = 0}^{n - 1} \dim_{k}(\mathfrak{m}^{i}M/\mathfrak{m}^{i + 1}M).
\end{equation*}

\begin{defn} \label{defn:hilbert-function}
	Let $k$ be a field, and $M \neq 0$ be a finitely generated graded module over the polynomial ring $k[x_{1}, \ldots, x_{r}]$. Then, the \deff{Hilbert function}, defined by
	\begin{equation*} 
		n \mapsto \sum_{i \le n} \dim_{k}(M_{i})
	\end{equation*}
	is eventually a polynomial of degree $\le r$ (\Cref{prop:hilbert-function}).

	 The corresponding polynomial is denoted by $f_{M}^{+}(t) \in \mathbb{Q}[t]$, and is called the \deff{Hilbert polynomial}. We also define $f_{M} \vcentcolon= \Delta f_{M}^{+}$.
\end{defn}
Note that in the above, it makes sense to talk about $\dim_{k}(M_{i})$ since $k$ is in fact a subring of the polynomial ring. (As opposed to earlier, when we cannot talk about $\dim_{k}(R/\mathfrak{m}^{n})$.) Moreover, these dimensions are finite, by \Cref{prop:finite-module-over-graded-ring}.

\begin{ex}[Dimension of a field] \label{ex:dimension-field}
	Let $k$ be a field (and hence, a local ring), and $M \neq 0$ be a finitely generated $k$-module. Then, $\dim(M) = 0$. In particular, $\dim(k) = 0$. (Note the contrast from the usual vector space dimension.)

	To see this, note that the maximal ideal here is $0$. Thus, $\ell(M/\mathfrak{m}^{n} M) = \ell(M)$ for all $n$. Thus, the Hilbert-Samuel polynomial is constant, i.e., its degree is zero.
\end{ex}

\begin{ex}[Dimension of a polynomial ring] \label{ex:dimension-polynomial-field}
	Let $k$ be a field, and $R = k[x_{1}, \ldots, x_{d}]_{(x_{1}, \ldots, x_{d})}$. \newline
	Note that $R$ is a local ring with maximal ideal $\mathfrak{m} = (x_{1}, \ldots, x_{d})$. We claim that $\dim(R) = d$.

	To see this, note that $\mathfrak{m}^{n}/\mathfrak{m}^{n + 1}$ has a $k$-basis given by (the images of) the monomials of degree $n$. (Here we are looking at $k$ as the quotient $R/\mathfrak{m}$ and not the subring $k \subset R$.) \newline
	Thus,
	\begin{equation*} 
		\dim_{k}(\mathfrak{m}^{n}/\mathfrak{m}^{n + 1}) = \binom{d + n - 1}{d - 1}.
	\end{equation*}
	Thus, the above is a polynomial (in $n$) of degree $d - 1$. In turn, $\ell(M/\mathfrak{m}^{n})$ is a polynomial of degree $d$.
\end{ex}

\begin{prop} \label{prop:hilbert-function}
	The assertions made in \Cref{defn:hilbert-function} hold.
\end{prop}
\begin{proof} 
	Define $g_{M} : \mathbb{Z} \to \mathbb{Z}$ to be $g_{M}(n) = \dim_{k}(M_{n})$. Note that this is the difference function of the one given in the definition. Thus, by \Cref{prop:eventually-polynomial-iff-difference}, it suffices to show that that $g_{M}$ is eventually polynomial.

	We repeatedly use the following fact: If 
	\begin{equation*} 
		0 \to M' \to M \to M'' \to 0
	\end{equation*}
	is an exact sequence of \emph{graded} $R$-modules, then $g_{M} = g_{M'} + g_{M''}$.

	Note that as a consequence, we get that if we there is a filtration
	\begin{equation*} 
		0 = M_{0} \subset M_{1} \subset \cdots \subset M_{t},
	\end{equation*}
	then
	\begin{equation*} 
		g_{M_{t}} = g_{M_{t}/M_{t - 1}} + \cdots + g_{M_{1}/M_{0}}.
	\end{equation*}
	In particular, if all the functions on the right are eventually polynomials of degree $d$, then the same is true for $g_{M_{t}}$. ($t$ here is fixed.)

	Another trick that we will use is that we will consider modules annihilated by $x_{r}$, so that we can view them as modules over a smaller polynomial ring. Note that the function $g_{M}$ does not change.

	We prove the statement by induction on $r$.

	If $r = 0$, then the statement is clear since $g_{M}$ is eventually zero. Thus, $f_{M}^{+}$ is a constant polynomial.

	Since $x_{r}$ is homogeneous, we have a chain of graded submodules of $M$ given by
	\begin{equation*} 
		0 \subset \ann_{M}(x_{r}) \subset \ann_{M}(x_{r}^{2}) \subset \cdots.
	\end{equation*}
	Since $M$ is Noetherian, then above stabilises to some $M'$. 

	Note that each $\ann_{M}(x_{r}^{i})/\ann_{M}(x_{r}^{i + 1})$ is a finitely generated module over the polynomial ring in $r - 1$ variables. By induction, each of these modules have a Hilbert polynomial\footnote{By this, we mean that the corresponding function is eventually polynomial for them.} of degree $\le r - 1$. Thus, by our observation about filtrations, the same is true for $M'$. 

	Thus, we have shown that $g_{M'}$ is a eventually a polynomial of degree $\le r - 1$. Since we have the graded exact sequence
	\begin{equation*} 
		0 \to M' \to M \to M/M' \to 0,
	\end{equation*}
	it suffices to prove that $g_{M/M'}$ is eventually a polynomial of degree $\le r$. Thus, we may replace $M$ with $M/M'$. The gain is that $x_{r}$ is a nonzerodivisor on $M/M'$.

	Now, note that we have a graded exact sequence
	\begin{equation*} 
		0 \to M(-1) \xrightarrow{x_{r}} M \to M/(x_{r}) \to 0.
	\end{equation*}
	Thus, we have
	\begin{equation*} 
		g_{M} - g_{M(-1)} = g_{M/(x_{r})}.
	\end{equation*}
	Again, by induction, the right function is eventually polynomial of degree $\le r - 1$. Moreover the left function is exactly $\Delta g_{M}$. Thus, \Cref{prop:eventually-polynomial-iff-difference} tells us that $g_{M}$ is eventually a polynomial of degree $\le r$. 
\end{proof}

\begin{rem}
	Note that in the above proof, we did not really use that $k[x_{1}, \ldots, x_{r}]$ is a polynomial ring. Rather, all we needed was a finitely generated graded $k$-algebra, with generators in degree $1$. (The proof would have to be slightly modified if the generators are homogeneous of different degrees.)
\end{rem}

\begin{prop} \label{prop:hilbert-samuel-function}
	The assertions made in \Cref{defn:hilbert-samuel-function} hold.
\end{prop}
\begin{proof} 
	We prove the result for modules. Consider the associated graded ring $\gr(R) = \bigoplus_{n \ge 0} \mathfrak{m}^{n}/\mathfrak{m}^{n + 1}$ and the associated graded module $\gr(M) = \bigoplus_{n \ge 0} \mathfrak{m}^{n} M/\mathfrak{m}^{n + 1} M$.

	Let $r = \edim(R)$. Then, we can generate $\mathfrak{m}$ by some $t_{1}, \ldots, t_{r} \in \mathfrak{m}$. Note that $\gr(R)_{0} = R/\mathfrak{m} = k$. We have a surjective map of graded $k$-algebras 
	\begin{equation*} 
		k[x_{1}, \ldots, x_{r}] \to \gr(R)
	\end{equation*}
	given by
	\begin{equation*} 
		x_{i} \mapsto \overline{t_{i}}.	
	\end{equation*}
	(Note that $x_{i}$ and $\overline{t}_{i} \in \mathfrak{m}/\mathfrak{m}^{2}$ both do have degree $1$.)

	Thus, $\gr(M)$ is a finitely generated graded $k[x_{1}, \ldots, x_{r}]$-module. Now, by \Cref{prop:hilbert-function}, the function
	\begin{equation*} 
		n \mapsto \dim_{k}(\mathfrak{m}^{n} M/\mathfrak{m}^{n + 1} M)
	\end{equation*}
	is eventually polynomial, of degree $\le r - 1$.

	In turn, the Hilbert-Samuel function
	\begin{equation*} 
		n \mapsto \sum_{i = 0}^{n - 1} \dim_{k}(\mathfrak{m}^{i} M/\mathfrak{m}^{i + 1} M)
	\end{equation*}
	is eventually a polynomial of degree $\le r$.
\end{proof}

\begin{ex} \label{ex:dim-zero-iff-artinian-module}
	Let $(R, \mathfrak{m})$ be a local Noetherian ring and $M$ a finitely generated $R$-module. \newline
	Then, $\dim(M) = 0$ iff $M$ is of finite length (iff $M$ is Artinian).

	Indeed, if $\dim(M) = 0$, then the Hilbert-Samuel polynomial is constant. This means that $\mathfrak{m}^{n} M = \mathfrak{m}^{n + 1} M$ for $n \gg 0$. Nakayama's lemma now implies that $\mathfrak{m}^{n} M = 0$ for $n \gg 0$. In turn, \Cref{cor:annihilated-maximals-artinian-noetherian} tells us that $M$ is Artinian.

	Conversely, if $M$ is Artinian, then the chain
	\begin{equation*} 
		M \supset \mathfrak{m} M \supset \mathfrak{m}^{2} M \supset \cdots
	\end{equation*}
	eventually stabilises. Thus, $\ell(\mathfrak{m}^{n} M/\mathfrak{m}^{n + 1}M) = 0$ for $n \gg 0$.
\end{ex}

\subsection{Properties of dimension}

To summarise, we have shown the following:
\begin{itemize}
	\item If $M$ is a finitely generated module over $(R, \mathfrak{m})$, then we have a polynomial $H_{M}$ such that $H_{M}(n) = \ell(M/\mathfrak{m}^{n} M)$ for large $n$.
	%
	\item If $M$ is a finitely generated graded module over $k[x_{1}, \ldots, x_{r}]$, then there are polynomials $f_{M}$, $f_{M}^{+}$ such that
	\begin{equation*} 
		f_{M}(n) = \dim_{k}(M_{n}) \andd f_{M}^{+}(n) = \sum_{i \le n} \dim_{k}(M_{i})
	\end{equation*}
	for large $n$.
\end{itemize}

We now wish to see how the degrees of these polynomials interact with exact sequences. It is direct for the graded case. The local case requires more work.

\begin{prop}
	Suppose we have an exact sequence
	\begin{equation*} 
		0 \to M' \to M \to M'' \to 0
	\end{equation*}
	of graded modules over $k[x_{1}, \ldots, x_{r}]$. Then,
	\begin{equation*} 
		f_{M} = f_{M'} + f_{M''} \andd f_{M}^{+} = f_{M'}^{+} + f_{M''}^{+}.
	\end{equation*}
	Consequently, $\deg(f_{M}) = \max(\deg(f_{M'}), \deg(f_{M''}))$.
\end{prop}
\begin{proof} 
	The first result about the sum is clear since the exact sequence is graded, giving an exact sequence of $k$-vector space. \newline
	The statement about degree follows since the leading coefficients of the concerned polynomials are positive.
\end{proof}

\begin{prop} \label{prop:local-dimensions-short-exact-sequence}
	Let $(R, \mathfrak{m})$ be a Noetherian local ring. Let
	\begin{equation*} 
		0 \to M' \to M \to M'' \to 0
	\end{equation*}
	be an exact sequence of finite $R$-modules. Then, $\dim(M) = \max(\dim(M'), \dim(M''))$.
\end{prop}
\begin{proof} 
	Note that since $\otimes_{R} R/\mathfrak{m}^{n}$ is a right-exact functor, we have the exact sequence
	\begin{equation*} 
		M'/\mathfrak{m}^{n} M' \to M/\mathfrak{m}^{n} M \to M''/\mathfrak{m}^{n} M'' \to 0.
	\end{equation*}
	We show that the genuine kernel is a ``good approximation'' for the leftmost term there. To this end, let $M'_{n} \vcentcolon= M'/\mathfrak{m}^{n} M'$, and let $K_{n}$ be the genuine kernel, i.e., the sequence
	\begin{equation} \label{eq:003}
		0 \to K_{n} \to M/\mathfrak{m}^{n} M \to M''/\mathfrak{m}^{n} M'' \to 0
	\end{equation}
	is exact.

	Note that $K_{n} \cong (M' + \mathfrak{m}^{n}M)/\mathfrak{m}^{n}M \cong M'/(M' \cap \mathfrak{m}^{n}M)$. In particular, we have a surjection $M'_{n} \onto K_{n}$ and thus, $\ell(K_{n}) \le \ell(M'_{n})$.

	On the other hand, \mynameref{thm:artin-rees} implies the existence of $c \ge 1$ such that
	\begin{equation*} 
		M' \cap \mathfrak{m}^{n} M \subset \mathfrak{m}^{n - c} M'
	\end{equation*}
	for all $n \ge c$.

	Thus, for $n \ge c$, we have
	\begin{equation} \label{eq:004}
		\ell(M'_{n - c}) \le \ell(K_{n}) \le \ell(M'_{n}).
	\end{equation}

	Note that \Cref{eq:003} tells us that the Hilbert polynomials satisfy
	\begin{equation} \label{eq:005}
		H_{M}(n) = H_{M''}(n) + \ell(K_{n})
	\end{equation}
	for all $n$.

	This implies that $n \mapsto \ell(K_{n})$ is eventually a polynomial. \Cref{eq:004} shows that $H_{M'}$ has the same degree as this. The result now follows from \Cref{eq:005} since the leading coefficients of the polynomials in questions are positive.
\end{proof}

\begin{cor} \label{cor:dimension-direct-sum}
	If $M$ is a Noetherian module over a Noetherian local ring, then $\dim(M^{\oplus n}) = \dim(M)$ for all $n \ge 1$.
\end{cor}

\begin{thm}
	Let $R$ be a local Noetherian ring. Then, $\dim(R) = \dim(R/\nil(R))$.
\end{thm}
$\nil(R)$ above denotes the ideal of nilpotents.
\begin{proof} 
	Let $I = \nil(R)$. Since $R$ is Noetherian, we have $I^{n} = 0$ for $n \gg 0$. Thus, it suffices to prove that
	\begin{equation*} 
		\dim(R/I^{k}) = \dim(R/I^{k + 1})
	\end{equation*}
	for all $k \ge 1$.

	Note that we have an exact sequence
	\begin{equation*} 
		0 \to I^{k}/I^{k + 1} \to R/I^{k + 1} \to R/I^{k} \to 0
	\end{equation*}
	of $R$-modules.

	In view of \Cref{prop:local-dimensions-short-exact-sequence}, it suffices to show that $\dim(I^{k}/I^{k + 1}) \le \dim(R/I^{k + 1})$.

	Note that $I^{k}/I^{k + 1}$ is a (finitely generated) $R/I^{k}$-module. Thus, we have a surjection of the form
	\begin{equation*} 
		\bigoplus_{i = 1}^{N} R/I^{k} \to I^{k}/I^{k + 1} \to 0.
	\end{equation*}
	\Cref{cor:dimension-direct-sum} and \Cref{prop:local-dimensions-short-exact-sequence} now imply that $\dim(R/I^{k}) \ge \dim(I^{k}/I^{k + 1})$.
\end{proof}

\begin{thm}[Dimension only depends on support] \label{thm:dimension-depends-support}
	Let $(R, \mathfrak{m})$ be a local Noetherian, and $M \neq 0$ a finitely generated $R$-module. Then,
	\begin{equation*} 
		\dim(M) = \max_{\substack{\mathfrak{p} \in \Supp(M) \\ \mathfrak{p} \text{ minimal}}} \dim(R/\mathfrak{p}).
	\end{equation*}
	In particular, $\dim(R) = \max_{\mathfrak{p}} \dim(R/\mathfrak{p})$, where $\mathfrak{p}$ runs over all minimal primes.
\end{thm}
\begin{proof} 
	There exists a filtration of $M$ of the form
	\begin{equation*} 
		0 = M_{0} \subset M_{1} \subset \cdots \subset M_{m} = M
	\end{equation*}
	such that each $M_{i + 1}/M_{i}$ is isomorphic to some $R/\mathfrak{p}_{i}$, with $\mathfrak{p}_{i} \in \Supp(M)$. 

	Using \Cref{prop:local-dimensions-short-exact-sequence} successively on exact sequences of the form $0 \to M_{i} \to M_{i + 1} \to M_{i + 1}/M_{i} \to 0$, we see that
	\begin{equation*} 
		\dim(M) = \max_{i} \dim(R/\mathfrak{p}_{i}) \le \sup_{\mathfrak{p} \in \Supp M} \dim(R/\mathfrak{p}).
	\end{equation*}
	To prove the reverse inequality, we fix $\mathfrak{p} \in \Supp(M)$ and show that $\dim(R/\mathfrak{p}) \le \dim(M)$.

	Since $M_{\mathfrak{p}} \neq 0$ and localisation is exact, we must have that $(R/\mathfrak{p}_{i})_{\mathfrak{p}} \neq 0$ for some $i$\footnote{Indeed, localise the filtration $M_{0} \subset \cdots \subset M_{m}$ at $\mathfrak{p}$. Since $(M_{m})_{\mathfrak{p}} \neq 0$, there is some $i$ with $(M_{i})_{\mathfrak{p}} \neq (M_{i + 1})_{\mathfrak{p}}$.} and hence, $\mathfrak{p}_{i} \subset \mathfrak{p}$. This gives us $\dim(R/\mathfrak{p}) \le \dim(R/\mathfrak{p}_{i})$. \newline
	This also shows that the supremum is indeed a maximum.

	To see that the maximum can be taken over minimal primes, first note that we clearly have
	\begin{equation*} 
		\max_{\mathfrak{p} \in \Supp M} \dim(R/\mathfrak{p}) \ge \max_{\substack{\mathfrak{p} \in \Supp(M) \\ \mathfrak{p} \text{ minimal}}} \dim(R/\mathfrak{p}).
	\end{equation*}
	For the other direction, note that if $\mathfrak{p} \in \Supp M$, then $\mathfrak{p} \supset \mathfrak{q}$ for some minimal $\mathfrak{q} \in \Supp M$ and $\dim(R/\mathfrak{p}) \le \dim(R/\mathfrak{q})$.
\end{proof}

\begin{cor}
	With the same hypothesis, $\dim(M) = \dim(R/{\ann}(M))$. \newline
	In particular, $\dim(M) \le \dim(R)$.
\end{cor}
\begin{proof} 
	It suffices to show that $\Supp(M) = \Supp(R/\ann(M))$. But note that $\Supp(M) = V(\ann(M))$, since $M$ is finitely generated. But $V(\ann(M)) = \Supp(R/\ann(M))$.
\end{proof}

\begin{thm} \label{thm:nonzerodivisor-dimension-one-drop}
	Let $(R, \mathfrak{m})$ be local, and $M \neq 0$ be a finitely generated $R$-module. \newline
	Let $x \in \mathfrak{m}$ be a nonzerodivisor on $M$. Then,
	\begin{equation*} 
		\dim(M/xM) = \dim(M) - 1.
	\end{equation*}
\end{thm}
\begin{proof} 
	We have the exact sequence
	\begin{equation*} 
		0 \to xM \to M \to M/xM \to 0.
	\end{equation*}
	Thus,
	\begin{equation*} 
		0 \to xM/(xM \cap \mathfrak{m}^{n} M) \to M/\mathfrak{m}^{n} M \to M/(xM + \mathfrak{m}^{n} M) \to 0
	\end{equation*}
	is an exact sequence for all $n$. In terms of the Hilbert polynomials, we see that
	\begin{equation} \label{eq:006}
		H_{M}(n) = H_{M/xM}(n) + \ell(xM/(xM \cap \mathfrak{m}^{n} M))
	\end{equation}
	for $n \gg 0$. In particular, the rightmost term is eventually polynomial. 

	Note that since $x$ is a nonzerodivisor, we have $xM \cong M$ and hence,
	\begin{equation*} 
		xM/(xM \cap \mathfrak{m}^{n} M) \cong M/N_{n},
	\end{equation*}
	where $N_{n} = (\mathfrak{m}^{n}M :_{M} x) = \{a \in M : xa \in \mathfrak{m}^{n} M\}$. Indeed, $N_{n}$ is the preimage of $xM \cap \mathfrak{m}^{n} M$ under the isomorphism $M \xrightarrow{x} xM$.

	Note that since $x \in \mathfrak{m}$, we have $\mathfrak{m}^{n - 1} M \subset N_{n}$ and hence, 
	\begin{equation*} 
		\ell(M/N_{n}) \le \ell(M/\mathfrak{m}^{n - 1} M) \le H_{M}(n - 1)
	\end{equation*}
	for $n \gg 0$. Combining this with \Cref{eq:006} gives
	\begin{equation*} 
		H_{M}(n) \le H_{M/xM}(n) + H_{M}(n - 1)
	\end{equation*}
	for $n \gg 0$. Thus, $H_{M/xM} \ge \Delta H_{M}$ eventually and hence, $\dim(M/xM) \ge \dim(M) - 1$.

	We now need to prove the other direction of the inequality. 

	The \mynameref{thm:artin-rees} tells us that there exists $c$ such that $N_{n + c} \subset \mathfrak{m}^{n} M$ for all $n$.\footnote{Indeed, it tells us that there exists $c$ such that $\mathfrak{m}^{n + c} M \cap xM \subset \mathfrak{m}^{n} (xM)$ for all $n$. Now, take preimages under the isomorphism $M \xrightarrow{x} xM$.} Thus,
	\begin{equation*} 
		\ell(M/N_{n}) \ge \ell(M/\mathfrak{m}^{n - c} M) = H_{M}(n - c)
	\end{equation*}
	for $n \gg 0$. Since $M/N_{n} \cong xM/(xM \cap \mathfrak{m}^{n} M)$, \Cref{eq:006} now tells us that
	\begin{equation*} 
		H_{M}(n) \ge H_{M/xM}(n) + H_{M}(n - c)
	\end{equation*}
	for $n \gg 0$.

	Thus, $H_{M/xM}(n) \le H_{M}(n) - H_{M}(n - c)$ and thus, the degree drops in the desired way giving us $\dim(M/xM) \le \dim(M) - 1$.
\end{proof}


Using the above, we can prove a weaker inequality when $x$ is possibly a zerodivisor.

\begin{cor} \label{cor:quotient-drop-at-most-one}
	Let $M$ be a finitely generated module over the local Noetherian ring $(R, \mathfrak{m})$. \newline
	If $x \in \mathfrak{m}$, then
	\begin{equation*} 
		\dim(M) - 1 \le \dim(M/xM) \le \dim(M).
	\end{equation*}
	In words, the dimension can drop by at most $1$.
\end{cor}
\begin{proof} 
	$\dim(M/xM) \le \dim(M)$ is clear since $M$ surjects onto $M/xM$.

	Let $N$ denote the $x$-torsion submodule of $M$, i.e., $N = \{a \in M : x^{n} a = 0 \text{ for some } n \ge 1\}$. Let $M'' = M/N$. Then, we have an exact sequence
	\begin{equation*} 
		0 \to N \to M \to M'' \to 0.
	\end{equation*}
	Tensoring with $R/x$ gives us an exact sequence
	\begin{equation*} 
		0 \to N/xN \to M/xM \to M''/xM'' \to 0.
	\end{equation*}
	We only need to check that $N/xN \to M/xM$ is indeed an inclusion. This is equivalent to showing $N \cap (xM) \subset xN$. But this is is clear.\footnote{If $a \in M$ and $xa \in N$, then $x^{n}(xa) = 0$ for some $n$ and hence, $a \in N$.} 

	Now, note that $\dim(M''/xM'') = \dim(M'') - 1$ since $x$ is a nonzerodivisor on $M''$, by construction. \newline
	On the other hand, $\dim(N/xN) = \dim(N)$ since dimension only depends on the support (\Cref{thm:dimension-depends-support}), and $\Supp(N/xN) = \Supp(N)$ since $N$ is $x$-torsion.\footnote{In general, $\Supp(N/xN) = \Supp(N) \cap V(x)$. Now, since $N$ is $x$-torsion, if $N_{\mathfrak{p}} \neq 0$, we must have $x \in \mathfrak{p}$. Thus, $\Supp(N) \subset V(x)$.} We now apply \Cref{prop:local-dimensions-short-exact-sequence} twice. We have
	\begin{align*} 
		\dim(M/xM) &= \max(\dim(M''/xM''), \dim(N/xN)) \\
		&= \max(\dim(M'') - 1, \dim(N)) \\
		&\ge \max(\dim(M'') - 1, \dim(N) - 1) \\
		&= \max(\dim(M''), \dim(N)) - 1 = \dim(M). \qedhere
	\end{align*}
\end{proof}

\begin{cor} \label{cor:dimension-zero-domain-field}
	Let $(R, \mathfrak{m})$ be a (nonzero) local Noetherian ring of dimension zero. \newline
	Then, every element of $\mathfrak{m}$ is a zerodivisor. In particular, if $R$ is a domain, then $R$ is a field.
\end{cor}
\begin{proof} 
	Let $x \in \mathfrak{m}$ be arbitrary. If $x$ is a nonzerodivisor, then
	\begin{equation*} 
		\dim(R) = \dim(R/xR) + 1 \ge 1,
	\end{equation*}
	a contradiction.
\end{proof}
Note that the above is a converse of sorts to \Cref{ex:dimension-field}. However, note that there do exist rings of dimension zero which are not fields. Indeed, Artinian local rings are precisely these zero dimensional Noetherian local rings. \newline
We have already shown most of this in \Cref{cor:artinian-noetherian-dimension-zero}; we only need to show that the notion of $\dim(R)$ is the same.

\subsection{Characterisation of dimension}

For this discussion, assume that $(R, \mathfrak{m}, k)$ is local Noetherian. We showed that the function $n \mapsto \ell(R/\mathfrak{m}^{n})$ is eventually polynomial, and defined $\dim(R)$ to be the degree of this (unique) polynomial. 

We also showed the following properties.

\begin{enumerate}[label=(P\arabic*)]
	\item $\dim(R) = \max_{\mathfrak{p} \text{ a minimal prime}} \dim(R/\mathfrak{p})$. \newline
	(Note that $R$ has only finitely many minimal primes.)
	%
	\item $\dim(R) = 0$ if $R$ is a field (\Cref{ex:dimension-field}).
	%
	\item If $R$ is a domain, and $x \in \mathfrak{m} \setminus \{0\}$, then $\dim(R/(x)) = \dim(R) - 1$.
\end{enumerate}
Note that (P3) above implies the following.
\begin{enumerate}[label=(P\arabic*')]
	\setcounter{enumi}{2}
	\item If $R$ is a domain which is not a field, then $\dim(R) = \sup_{x \in \mathfrak{m} \setminus \{0\}} \dim(R/xR) + 1$.
\end{enumerate}

\begin{thm}
	(P1)-(P3) uniquely characterise the dimension function. In other words, if we are given a function 
	\begin{equation*} 
		d : \{\text{local Noetherian rings}\} \to \mathbb{Z}_{\ge 0}
	\end{equation*}
	satisfying (P1)-(P3), then $d = \dim$.

	The statement is true even if we replace (P3) with (P3').
\end{thm}
(We are ignoring any set-theoretic issues and using the term ``function''.)
\begin{proof} 
	Note that if $d$ satisfies (P3), then it satisfies (P3'). Thus, we may assume that $d$ satisfies (P1), (P2), (P3'), and show that $d = \dim$.

	It suffices to show $d(R) = \dim(R)$ whenever $R$ is a domain. It then follows for a general ring by using (P1).

	We prove this by induction on $\dim(R)$. 

	$\dim(R) = 0$: In this case, $R$ is a field, by \Cref{cor:dimension-zero-domain-field}. But then $d(R) = 0$, by (P2).

	$\dim(R) > 0$: Then, $R$ is not a field (by (P2)). By (P3'), there exists $x \in \mathfrak{m} \setminus \{0\}$ such that $d(R) = d(R/xR) + 1$. \newline
	Note that the ring $R' = R/xR$ has dimension equal to $\dim(R) - 1$.\footnote{We are allowed to use (P3) for $\dim$!} We wish to use the inductive hypothesis, but $R'$ need not be a domain. But note that $R'/\mathfrak{p}$ is, for every $\mathfrak{p} \in \Spec(R')$. \newline
	Moreover, $\dim(R'/\mathfrak{p}) \le \dim(R') < \dim(R)$ due to (P1). Thus, the induction hypothesis applies to all such quotients. Now using (P1) again, we see
	\begin{equation*} 
		d(R') = \max_{\mathfrak{p} \text{ minimal}} d(R'/\mathfrak{p}) = \max_{\mathfrak{p} \text{ minimal}} \dim(R'/\mathfrak{p}) = \dim(R').
	\end{equation*}
	Thus, $d(R) = d(R') + 1 = \dim(R') + 1 = \dim(R)$.
\end{proof}

\subsection{Krull dimension}

We now define a new notion of dimension that makes sense for any commutative ring (with the additional possibility of it being $\infty$ in some cases). We will then show that when restricted to local Noetherian rings, this dimension function is finite and satisfies (P1), (P2), (P3'). This will show that the newly defined dimension agrees with the earlier definition.

\begin{defn}
	Let $R$ be any commutative ring. A \deff{chain of prime ideals} in $R$ is a finite sequence of prime ideals
	\begin{equation*} 
		\mathfrak{p}_{0} \subsetneq \mathfrak{p}_{1} \subsetneq \cdots \subsetneq \mathfrak{p}_{n}.
	\end{equation*}
	The above chain is said to have \deff{length} $n$.

	The \deff{Krull dimension} of $R$ is defined as 
	\begin{equation*} 
		\krdim(R) \vcentcolon= \sup\{n : \text{there exists a chain of prime ideals of length $n$}\}.
	\end{equation*}
\end{defn}

\begin{ex}
	\Cref{cor:artinian-noetherian-dimension-zero} told us that Artinian rings are precisely Noetherian rings with Krull dimension zero.
\end{ex}

\begin{thm}
	If $(R, \mathfrak{m})$ is a Noetherian local ring, then $\krdim(R) = \dim(R)$.
\end{thm}
\begin{proof} 
	We refer to (P1), (P2), (P3') from the previous section.

	(P1): Any chain in $R/\mathfrak{p}$ can lifted back to $R$ showing that $\dim(R/\mathfrak{p}) \le \dim(R)$ for all $\mathfrak{p} \in \Spec(R)$. \newline
	Conversely, any chain of primes in $R$ contains a minimal prime and then continues to be a chain in the quotient by that prime.

	(P2): Obvious.

	(P3'): Let $R$ be a domain and not a field. \newline
	Let $x \in \mathfrak{m} \setminus \{0\}$ be arbitrary. A chain of length $n$ in $R/xR$ can be lifted to a chain of length $n$ in $R$. Moreover, $(0)$ is a prime strictly contained in this chain. Thus, we have a chain of length $n + 1$ in $R$. This shows
	\begin{equation} \label{eq:007}
		\krdim(R) \ge \sup_{x \in \mathfrak{m} \setminus \{0\}} \krdim(R/xR) + 1.
	\end{equation}
	Conversely, if 
	\begin{equation*} 
		0 = \mathfrak{p}_{0} \subsetneq \mathfrak{p}_{1} \subsetneq \cdots \subsetneq \mathfrak{p}_{m + 1} = \mathfrak{m}
	\end{equation*}
	is a chain of length $m + 1$ in $R$, then pick any nonzero $x \in \mathfrak{p}_{1}$. Then,
	\begin{equation*} 
		\mathfrak{p}_{1}/(x) \subsetneq \cdots \subsetneq \mathfrak{p}_{m + 1}/(x)
	\end{equation*}
	is a chain of length $m$ in $R/xR$, proving equality in \Cref{eq:007}.

	To finish concluding, we must show that $\krdim(R) < \infty$ for all local Noetherian rings $R$. We do this by showing that $\krdim(R) \le \dim(R)$ for all Noetherian local \emph{domains} $R$. (The general case then follows by (P1).)

	We prove this by induction on $\dim(R)$. 

	$\dim(R) = 0$: In this case, $R$ must be a field, for which the statement is known.

	Now, assume that $d \vcentcolon= \dim(R) \ge 1$ and that the statement is known whenever $\dim < R$. \newline
	For the sake of contradiction, assume that $\krdim(R) > d$. Thus, there exists a chain
	\begin{equation*} 
		0 = \mathfrak{p}_{0} \subsetneq \cdots \subsetneq \mathfrak{p}_{d + 1} = \mathfrak{m}.
	\end{equation*}
	Pick $x \in \mathfrak{p}_{1} \setminus \{0\}$. Then, $\dim(R/xR) = \dim(R) - 1$. Since we have a surjection $R/x \onto R/\mathfrak{p}_{1}$, we get $\dim(R/\mathfrak{p}_{1}) \le d - 1$ as well. \newline
	But $R/\mathfrak{p}_{1}$ is a domain in which we have the chain
	\begin{equation*} 
		0 \subset \mathfrak{p}_{2}/\mathfrak{p}_{1} \subset \cdots \subset \mathfrak{p}_{d + 1}/\mathfrak{p}_{1},
	\end{equation*}
	of length $d$, contradicting the inductive hypothesis.
\end{proof}

A related concept is the height of a prime.

\begin{defn}
	Let $R$ be a commutative ring. The \deff{height} of a prime $\mathfrak{p} \in R$ is defined to be 
	\begin{equation*} 
		\htt(\mathfrak{p}) \vcentcolon= \sup\{n : \text{there exists a chain of prime ideals of length $n$ ending at $\mathfrak{p}$}\}.
	\end{equation*}
	Equivalently, $\htt(\mathfrak{p}) = \krdim(R_{\mathfrak{p}})$.

	For an arbitrary ideal $I \subset R$, one defines \deff{height} as
	\begin{equation*} 
		\htt(I) \vcentcolon= \inf \{\dim R_{\mathfrak{p}} : \mathfrak{p} \in V(I)\}.
	\end{equation*}
\end{defn}

Note that under this definition, we have
\begin{equation*} 
	\krdim(R) = \sup_{\mathfrak{p} \in \Spec(R)} \htt(\mathfrak{p}).
\end{equation*}
Note that $\htt(\mathfrak{p})$ is always finite if $R$ is Noetherian, since then $\htt(\mathfrak{p}) = \krdim(R_{\mathfrak{p}}) = \dim(R_{\mathfrak{p}}) < \infty$. \newline
Moreover, for a local ring $(R, \mathfrak{m})$, we have $\dim(R) = \htt(\mathfrak{m})$.

\subsubsection{Whacky behaviour of Krull dimension}

To begin with, $\krdim(R)$ can be infinite even when $R$ is Noetherian (and necessarily not local). 

Note that in the local case, the (Krull) dimension being finite tells us that there exists a maximal chain of primes (i.e., a chain of primes which cannot be extended to a strictly larger chain of primes) with length equal to the dimension. (Thus, this chain is maximal in terms of inclusion and in terms of length.) \newline
But even in the local case, there can exist maximal chains of different length.

\textbf{Maximal chains of different lengths.} \newline
Consider the local (!) Noetherian ring $R = k[x, y, z]_{(x, y, z)}/(xy, xz)$.

$R$ has two minimal primes: $(\bar{x})$, $(\bar{y}, \bar{z})$. Computing dimension using (P1) shows that $\dim(R) = 2$. (\Cref{ex:dimension-polynomial-field} tells us that the dimensions of $k[x]_{x}$ and $k[y, z]_{(y, z)}$ are $1$ and $2$ respectively.) \newline
$R$ has the following two maximal chains, of different lengths:
\begin{align*} 
	(\bar{y}, \bar{z}) \subsetneq (\bar{x}, \bar{y}, \bar{z}), \\
	(\bar{x}) \subsetneq (\bar{x}, \bar{y}) \subsetneq (\bar{x}, \bar{y}, \bar{z}).
\end{align*}

Note that here the chains did start at different minimal primes. However, there are more complicated examples of local Noetherian domains with maximal chains of different lengths (these maximal chains are necessarily between the zero ideal and the maximal ideal).

\textbf{Maximal ideals of different heights.} \newline
Let $R = \mathbb{Q}[\![t]\!]$ be the power series ring over $\mathbb{Q}$ in one variable, and $\mathfrak{p} = (t)$ the maximal ideal. \newline
Let $S = R[x]$. \newline
Consider the ideals $\mathfrak{m}_{1} \vcentcolon= (tx - 1)$ and $\mathfrak{m}_{2} = (t, x)$. \newline
Note that $S/\mathfrak{m}_{1} = R[x]/(tx - 1) \cong R[t^{-1}]$ is the field of Laurent series. In particular, $\mathfrak{m}_{1}$ is maximal. Moreover, since $tx - 1$ is prime, it follows that $\htt(\mathfrak{m}_{1}) = 1$.\footnote{Note that $R[x]$ is a unique factorisation domain since $R$ is a PID. Consequently, if $0 \subsetneq \mathfrak{p} \subset (tx - 1)$, then we can pick a nonzero element $f \in \mathfrak{p}$. By factoring and using the fact that $\mathfrak{p}$ is prime, we may assume that $f$ is irreducible. But $f \in (tx - 1)$ implies that $tx - 1 \mid f$. Thus, $(tx - 1) = (f)$.} \newline
On the other hand, note that we have the chain $0 \subsetneq (x) \subsetneq (t, x)$ of primes showing that $\htt(\mathfrak{m}_{2}) \ge 2$. Thus, $\htt(\mathfrak{m}_{1}) \neq \htt(\mathfrak{m}_{2})$.

More generally, one can replace $R$ with a DVR. In that case, $\mathfrak{p}$ will again be principally generated (\Cref{cor:local-PID-DVR}). Moreover, $R[t^{-1}] \cong \Frac(R)$, showing that $\mathfrak{m}_{1}$ is still maximal. \newline
As we shall later see, $\dim(R[x]) = \dim(R) + 1 = 2$ and so we can in fact conclude $\htt(\mathfrak{m}_{2}) = 2$ and not just $\ge 2$.

\subsubsection{Dimension theory for \texorpdfstring{$k$}{k}-algebras}

We introduce some terminology for ease of reference.

\begin{defn}
	Let $k$ be a ring. By a \deff{$k$-affine ring}, we mean a $k$-algebra of finite type, i.e., a ring of the form $k[x_{1}, \ldots, x_{n}]/I$. 
\end{defn}

\begin{defn}
	Given a ring $R$ and a prime ideal $\mathfrak{p} \in \Spec R$, we define $\dim(\mathfrak{p}) \vcentcolon= \krdim(R/\mathfrak{p})$.
\end{defn}

Note that $\dim(\mathfrak{p})$ is dual to $\htt(\mathfrak{p})$. The former calculates the length of chain of primes \emph{starting} at $\mathfrak{p}$, whereas the latter calculates the length of those \emph{ending} at $\mathfrak{p}$. This immediately gives us
\begin{equation*} 
	\dim(\mathfrak{p}) + \htt(\mathfrak{p}) \le \dim(R)
\end{equation*}
for any ring $R$ and any prime $\mathfrak{p} \in \Spec(R)$.	Note that the above inequality can be strict. We will examine some cases where we can conclude better results. 

\begin{defn}
	A ring $R$ is \deff{catenary} if given any two primes $\mathfrak{p} \subsetneq \mathfrak{p}'$, any two maximal prime chains from $\mathfrak{p}$ to $\mathfrak{p}'$ have the same length.
\end{defn}

As noted in the previous section (without proof), there do exist Noetherian local domains which are not catenary. However, as we shall show, $k$-affine rings are always catenary.

\begin{defn}
	Let $k$ be a field, and $R$ a $k$-affine domain. Then, we define
	\begin{equation*} 
		\trdeg_{k}(R) \vcentcolon= \trdeg_{k}(\Frac(R)).
	\end{equation*}
\end{defn}

\begin{lem} 
	Let $R$ be a $k$-affine domain with $\trdeg_{k}(R) = d$, and let $\mathfrak{p} \in \Spec(R)$ be of height one. Then, $\trdeg_{k}(R/\mathfrak{p}) = d - 1$.
\end{lem}
\begin{proof} 
	\textbf{Case 1.} $R = k[x_{1}, \ldots, x_{d}]$.

	Suppose $\mathfrak{p} \subset R$ is a height one prime. Then, $\mathfrak{p} = (f)$ for some irreducible $f$.\footnote{Indeed, pick any nonzero $f \in \mathfrak{p}$. By primality, we may replace $f$ by an irreducible factor. Then, $(0) \subsetneq (f) \subseteq \mathfrak{p}$. Being height one forces equality $(f) = \mathfrak{p}$.} Without loss of generality, $f$ has positive degree in $x_{d}$. We may then write 
	\begin{equation*} 
	    f = g_{0}(x_{1}, \ldots, x_{d - 1}) + \cdots + g_{n}(x_{1}, \ldots, x_{d - 1}) x_{d}^{n},
	\end{equation*}
	where $n \ge 1$. \newline
	Note that a degree comparison shows that $k[x_{1}, \ldots, x_{d - 1}] \cap (f) = (0)$. \newline
	Thus, we have an inclusion $k[x_{1}, \ldots, x_{d - 1}] \hookrightarrow R/(f)$ and hence, the images of $x_{1}, \ldots, x_{d - 1}$ in $R/\mathfrak{p}$ are algebraically independent over $k$. But $\overline{x_{d}}$ is algebraic over $\Frac(k[\overline{x_{1}}, \ldots, \overline{x_{d - 1}}])$, as witnessed by $f$. \newline
	Thus, $\trdeg_{k}(\Frac(R/\mathfrak{p})) = d - 1$.

	\textbf{Case 2.} The general case.

	Consider a Noetherian normalisation $A = k[x_{1}, \ldots, x_{n}] \subset R$. Necessarily, $n \le d$ since $\Frac(A) \subset \Frac(R)$. On the other hand $A \subset R$ is an integral extension, and hence $\Frac(R)$ is algebraic over $\Frac(A)$. This gives us $n = d$.

	Now, given a height one prime $\mathfrak{p} \subset R$, consider its contraction $\mathfrak{p}_{0} = \mathfrak{p} \cap A$. Since $A$ is a UFD and $R$ a domain, the Going down theorem applies. This gives us that $\htt(\mathfrak{p}_{0}) = 1$. Case 1 now gives us that $\trdeg_{k}(A/\mathfrak{p}_{0}) = d - 1$. Now, since again $R/\mathfrak{p}$ is integral over $A/\mathfrak{p}_{0}$, we get $\trdeg_{k}(R/\mathfrak{p}) = d - 1$ as well.
\end{proof}

\begin{thm}
	Let $R$ be a $k$-affine ring, not necessarily a domain. Then, $R$ is catenary.

	More precisely, any maximal chain from $\mathfrak{p}$ to $\mathfrak{p}'$ has length $\dim(\mathfrak{p}) - \dim(\mathfrak{p}')$. 

	If $R$ is a domain, then all maximal ideals have the same length, which is equal to $\dim(R) = \trdeg_{k}(R)$.
\end{thm}
\begin{proof} 
	Let 
	\begin{equation*} 
		\mathfrak{p}_{0} \subsetneq \cdots \subsetneq \mathfrak{p}_{r}
	\end{equation*}
	be a maximal chain. This gives us a sequence of ring maps
	\begin{equation*} 
		R/\mathfrak{p}_{0} \onto \cdots \onto R/\mathfrak{p}_{r}.
	\end{equation*}
	Each prime ideal $\mathfrak{p}_{i}/\mathfrak{p}_{i - 1}$ has height one in $R/\mathfrak{p}_{i - 1}$. Thus, each arrow above decreases the transcendence degree by exactly one. \newline
	This gives 
	\begin{equation*} 
		\trdeg_{k}(R/\mathfrak{p}_{r}) = \trdeg_{k}(R/\mathfrak{p}_{0}) - r.
	\end{equation*}
	By the previous lemma, we can replace $\trdeg_{k}$ above with $\dim$, since $R/\mathfrak{p}_{i}$ are domains. Rearranging gives
	\begin{equation*} 
		r = \dim(R/\mathfrak{p}_{0}) - \dim(R/\mathfrak{p}_{r}) = \dim(\mathfrak{p}_{0}) - \dim(\mathfrak{p}_{r}).
	\end{equation*}

	To see the last statement, if $\mathfrak{m}$ is a maximal ideal, we can take $\mathfrak{p}_{0} = 0$ and $\mathfrak{p}_{r} = \mathfrak{m}$. We then get
	\begin{equation*} 
		r = \dim(0) - \dim(\mathfrak{m}) = \dim(R) - 0 = \trdeg_{k}(R). \qedhere
	\end{equation*}
\end{proof}

Note that the affine ring $k[x, y, z]/(xy, xz)$ has maximal ideals of different height. (Thus, being a domain is not an unnecessary condition.)

\begin{cor}
	Let $R$ be a $k$-affine domain, and $\mathfrak{p} \in \Spec(R)$. Then,
	\begin{equation*} 
		\htt(\mathfrak{p}) + \dim(\mathfrak{p}) = \dim(R).
	\end{equation*}
\end{cor}
\begin{proof} 
	Pick a maximal chain of primes ending at $\mathfrak{p}$. This has length $\htt(\mathfrak{p})$. \newline
	Pick a maximal chain of primes starting at $\mathfrak{p}$. This has length $\dim(\mathfrak{p})$. \newline
	Join these together to get a maximal chain (ending at some maximal ideal). This total length is $\dim(R)$.
\end{proof}

\subsection{Dimension via length and ideals of definition}

We now see yet another definition of dimension for local Noetherian rings. Recall the following.

\begin{prop}
	Let $(R, \mathfrak{m})$ be a local Noetherian ring, and $J \subsetneq R$ a proper ideal. The following are equivalent.
	\begin{enumerate}
		\item $J$ contains a power of $\mathfrak{m}$.
		\item $\sqrt{J} = \mathfrak{m}$.
		\item $J$ is $\mathfrak{m}$-primary.
		\item $R/J$ is Artinian.
	\end{enumerate}
\end{prop}

\begin{defn}
	Let $(R, \mathfrak{m})$ be a local Noetherian ring. A proper ideal $J \subset \mathfrak{m}$ is said to be an \deff{ideal of definition} of $R$ if $J$ is $\mathfrak{m}$-primary.
\end{defn}
The above proposition tells us alternate definitions of an ideal of definition.

\begin{prop}
	Let $(R, \mathfrak{m})$ be a local Noetherian ring. Define
	\begin{equation*} 
		d'(R) \vcentcolon= \min\{n : \text{there exist an ideal of definition with $n$ generators}\}.
	\end{equation*}
	In other words, $d'(R)$ is the minimal $n$ such that there exist elements $x_{1}, \ldots, x_{n} \in \mathfrak{m}$ with $\sqrt{(x_{1}, \ldots, x_{n})} = \mathfrak{m}$.

	Then, $d'(R) = \dim(R)$.
\end{prop}

The above will follow from the more general theorem about dimension of modules below.

\begin{thm}
	Let $(R, \mathfrak{m})$ be local Noetherian, and $M$ a finitely generated $R$-module. Then,
	\begin{equation*} 
		\dim(M) = \min\{n : \text{there exist $x_{1}, \ldots, x_{n} \in \mathfrak{m}$ such that $M/(x_{1}, \ldots, x_{n})M$ has finite length}\}.
	\end{equation*}
	Equivalently, the minimal $n$ such that $M/(x_{1}, \ldots, x_{n})M$ is Artinian.
\end{thm}
Note that one can always take generators for the maximal ideals to get a finitely generated module over a field. Thus, the set is indeed nonempty.

\begin{proof} 
	Let $d'(M)$ denote the minimal $n$ such that there exist $x_{1}, \ldots, x_{n}$ with $M/(x_{1}, \ldots, x_{n})M$ Artinian. We wish to show $\dim(M) = d'(M)$.

	The inequality $\le$ is clear. Indeed, suppose that we have $x_{1}, \ldots, x_{n} \in \mathfrak{m}$. By \Cref{cor:quotient-drop-at-most-one}, we know that
	\begin{equation*} 
		\dim(M/(x_{1}, \ldots, x_{n}) M) \ge \dim(M) - n.
	\end{equation*}
	Thus, if the dimension of the quotient is zero, then $n \ge \dim(M)$.

	We prove $d'(M) \le \dim(M)$ by induction on $\dim(M)$. If $\dim(M) = 0$, then $M$ is already of finite length (\Cref{ex:dim-zero-iff-artinian-module}).

	Now suppose that $d = \dim(M) > 0$. We first construct $x_{1}, \ldots, x_{d}$ such that the desired quotient is Artinian. \newline
	To this end, let $M' \subset M$ be a maximal submodule of finite length. There is an exact sequence
	\begin{equation*} 
		0 \to M' \to M \to M'' \to 0
	\end{equation*}
	where $M''$ has no finite length submodules. Note that $\dim(M') = 0$ by \Cref{ex:dim-zero-iff-artinian-module} and consequently, $\dim(M) = \dim(M'')$ by \Cref{prop:local-dimensions-short-exact-sequence}. \newline
	On the other hand, for any $x_{1}, \ldots, x_{n} \in \mathfrak{m}$, we see that $M/(x_{1}, \ldots, x_{n})M$ has finite length iff $M''/(x_{1}, \ldots, x_{n})M''$ has finite length.\footnote{We have the exact sequence $0 \to K \to M/(x_{1}, \ldots, x_{n})M \to M''/(x_{1}, \ldots, x_{n})M'' \to 0$, where $K$ is a quotient of $M'$ and hence of finite length.} Thus, $d'(M) = d'(M'')$ and we may assume that $M = M''$.

	Thus, $M$ does not have any submodule of finite length. In particular, $R/\mathfrak{m}$ does not inject into $M$, i.e., $\mathfrak{m} \notin \Ass(M)$. By prime avoidance, there exists $x_{1} \in \mathfrak{m}$ which is not in any associated prime. Thus, $x_{1}$ is a nonzerodivisor on $M$. By \Cref{thm:nonzerodivisor-dimension-one-drop}, we have $\dim(M/x_{1}) = \dim(M) - 1$. \newline
	By inductive hypothesis, there exist $x_{2}, \ldots, x_{d}$ with
	\begin{equation*} 
		(M/x_{1} M)/(x_{2}, \ldots, x_{d})(M/x_{1} M) \cong M/(x_{1}, \ldots, x_{d})M
	\end{equation*}
	of finite length. 
\end{proof}

\begin{defn}
	Let $(R, \mathfrak{m})$ be a noetherian local ring, and $M \neq 0$ a finite $R$-module of dimension $n$. A \deff{system of parameters for $M$} is a sequence $x_{1}, \ldots, x_{n} \in \mathfrak{m}$ such that $M/(x_{1}, \ldots, x_{n}) M$ has finite length.
\end{defn}
The preceding theorem tells us that systems of parameters always exist.

\subsection{Height and minimal generators}

\begin{defn}
	Given an ideal $I$ in a ring $R$, and a prime ideal $\mathfrak{p}$ containing $I$, we say that $\mathfrak{p}$ is \deff{minimal over $I$} if there does not exist a prime ideal $\mathfrak{q}$ such that
	\begin{equation*} 
		I \subset \mathfrak{q} \subsetneq \mathfrak{p}.
	\end{equation*}
	In other words, $\mathfrak{p}$ is minimal in the set of all primes containing $I$.
\end{defn}
Note that a prime ideal is always minimal over itself.

\begin{prop}
	Let $R$ be a Noetherian ring. Let $x \in R$.
	\begin{enumerate}[label=(\roman*)]
		\item If $\mathfrak{p}$ is minimal over $(x)$, then $\htt(\mathfrak{p}) \le 1$. If $x$ is a nonzerodivisor, then $\htt(\mathfrak{p}) = 1$.
		\item If $\mathfrak{p}, \mathfrak{q} \in \Spec(R)$ and $\mathfrak{q}$ is minimal over $(\mathfrak{p}, x)$, then there is no prime strictly between $\mathfrak{p}$ and $\mathfrak{q}$.
	\end{enumerate}
\end{prop}
\begin{proof} 
	(i): Assume $\mathfrak{p}$ is minimal over $(x)$. Then, $\mathfrak{p} R_{\mathfrak{p}}$ is the only prime in $R_{\mathfrak{p}}$ that contains $(\frac{x}{1})$. Thus, $\sqrt{(\frac{x}{1})} = \mathfrak{p} R_{\mathfrak{p}}$, i.e., $(\frac{x}{1})$ is an ideal of definition generated by $1$ element. Thus, $\dim(R_{\mathfrak{p}}) \le 1$ or $\htt(\mathfrak{p}) \le 1$. \newline
	Moreover, note that $\htt(\mathfrak{p}) = 0$ iff $R_{\mathfrak{p}}$ is already Artinian. This happens iff $\mathfrak{p} R_{\mathfrak{p}}$ is nilpotent (see \Cref{cor:artin-local-nilpotent-maximal} and \Cref{cor:annihilated-maximals-artinian-noetherian}). This happens iff $\frac{x}{1}$ is nilpotent in $R_{\mathfrak{p}}$. \newline
	However, if $x$ is not a zerodivisor, then neither is $\frac{x}{1}$ and hence, $\htt(\mathfrak{p}) = 1$. 

	(ii): By part (i), we see that $\htt(\mathfrak{q}/\mathfrak{p}) \le 1$ in $R/\mathfrak{p}$. Thus, there cannot be a prime strictly in between $\mathfrak{q}$ and $\mathfrak{p}$.
\end{proof}

The same proof gives the following more general result.

\begin{prop}
	Let $R$ be a Noetherian ring, and $x_{1}, \ldots, x_{r} \in R$.
	\begin{enumerate}
		\item If $\mathfrak{p}$ is minimal over $(x_{1}, \ldots, x_{r})$, then $\htt(\mathfrak{p}) \le r$. \newline
		In particular, if $\mathfrak{p}$ is generated by $r$ elements, then $\htt(\mathfrak{p}) \le r$.
		\item If $\mathfrak{p}, \mathfrak{q} \in \Spec(R)$ and $\mathfrak{q}$ is minimal over $(\mathfrak{p}, x_{1}, \ldots, x_{r})$, then every chain between $\mathfrak{p}$ and $\mathfrak{q}$ has length at most $r$.
	\end{enumerate}
\end{prop}

\section{Faithfully flat modules}

\begin{defn}
	Let $R$ be a ring. An $R$-module is said to be \deff{flat} if $- \otimes_{R} M$ is exact. \newline
	A flat module is said to be \deff{faithfully flat (fflat)} if $- \otimes_{R} M$ is a faithful functor, i.e., the map
	\begin{equation*} 
		\Hom_{R}(N, N') \to \Hom_{R}(N \otimes_{R} M, N' \otimes_{R} M)
	\end{equation*}
	is an injection for all $R$-modules $N$, $N'$.

	A map of rings $f : R \to S$ is said to be \deff{flat} (resp. \deff{faithfully flat}) if $S$ is a flat (resp. faithfully flat) $R$-module via $f$.
\end{defn}

We leave the following proposition as an exercise.

\begin{prop} \label{prop:equiv-fflat}
	The following are equivalent for an $R$-module $M$.
	\begin{enumerate}
		\item $M$ is fflat.
		\item $N' \to N \to N''$ is exact iff $N' \otimes M \to N \otimes M \to N'' \otimes M$ is exact (for all sequences $N' \to N \to N''$).
		\item $M$ is flat, and $M \otimes_{R} N \neq 0$ for all nonzero $R$-modules $N$.
		\item $M$ is flat, and $M \otimes k(\mathfrak{p}) \neq 0$ for all prime ideals $\mathfrak{p} \subset R$. \newline
		(Here, $k(\mathfrak{p}) = R_{\mathfrak{p}}/\mathfrak{p} R_{\mathfrak{p}} \cong \Frac(R/\mathfrak{p})$.)
		\item \label{item:fflat-5} $M$ is flat, and $M \otimes k(\mathfrak{m}) \neq 0$ for all maximal ideals $\mathfrak{m} \subset R$.
	\end{enumerate}
\end{prop}

\begin{ex}
	$0$ is flat but not fflat (unless $R = 0$).

	$\mathbb{Q}$ is a flat $\mathbb{Z}$-module, but not fflat. (Flatness follows since $\mathbb{Q}$ is a localisation. On the other hand, the nonzero map $\mathbb{Z} \onto \mathbb{Z}/2$ becomes the zero map after tensoring.)

	$R^{\oplus n}$ is fflat.
\end{ex}

\begin{lem} \label{lem:local-flat-fflat}
	Suppose $f : (R, \mathfrak{m}) \to (S, \mathfrak{n})$ is a ring homomorphism of local rings such that $f^{-1}(\mathfrak{n}) = \mathfrak{m}$. \newline
	If $S$ is a flat $R$-module (via $f$), then $S$ is fflat.
\end{lem}
\begin{proof} 
	We use \Cref{item:fflat-5} of \Cref{prop:equiv-fflat}. We only need to show that $S \otimes_{R} k(\mathfrak{m})$ is nonzero. Note that
	\begin{align*} 
		S \otimes_{R} k(\mathfrak{m}) &\cong S \otimes_{R} R/\mathfrak{m} \\
		&\cong S/\mathfrak{m}S.
	\end{align*}
	By hypothesis, $\mathfrak{m} S \subset \mathfrak{n} \neq S$. Thus, the quotient $S/\mathfrak{m} S$ is nonzero.
\end{proof}

\begin{thm}[Lying-over theorem for fflat maps]
	Suppose $f : R \to S$ if fflat. Then, $\Spec(S) \to \Spec(R)$ is surjective.
\end{thm}
\begin{proof} 
	Let $\mathfrak{p} \subset R$ be prime. Then, we have a map
	\begin{equation*} 
		k(\mathfrak{p}) \xrightarrow{\bar{f}} S \otimes_{R} k(\mathfrak{p})
	\end{equation*}
	of rings. 

	Since $S$ is fflat, the ring on the right is nonzero. Thus, there exists a prime $Q \in \Spec(S \otimes_{R} k(\mathfrak{p}))$. Moreover, $\bar{f}^{-1}(Q)$ is a prime in $k(\mathfrak{p})$ and hence, is zero.

	Now, note that
	\begin{equation*} 
		S \otimes_{R} k(\mathfrak{p}) \cong S_{p}/\mathfrak{p} S_{\mathfrak{p}}.
	\end{equation*}
	Primes of the above ring corresponding to primes of $S$ that contain $\mathfrak{p} S$ and do not intersect $f(R \setminus \mathfrak{p})$. Let $\mathfrak{q} \in \Spec(S)$ be the prime corresponding to $\mathfrak{p}$. 

	Then, $f^{-1}(\mathfrak{q}) = \mathfrak{p}$.	
\end{proof}

\begin{thm}[Going-down theorem for flat maps]
	If $f : R \to S$ is flat, then it has the going-down property.

	More explicitly: if $\mathfrak{p}_{1}, \mathfrak{p}_{2} \in \Spec(R)$ and $\mathfrak{q}_{2} \in \Spec(S)$ satisfy
	\begin{equation*} 
		\mathfrak{p}_{1} \subset \mathfrak{p}_{2} = f^{-1}(\mathfrak{q}_{2}),
	\end{equation*}
	then there exists a prime $\mathfrak{q}_{1} \in \Spec(S)$ such that 
	\begin{equation*} 
		f^{-1}(\mathfrak{q}_{1}) = \mathfrak{p}_{1} \andd \mathfrak{q}_{1} \subset \mathfrak{q}_{2}.
	\end{equation*}
\end{thm}

Note that $\mathbb{Z} \to \mathbb{Q}$ is flat and hence, has the going-down property. However, it does not have the lying-over property. There is no lift of $2 \mathbb{Z}$.

\begin{proof} 
	Note that
	\begin{equation*} 
		R_{\mathfrak{p}_{2}} \to S_{\mathfrak{q}_{2}}
	\end{equation*}
	is flat. Moreover, this is a map of local rings since $f^{-1}(\mathfrak{q}_{2}) = \mathfrak{p}_{2}$. Thus, \Cref{lem:local-flat-fflat} tells us that the map is fflat. Now use the lying-over theorem.
\end{proof}

\section{Completion}

\subsection{Completion via inverse limits}

\begin{defn}
	Let $R$ be a ring, and $\langle I_{n} \rangle_{n \ge 1}$ a collection of ideals such that $I_{n + 1} \subset I_{n}$. Then, we have a inverse system $R/I_{n + 1} \to R/I_{n}$ and we define
	\begin{equation*} 
		\widehat{R}^{\langle I_{n} \rangle_{n}} \vcentcolon= \limit_{n} R/I_{n}.
	\end{equation*}
	If $I_{n} = I^{n}$ for some ideal $I$, then the above inverse limit is denoted by $\widehat{R}^{I}$. In this case, we call $\widehat{R}^{I}$ the \deff{$I$-adic completion} of $R$.
\end{defn}

We will typically be interested in the case where $(R, \mathfrak{m})$ is a local ring and $I_{n} = \mathfrak{m}^{n}$. We may also typically write $\widehat{R}$ if the system of ideals is clear.

\begin{defn}
	More generally, if $M$ is an $R$-module and $\langle M_{n} \rangle_{n \ge 1}$ a sequence of submodules with $M_{n} \subset M_{n - 1}$, then we define
	\begin{equation*} 
		\widehat{M}^{\langle M_{n} \rangle_{n}} \vcentcolon= \limit_{n} M/M_{n}.
	\end{equation*}
	If $M_{n} = I^{n} M$ for some ideal $I$, then the above inverse limit is denoted by $\widehat{M}^{I}$. In this case, we call $\widehat{M}^{I}$ the \deff{$I$-adic completion} of $M$.
\end{defn}

We will typically be interested in $I$-adic completions, and often write $\widehat{M}$ if the inverse system is clear.

Note that the limit $\limit_{n} R/I_{n}$ is the subring of $\prod_{n} R/I_{n}$ consisting of the elements of the form
\begin{equation*} 
	(\overline{a_{1}}, \overline{a_{2}}, \overline{a_{3}}, \ldots)
\end{equation*}
such that $\overline{a_{n + 1}} \mapsto \overline{a_{n}}$ under the map $R/I_{n + 1} \to R/I_{n}$. (We may sometimes use the more elaborate notation $a_{n} + I_{n}$ instead of $\overline{a_{n}}$ for clarity.)

In particular, there is a map $R \to \widehat{R}$ given by
\begin{align*} 
	a \mapsto (a + I_{1}, a + I_{2}, a + I_{3}, \ldots).
\end{align*}

The description of $\widehat{M}$ is analogous. Similarly, we have a map $M \to \widehat{M}$.

\begin{rem}
	From the discussion, we note that $\widehat{R}$ is naturally a ring. Similarly, $\widehat{M}$ is an $R$-module. If both of these are $I$-adic completions, then $\widehat{M}$ is also an $\widehat{R}$-module.
\end{rem}

\begin{obs} \label{obs:completion-additive-functor}
	Let $R$ be a ring, and $I \subset R$ an ideal. The description above should also make it clear that $I$-adic completion is a functor from the category of $R$-modules to itself.

	Indeed, if $f : M \to N$ is an $R$-module homomorphism, then $f(J^{n} M) \subset J^{n} f(M) \subset J^{n} N$. \newline
	Thus, we have compatible maps $M/J^{n} M \to N/J^{n} N$ inducing a map $\widehat{M} \to \widehat{N}$.

	Explicitly, the map is given by
	\begin{equation*} 
		(m_{1} + I M, m_{2} + I^{2} M, \ldots) \mapsto (f(m_{1}) + I N, f(m_{2}) + I^{2} N, \ldots).
	\end{equation*}

	This also shows that $\widehat{\cdot}$ is an additive functor, i.e., $\widehat{f + g} = \widehat{f} + \widehat{g}$ for maps $f, g : M \to N$.

	Consequently, $\widehat{M \oplus N} \cong \widehat{M} \oplus \widehat{N}$. In particular, $\widehat{R^{\oplus n}} \cong \widehat{R}^{\oplus n}$. (In general, any additive functor preserves finite direct sums.)
\end{obs}

\begin{prop} \label{prop:R-to-completion-injective-hausdorff}
	Let $R$ be a ring, and $\langle I_{n} \rangle_{n \ge 1}$ a filtration on $R$. \newline
	$R \to \widehat{R}$ is injective iff $\bigcap_{n \ge 1} I_{n} = 0$ iff $R$ is Hausdorff in the topology induced by $\langle I_{n} \rangle_{n}$.
\end{prop}
\begin{proof} 
	Clearly, the kernel of $R \to \widehat{R}$ is $\bigcap_{n} I_{n}$. This gives the first equivalence. The last equivalence is just \Cref{prop:hausdorff-iff-trivial-intersection}.
\end{proof}

\begin{ex}
	Let $R$ be a ring. Consider the polynomial ring $S = R[x_{1}, \ldots, x_{n}]$ and the ideal $\mathfrak{m} = (x_{1}, \ldots, x_{n})$. (Note that $\mathfrak{m}$ need not be maximal.) \newline
	Then, the $\mathfrak{m}$-adic completion $\widehat{S}$ is isomorphic to $R[\![x_{1}, \ldots, x_{n}]\!]$.

	To see this, note that we have a map
	\begin{equation*} 
		R[\![x_{1}, \ldots, x_{n}]\!] \to \limit_{t} R[x_{1}, \ldots, x_{n}]/(x_{1}, \ldots, x^{n})^{t}
	\end{equation*}
	given by truncation. It is easy to see that this is an isomorphism.
\end{ex}

We also recall the following.
\begin{thm}
	If $R$ is Noetherian, then so is the power series ring $R[\![x_{1}, \ldots, x_{n}]\!]$.
\end{thm}

Note that the power series has the analogous universal property of polynomial rings, in the following way: Suppose $J \subset R$ is an ideal generated by $y_{1}, \ldots, y_{n}$. \newline
Then, we have a map
\begin{equation*} 
	R[x_{1}, \ldots, x_{n}] \to R
\end{equation*}
given by $x_{i} \mapsto y_{i}$. Note this maps $(x_{1}, \ldots, x_{n})$ onto $J$. More generally, this maps $(x_{1}, \ldots, x_{n})^{t}$ onto $J^{t}$ for all $t \ge 1$.

For all $t \ge 1$, this induces maps
\begin{equation*} 
	R[x_{1}, \ldots, x_{n}]/(x_{1}, \ldots, x_{n})^{t} \to R/J^{t}.	
\end{equation*}
The universal property of limits now gives us a map
\begin{equation*} 
	R[\![x_{1}, \ldots, x_{n}]\!] \to \widehat{R}^{J}.
\end{equation*}
Note that under this map, we see that
\begin{equation*} 
	x_{i} \mapsto (\overline{y_{i}}, \overline{y_{i}}, \overline{y_{i}}, \ldots).
\end{equation*}
(Of course, in the first coordinate, we have $\overline{y_{i}} = 0$.)

\begin{thm}
	Let $R$ be a Noetherian ring, $J \subset R$ an ideal. \newline
	Then, the $J$-adic completion $\widehat{R}$ is Noetherian.
\end{thm}
\begin{proof} 
	Let $J = (y_{1}, \ldots, y_{n})$. Let $\widetilde{y_{i}}$ denote the image of $y_{i}$ in $\widehat{R}$ via $R \to \widehat{R}$. \newline
	As noted, we have a (ring) map $\Phi : R[\![x_{1}, \ldots, x_{n}]\!] \to \widehat{R}$ given by
	\begin{equation*} 
		x_{i} \mapsto \widetilde{y_{i}}.
	\end{equation*}

	We claim that his map is onto. In particular, $\widehat{R}$ is Noetherian since $R[\![x_{1}, \ldots, x_{n}]\!]$ is so.

	Let $\mathbf{a} = (\overline{a_{1}}, \overline{a_{2}}, \overline{a_{3}}, \ldots) \in \widehat{R}$, and let $a_{1}, \ldots, \in R$ be lifts. \newline
	By hypothesis, we must have $a_{t + 1} - a_{t} \in J^{t}$. Thus, we can write
	\begin{equation*} 
		a_{t + 1} - a_{t} = F_{t}(y_{1}, \ldots, y_{n}),
	\end{equation*}
	where $F_{t}$ is a homogeneous polynomial of degree $t$. 

	Then, $F = \sum_{t = 1}^{\infty} F_{t}(x_{1}, \ldots, x_{n}) \in R[\![x_{1}, \ldots, x_{n}]\!]$. Moreover, $\Phi(F) = \mathbf{a}$.  
\end{proof}

\begin{ex} \label{ex:J-adic-completion-R-mod-J}
	Let $J \subset R$ be an ideal, and consider the $R$-module $M = R/J$. We claim that the map $M \to \widehat{M}^{J}$ is an isomorphism.

	This follows immediately since $JM = 0$ and thus, $M/J^{t} M \cong M$ for all $t$ and the maps $M/J^{t + 1} M \to M/J^{t} M$ are just the identity maps. 

	More generally, if $n \ge 1$ and $M = R/J^{n}$, then we have $M \cong \widehat{M}^{J}$ via the natural map. Explicitly, the map is given by
	\begin{equation*} 
		r + J^{n} \mapsto (r + J, r + J^{2}, \ldots, r + J^{n}, r + J^{n}, r + J^{n}, \ldots).
	\end{equation*}
	On the right, we have identified $M/J^{t} M \cong (R/J^{n})/(J^{t}/J^{n}) \cong R/J^{t}$ for $t \le n$. For $t > n$, we have $J^{t} M = 0$ and $M/J^{t} M \cong M = R/J^{n}$.
\end{ex}

\subsection{Completion via Cauchy Sequences}

We quickly see an alternate description of $\widehat{R}$ to justify the term ``completion''. Throughout this discussion, we fix a ring $R$ and a system of ideals $\langle I_{n} \rangle_{n \ge 1}$ such that $I_{n + 1} \subset I_{n}$ for all $n$. % We may also assume that $I_{n} I_{m} \subset I_{n + m}$ for some remarks.

\begin{defn}
	A sequence $(a_{n})_{n \ge 1}$ in $R$ is said to be \deff{Cauchy} if for every $t \ge 0$, there exists $N = N(t) \ge 1$ such that
	\begin{equation*} 
		a_{n} - a_{m} \in I_{t}
	\end{equation*}
	for all $n, m \ge N$.
\end{defn}

Thus, these ideals replace the $\varepsilon$-balls.\footnote{If $R$ is Hausdorff, i.e., if $\bigcap_{t \ge 0} I_{t} = 0$, then the topology is indeed metrisable with $d(x, y) = \inf\{2^{-t} : x - y \in I^{t}\}$. In this case, the definition above coincides with the usual notion of a Cauchy sequence. Note that if $R$ is not Hausdorff, then $d$ is only a pseudometric.}

For the moment, we now forget the notation $\widehat{R}$ from earlier and define it in a new way.

First, define $\mathcal{R} = \prod_{\mathbb{N}} R$ to be the direct product of $\mathbb{N}$-many copies of $R$. In other words, $\mathcal{R}$ is the ring of all sequences in $R$. \newline
Let $\mathcal{C} \subset \mathcal{R}$ be the set of all Cauchy sequences.

\begin{exe}
	Check that $\mathcal{C}$ is a subring of $\mathcal{R}$.
\end{exe}

Now, define $\mathcal{I} \subset \mathcal{C}$ to be the set of Cauchy sequences converging to $0$. ($(r_{n})_{n \ge 0}$ is said to converge to $0$ if for all $t \ge 1$, there exists $N = N(t)$ such that $r_{n} \in I_{t}$ for all $N \ge t$. Uniqueness of limit is not assumed.)

\begin{exe}
	Check that $\mathcal{I}$ is an ideal of $\mathcal{C}$.
\end{exe}

Finally, define $\widehat{R} = \mathcal{C}/\mathcal{I}$. The description of $\widehat{R}$ is given as follows: Its elements are equivalence classes of Cauchy sequences $(r_{n})_{n \ge 1}$, where the equivalence relation is
\begin{equation*} 
	(r_{n})_{n \ge 1} \sim (s_{n})_{n \ge 1} \Leftrightarrow \text{for all $t$, there exists $N$ such that $r_{n} - s_{n} \in U_{t}$ for all $n \ge N$}.
\end{equation*}
The ring operations are defined in the obvious manner. The previous exercises ensure that this is well-defined.

Note that we have an obvious ring map $R \to \widehat{R}$, mapping $r \in R$ to the equivalence of the constant sequence $(r)_{n \ge 1}$.

\begin{thm} \label{thm:equivalence-of-completions}
	$\limit_{t} R/I_{t} \cong \widehat{R}$.

	More precisely, there is an isomorphism $\varphi$ making the following diagram commute
	\begin{equation*} 
		\begin{tikzcd}
			& \limit_{t} R/I_{t} \arrow[dd, "\cong"', "\varphi"] \\
			R \arrow[ru] \arrow[rd] & \\
			& \widehat{R}.
		\end{tikzcd}
	\end{equation*}
\end{thm}
\begin{proof} 
	Define $\varphi$ as
	\begin{equation*} 
		(r_{1} + I_{1}, r_{2} + I_{2}, \ldots) \mapsto [(r_{1}, r_{2}, \ldots)].
	\end{equation*}
	We need to check that $\varphi$ is well-defined. Note that the above formula makes it clear that the desired diagram does commute.

	Firstly, note that by definition of inverse limit, we have $r_{t + 1} - r_{t} \in I_{t}$ for all $t$. Since the ideals are decreasing, we get $r_{n} - r_{m} \in I_{t}$ for all $n, m \ge t$. This proves that the sequence $(r_{n})_{n \ge 1}$ is indeed Cauchy.

	Second, note that if $(r_{t}')_{t \ge 1}$ is another sequence representing the same element of the inverse limit, i.e., if $r_{t} - r_{t}' \in I_{t}$ for all $t$, then $r_{n} - r_{n}' \in I_{t}$ for all $n \ge t$, proving that $(r_{t} - r_{t}')_{t \ge 1}$ converges to $0$.

	Thus, $\varphi$ is well-defined. It is clearly a ring map. We now check that it is bijection.

	Injection: Suppose that $(r_{1} + I_{1}, r_{2} + I_{2}, \ldots) \in \ker(\varphi)$. We wish to show that $r_{t} \in I_{t}$ for all $t$. \newline
	Fix $t$. By hypothesis, there exists $N \ge t$ such that $r_{N} \in I_{t}$. By definition of an inverse limit, we must have $r_{N} - r_{t} \in I_{t}$, showing that $r_{t} \in I_{t}$.

	Surjection: Let $(r_{1}, r_{2}, \ldots)$ be a Cauchy sequence. \newline
	Pick $N_{1} < N_{2} < \cdots$ such that 
	\begin{equation*} 
		r_{n} - r_{m} \in I_{t}
	\end{equation*}
	for all $n, m \ge N_{t}$. \newline
	Then, 
	\begin{equation*} 
		\mathbf{r} = (r_{N_{1}} + I_{1}, r_{N_{2}} + I_{2}, \ldots)
	\end{equation*}
	is an element of the inverse limit. \newline
	We claim $\varphi(\mathbf{r}) = [(r_{1}, r_{2}, \ldots)]$ proving that $\varphi$ is onto. \newline
	To see this, note that
	\begin{equation*} 
		\varphi(\mathbf{r}) = (r_{N_{1}}, r_{N_{2}}, \ldots).
	\end{equation*}
	We wish to show that
	\begin{equation*} 
		\lim_{t \to \infty} r_{N_{t}} - r_{t} = 0.
	\end{equation*}
	(We are not claiming uniqueness of limit.) \newline
	To see this, note that $N_{n} \ge n$ for all $n$. Thus,
	\begin{equation*} 
		r_{N_{n}} - r_{n} \in I_{t}
	\end{equation*}
	for all $t$ and all $n \ge N_{t}$.
\end{proof}

\subsection{Exactness}

Recall that one has the obvious definition of a morphism of inverse systems. In particular, a short exact sequence 
\begin{equation*} 
	0 \to \langle A_{n} \rangle_{n \ge 1} \to \langle B_{n} \rangle_{n \ge 1} \to \langle C_{n} \rangle_{n \ge 1} \to 0
\end{equation*} 

of inverse systems of $R$-modules corresponds to a commutative diagram of the form

\begin{equation*} 
	\begin{tikzcd}
		& \vdots \arrow[d] & \vdots \arrow[d] & \vdots \arrow[d] & \\
		0 \arrow[r] & A_{2} \arrow[d] \arrow[r] & B_{2} \arrow[d] \arrow[r] & C_{2} \arrow[d] \arrow[r] & 0 \\
		0 \arrow[r] & A_{1} \arrow[d] \arrow[r] & B_{1} \arrow[d] \arrow[r] & C_{1} \arrow[d] \arrow[r] & 0 \\
		0 \arrow[r] & A_{0} \arrow[r] & B_{0} \arrow[r] & C_{0} \arrow[r] & 0, 
	\end{tikzcd}
\end{equation*}
where each row is exact.

Corresponding to this, we can form the sequence
\begin{equation*} 
	0 \to \limit_{n} A_{n} \to \limit_{n} B_{n} \to \limit_{n} C_{n} \to 0.
\end{equation*}

\begin{prop}
	The sequence above is exact, except possibly at $\limit_{n} C_{n}$. \newline
	If $\langle A_{n} \rangle_{n \ge 1}$ is a surjective system, i.e., the map $A_{n + 1} \to A_{n}$ is a surjection for all $n$, then the sequence above is exact.
\end{prop}

Note that in the case that we are interested in, the inverse systems \emph{are} surjective. 

\begin{proof} 
	Diagram chase. Left as an exercise.
\end{proof}

\begin{thm}
	Let $R$ be a Noetherian ring, $J \subset R$ an ideal. Let 
	\begin{equation*} 
		0 \to M' \to M \to M'' \to 0
	\end{equation*}
	be a short exact sequence of finitely generated $R$-modules.

	Then, 
	\begin{equation*} 
		0 \to \widehat{M'}^{J} \to \widehat{M}^{J} \to \widehat{M''}^{J} \to 0
	\end{equation*}
	is exact.
\end{thm}
\begin{proof}[Sketch]
	For each $n$, the sequence 
	\begin{equation*} 
		0 \to M'/(J^{n} M \cap M') \to M/J^{n} M \to M''/J^{n} M'' \to 0
	\end{equation*}
	is exact.

	Thus, 
	\begin{equation*} 
		0 \to \limit_{n} M'/(J^{n} M \cap M') \to \widehat{M} \to \widehat{M''} \to 0
	\end{equation*}
	is exact.

	Use \mynameref{thm:artin-rees} to conclude that the limit above is isomorphic to $\widehat{M'}$ (and that the appropriate diagram commutes).
\end{proof}

\begin{cor}
	Let $R$ be a Noetherian ring, $J \subset R$ an ideal, and $M$ a finitely generated $R$-module. Then,
	\begin{equation*} 
		\widehat{M}^{J} \cong M \otimes_{R} \widehat{R}^{J}.
	\end{equation*}
\end{cor}
\begin{proof} 
	Since $R$ is Noetherian and $M$ finitely generated, $M$ is also finitely presented, i.e., there is an exact sequence
	\begin{equation*} 
		R^{\oplus m} \to R^{\oplus n} \to M \to 0.
	\end{equation*}

	Now, consider the following commutative diagram:

	\begin{equation*} 
		\begin{tikzcd}
			\widehat{R^{\oplus m}} \arrow[r] \arrow[d, "\cong"] & \widehat{R^{\oplus n}} \arrow[r] \arrow[d, "\cong"] & \widehat{M} \arrow[r] & 0 \\
			\widehat{R}^{\oplus m} \arrow[r] \arrow[d, "\cong"] & \widehat{R}^{\oplus n} \arrow[d, "\cong"] & \\
			R^{\oplus m} \otimes_{R} \widehat{R} \arrow[r] & R^{\oplus n} \otimes_{R} \widehat{R} \arrow[r] & M \otimes_{R} \widehat{R} \arrow[r] & 0
		\end{tikzcd}
	\end{equation*}

	The top row is exact by the previous result. The bottom row is exact since tensoring is right exact. The vertical arrows are the natural ones that follow by virtue of completion and tensoring being additive functors (and therefore preserving finite direct sums). 

	In turn, there is an induced isomorphism $\widehat{M} \to M \otimes_{R} \widehat{R}$. 
\end{proof}

\begin{cor}
	If $R$ is a Noetherian ring, and $J \subset R$ an ideal, then the $J$-adic completion $\widehat{R}$ is a flat $R$-module.
\end{cor}
\begin{proof} 
	In general, if $K$ is an $R$-module such that $\otimes_{R} K$ preserves short exact sequences of finitely generated modules, then $K$ is flat. 
\end{proof}

\begin{cor} \label{cor:completion-of-completion}
	Let $R$ be a Noetherian ring, and $J \subset R$ an ideal. Let $\widehat{R}$ denote the $J$-adic completion. \newline
	For each $n$, the natural projection map $\widehat{R} \onto R/J^{n}$ has kernel $J^{n} \widehat{R} \cong \widehat{J^{n}}$. \newline
	In particular, $\widehat{R}/J^{n} \widehat{R} \cong R/J^{n}$.

	Consequently, $\widehat{R} \cong \widehat{\widehat{R}}$, where the second completion is with respect to $J \widehat{R}$.
\end{cor}
\begin{proof} 
	Fix $n$. We have the short exact sequence
	\begin{equation*} 
		0 \to J^{n} \to R \to R/J^{n} \to 0
	\end{equation*}
	of $R$-modules.

	Note that by \Cref{ex:J-adic-completion-R-mod-J}, we have $\widehat{R/J^{n}} \cong R/J$. Thus, applying $\widehat{\cdot}$ to the above short exact sequence yields
	\begin{equation*} 
		0 \to \widehat{J^{n}} \to \widehat{R} \to R/J^{n} \to 0.
	\end{equation*}
	(Check that the map $\widehat{R} \to R/J^{n}$ is indeed the natural projection mentioned in the statement of the result.)

	Moreover, note that $\widehat{J^{n}} \cong J^{n} \otimes_{R} \widehat{R} \cong J^{n} \widehat{R}$, where the last isomorphism follows since $\widehat{R}$ is flat. (Again, one has to check that the maps are the natural ones.)

	Thus, we have shown that $J^{n} \widehat{R}$ is the kernel of $\widehat{R} \to R/J^{n}$.

	The other statements follow as well.
\end{proof}

\begin{exe}
	Check that in the above setup, we have $(J \widehat{R})^{n} = J^{n} \widehat{R}$.
\end{exe}

\subsection{Properties of completion}

For this subsection, we shall assume that $R$ is a Noetherian ring, and $J \subset R$ is an ideal, $\widehat{R}$ will denote the $J$-adic completion.

\begin{defn}
	$R$ is said to be \deff{complete} in the $J$-adic topology if the map $R \to \widehat{R}$ is an isomorphism.
\end{defn}

\begin{rem}
	Note that $R$ is complete $\Rightarrow$ $R$ is Hausdorff in the $J$-adic topology, by \Cref{prop:R-to-completion-injective-hausdorff}.
\end{rem}

In terms of Cauchy sequences, one can note the following.

\begin{prop}
	The following are equivalent:
	\begin{enumerate}[label=(\roman*)]
		\item $R$ is complete.
		\item Every Cauchy sequence in $R$ has a unique limit.
		\item Every Cauchy sequence in $R$ converges, and $R$ is Hausdorff.
		\item Every Cauchy sequence in $R$ converges, and $\bigcap_{n \ge 1} J^{n} = 0$.
	\end{enumerate}
\end{prop}
For the above proposition, one could work in the full generality of $R$ being an arbitrary ring and $\langle I_{t} \rangle_{t \ge 1}$ an arbitrary sequence of decreasing ideals.
\begin{proof} 
	(iii) $\Leftrightarrow$ (iv) is clear from earlier discussions (\Cref{prop:hausdorff-iff-trivial-intersection}). 

	(iii) $\Rightarrow$ (ii) is clear from general topology. 

	(ii) $\Rightarrow$ (iv): If there is a nonzero element $y \in \bigcap_{n \ge 1} J^{n}$, then the constant sequence $(0)_{n \ge 0}$ has converges to both $0$ and $y$.

	Thus, it suffices to now show (i) $\Leftrightarrow$ (iv). The proof is very similar to that of \Cref{thm:equivalence-of-completions}, and is left to the reader.
\end{proof}

Note that \Cref{cor:completion-of-completion} told us that $\widehat{R}$ is complete in the $J \widehat{R}$-adic topology, in the sense that $\widehat{R} \to \widehat{\widehat{R}}$ is an isomorphism. In particular, this tells us that $\widehat{R}$ is Hausdorff and that every Cauchy sequence in $\widehat{R}$ converges (in the $J \widehat{R}$-adic topology). 

\begin{cor}
	If $u \in \widehat{R}$ is a unit, and $x \in J \widehat{R}$, then $u + x$ is a unit.

	Consequently, $I \widehat{R}$ is contained in the Jacobson radical of $R$. (Equivalently, every maximal ideal of $\widehat{R}$ contains $I \widehat{R}$.)
\end{cor}
\begin{proof} 
	It suffices to show that $1 - x$ is a unit. Consider the following sequence in $\widehat{R}$:
	\begin{equation*} 
		1, 1 + x, 1 + x + x^{2}, \ldots.
	\end{equation*}
	Note that if $m > n \ge M$, then
	\begin{equation*} 
		(1 + x + \cdots + x^{m}) - (1 + x + \cdots + x^{n}) = x^{m} + \cdots + x^{n + 1} \in (J \widehat{R})^{M}.
	\end{equation*}
	Thus, the sequence is Cauchy and has a limit, which we denote by $1 + x + x^{2} + \cdots$.

	Note that
	\begin{equation*} 
		(1 - x)(1 + x + \cdots + x^{n}) = 1 - x^{n + 1}.
	\end{equation*}
	Thus,
	\begin{equation*} 
		1 - (1 - x)(1 + x + \cdots + x^{n}) = -x^{n + 1} \in (J \widehat{R})^{n + 1}.
	\end{equation*}

	From the above, conclude that $1 + x + x^{2} + \cdots$ is the desired inverse.
\end{proof}

\begin{cor}
	Suppose $(R, \mathfrak{m})$ is a local Noetherian ring. Then, $(\widehat{R}, \mathfrak{m} \widehat{R})$ is a local Noetherian ring.

	Moreover,
	\begin{equation*} 
		R \to \widehat{R}^{\mathfrak{m}}
	\end{equation*}
	is a local and faithfully flat ring map, with $R/\mathfrak{m} \cong \widehat{R}/\mathfrak{m}\widehat{R}$.
\end{cor}

\section{Regular sequences and depth}

\subsection{Regular sequences}

\begin{defn}
	Let $M$ be an $R$-module, and $x \in R$. We say that $x \in R$ is an \deff{$M$-regular element} if $x$ is a nonzerodivisor on $M$.

	A sequence $\mathbf{x} = x_{1}, \ldots, x_{n}$ of elements in $R$ is called an \deff{$M$-regular sequence} or simply an \deff{$M$-sequence} if the following conditions are met:
	\begin{enumerate}[label=(\roman*)]
		\item $x_{i}$ is an $M/(x_{1}, \ldots, x_{n - 1})M$-regular sequence for $i \in \{1, \ldots, n\}$,
		\item $M/\mathbf{x}M \neq 0$.
	\end{enumerate}
	A \deff{regular sequence} is an $R$-sequence.

	A \deff{weak $M$-sequence} is only required satisfy (i).
\end{defn}

Note that if $(R, \mathfrak{m})$ is a local ring, $M \neq 0$ a finitely generated $R$-module, and $\mathbf{x} \subset M$, then condition (ii) is automatically satisfied due to Nakayama's lemma.

Note that condition (i) can be rephrased as saying that the $R$-module map
\begin{equation*} 
	M/(\mathbf{x}_{< i})M \xrightarrow{x_{i}} M/(\mathbf{x}_{< i})M
\end{equation*}
is injective for all $i$.

\begin{prop} \label{prop:regularity-flat-tensor}
	Let $R$ be a ring, $M$ an $R$-module, and $\mathbf{x} \subset R$ a weak $M$-sequence. Suppose $\varphi : R \to S$ is a ring homomorphism, and $N$ an $S$-module which is flat as an $R$-module. \newline
	Then, $\mathbf{x} \subset R$ and $\varphi(x) \subset S$ are weak $(M \otimes_{R} N)$-sequences. \newline
	If $\mathbf{x}(M \otimes_{R} N) \neq M \otimes_{R} N$, then $\mathbf{x}$ and $\varphi(\mathbf{x})$ are $(M \otimes_{R} N)$-sequences.
\end{prop}
\begin{proof} 
	For the first part, note that by hypothesis,
	\begin{equation*} 
		M/(\mathbf{x}_{< i})M \xrightarrow{x_{i}} M/(\mathbf{x}_{< i})M
	\end{equation*}
	is injective for all $i$. Since $N$ is a flat $R$-module, we get that
	\begin{equation*} 
		M/(\mathbf{x}_{< i})M \otimes_{R} N \xrightarrow{x_{i}} M/(\mathbf{x}_{< i})M \otimes_{R} N
	\end{equation*}
	is injective for all $i$. Furthermore, by exactness again, we have a natural isomorphism
	\begin{equation*} 
		M/(\mathbf{x}_{< i})M \otimes_{R} N \cong (M \otimes_{R} N)/((\mathbf{x}_{< i})(M \otimes_{R} N)).
	\end{equation*}
	This shows that $\mathbf{x} \subset R$ is weakly regular. The same is true for $\varphi(\mathbf{x}) \subset S$ because the $R$-$S$ bimodule structure on $N$ gives us
	\begin{equation*} 
		x (m \otimes n) = m \otimes (x \cdot n) = m \otimes (\varphi(x) n) = \varphi(x)(m \otimes n).
	\end{equation*}

	The second statement now follows by definition of being regular.
\end{proof}

\begin{cor} \label{cor:regularity-localisation-completion}
	Let $R$ be a noetherian ring, $M$ a finite $R$-module, and $\mathbf{x}$ an $M$-sequence.
	\begin{itemize}
		\item Suppose $\mathfrak{p} \in \Supp M$ is such that $\mathbf{x} \subset \mathfrak{p}$. Then, $\mathbf{x} \subset R_{\mathfrak{p}}$ is an $M_{\mathfrak{p}}$-sequence.
		\item Suppose that $R$ is local with maximal ideal $\mathfrak{m}$. Then, $\mathbf{x} \subset \widehat{R}$ is an $\widehat{M}$-sequence, where $\widehat{(-)}$ denotes completion with respect to $\mathfrak{m}$.
	\end{itemize}
\end{cor}
\begin{proof} 
	Both the extensions $R \to R_{\mathfrak{p}}$ and $R \to \widehat{R}$ are flat. We just need to ensure that quotient-ing by $\mathbf{x}$ in either case remains nonzero. 

	For the first, note that $M_{\mathfrak{p}}$ is a finite $R_{\mathfrak{p}}$ module, which is nonzero by the hypothesis that $\mathfrak{p} \in \Supp M$. Thus, Nakayama's lemma now gives the result.

	Similarly, $\widehat{M} = M \otimes_{R} \widehat{R}$ is a nonzero finite $\widehat{R}$-module.
\end{proof}

\begin{prop} \label{prop:regular-sequence-tensor}
	Let $R$ be a ring, $M$ an $R$-module, and $\mathbf{x}$ a weak $M$-sequence. Then an exact sequence
	\begin{equation*} 
		N_{2} \xrightarrow{\varphi_{2}} N_{1} \xrightarrow{\varphi_{1}} N_{0} \xrightarrow{\varphi_{0}} M \to 0
	\end{equation*}
	of $R$-modules induces an exact sequence
	\begin{equation*} 
		N_{2}/\mathbf{x} N_{2} \xrightarrow{\varphi_{2}} N_{1}/\mathbf{x} N_{1} \xrightarrow{\varphi_{1}} N_{0}/\mathbf{x} N_{0} \xrightarrow{\varphi_{0}} M/\mathbf{x} M \to 0.
	\end{equation*}
\end{prop}
\begin{proof} 
	By induction on length of $\mathbf{x}$, it suffices to prove it in the case that $\mathbf{x}$ is a single element, say $x$. By right-exactness of $- \otimes_{R} R/x$, exactness only needs to be checked at $N_{1}/x N_{1}$.

	This is now a simple diagram chase: let $\overline{n_{1}} \in \ker(\overline{\varphi_{1}})$.
	\begin{itemize}
		\item $\overline{\varphi_{1}(n_{1})} = 0$; hence, $\varphi_{1}(n_{1}) \in x N_{0}$.
		\item Write $\varphi_{1}(n_{1}) = x n_{0}$ for some $n_{0} \in N_{0}$. 
		\item $x \varphi_{0}(n_{0}) = \varphi_{0}(x n_{0}) = \varphi_{0}(\varphi_{1}(n_{1})) = 0$, since $\varphi_{0} \circ \varphi_{1} = 0$.
		\item Since $x$ is a nonzerodivisor on $M$, we get $\varphi_{0}(n_{0}) = 0$. 
		\item By exactness of original sequence, we can write $n_{0} = \varphi_{1}(n_{1}')$ for $n_{1}' \in N_{1}$.
		\item Thus,
		\begin{equation*} 
			\varphi_{1}(n_{1}) = x n_{0} = x \varphi_{1}(n_{1}')
		\end{equation*}
		or $n_{1} - x n_{1}' \in \ker(\varphi_{1})$.
		\item By exactness, we can write $n_{1} = x n_{1}' + \varphi_{2}(n_{2})$ for some $n_{2} \in N_{2}$.
		\item Going modulo $x N_{1}$, we are done. \qedhere
	\end{itemize}
\end{proof}

\begin{prop} \label{prop:regular-sequence-tensor-strong}
	Let $R$ be a ring and
	\begin{equation*} 
		N_{\bullet} : \quad \cdots \to N_{m} \xrightarrow{\varphi_{m}} N_{m - 1} \to \cdots \to N_{0} \xrightarrow{\varphi_{0}} N_{-1} \to 0
	\end{equation*}
	an exact complex of $R$-complexes. If $\mathbf{x} \subset R$ is weakly $N_{i}$-regular for all $i \ge -1$, then $N_{\bullet} \otimes_{R} R/(\mathbf{x})$ is exact again.
\end{prop}
\begin{proof} 
	Adapt the previous proof.
\end{proof}

\begin{prop}
	Let $(R, \mathfrak{m})$ be a noetherian local ring, $M$ a finite $R$-module, and $\mathbf{x}$ and $M$-sequence (necessarily, $\mathbf{x} \subset \mathfrak{m}$). Then, every permutation of $\mathbf{x}$ is a regular sequence.
\end{prop}
\begin{proof} 
	It suffices to prove the theorem for transpositions that switch consecutive elements. Thus, it suffices to prove it for the case $\mathbf{x} = x_{1}, x_{2}$.

	\textbf{Step 1.} $x_{2}$ is $M$-regular.

	Let $K \vcentcolon= (0 :_{M} x_{2})$. We wish to show $K = 0$. By Nakayama's lemma, it suffices to prove $K \subset x_{1} K$. 

	Let $m \in K$. Thus, $x_{2} m = 0$. Going modulo $x_{1} M$ and using the regularity hypothesis, we get $\overline{m} = 0$ in $M/x_{1} M$. Write $m = x_{1} m'$. We show that $m' \in K$, i.e., $x_{2} m' = 0$. To this end, note
	\begin{equation*} 
		x_{1}(x_{2} m') = x_{2}(x_{1} m') = x_{2} m = 0.
	\end{equation*}
	Since $x_{1}$ is $M$-regular, we are done.

	\textbf{Step 2.} $x_{1}$ is $M/x_{2} M$-regular.

	Let $m \in M$ be such that $x_{1} m \in x_{2} M$. We wish to show $m \in x_{2} M$. \newline
	Write $x_{1} m = x_{2} m'$. Going modulo $x_{1} M$ and using regularity shows $m' \in x_{1} M$. Write $m' = x_{1} m''$. Then,
	\begin{equation*} 
		x_{1} m = x_{1} x_{2} m''.
	\end{equation*}
	Cancel $x_{1}$ to get the result.
\end{proof}

Let $R$ be a ring, $M$ an $R$-module, and $\mathbf{X} = X_{1}, \ldots, X_{n}$ be indeterminates over $R$. We define $M[\mathbf{X}] \vcentcolon= M \otimes_{R} R[\mathbf{X}]$ and call its elements \deff{polynomials with coefficients in $M$}. \newline
If $\mathbf{x} = x_{1}, \ldots, x_{n}$ is a sequence of elements in $R$, then the substitution $X_{i} \mapsto x_{i}$ induces an $R$-algebra map $R[\mathbf{X}] \to R$ and an $R$-module map $M[\mathbf{X}] \to M$. We write $F(\mathbf{x})$ for the image of $F \in M[\mathbf{X}]$ under this map.

Since the monomials form a free $R$-basis for $R[\mathbf{X}]$, we may speak of the coefficients and the degree of an element of $M[\mathbf{X}]$. For example, in the one variable case, elements of $M[X]$ are of the form
\begin{equation*} 
	m_{0} + m_{1} X + \cdots + m_{n} X^{n}
\end{equation*}
for $m_{0}, \ldots, m_{n}$. The action of $r_{0} + \cdots + r_{m} X^{m} \in R[X]$ on the above element is given by the obvious definition.

\begin{thm}[Rees] \label{thm:rees-regular-sequence}
	Let $R$ be a ring, $M$ an $R$-module, $\mathbf{x} = x_{1}, \ldots, x_{n}$ an $M$-sequence, and $I = (\mathbf{x})$. Let $\mathbf{X} = X_{1}, \ldots, X_{n}$ be indeterminates over $R$. If $F \in M[\mathbf{X}]$ is homogeneous of (total) degree $d$ and $F(\mathbf{x}) \in I^{d + 1} M$, then the coefficients of $F$ are in $I M$.
\end{thm}

\begin{rem}
	The above can be rephrased as following: Let $R$ be a ring, $M$ an $R$-module, $\mathbf{x} = x_{1}, \ldots, x_{n}$ an $M$-sequence, and $I = (\mathbf{x})$. Suppose we have an equation of the form
	\begin{equation*} 
		\sum_{\md{\alpha} = d} \mathbf{x}^{\alpha} m_{\alpha} = 0,
	\end{equation*}
	where $m_{\alpha} \in M$. (Notational clarification: $\alpha \in \mathbb{N}_{0}^{n}$ varies over multi-indices with $\sum \alpha_{i} = d$. $\mathbf{x}^{\alpha} \vcentcolon= x_{1}^{\alpha_{1}} \cdots x_{n}^{\alpha_{n}}$.) 

	Then, $m_{\alpha} \in IM$ for all $\alpha$.
\end{rem}

\begin{proof} 
	??
\end{proof}

Recall \Cref{defn:associated-graded}: given an ideal $I \unlhd R$, we define
\begin{equation*} 
	\gr_{I}(R) = \bigoplus_{i \ge 0} I^{i}/I^{i + 1},
\end{equation*}
and given an $R$-module $M$, we put
\begin{equation*}
	\gr_{I}(M) = \bigoplus_{i \ge 0} I^{i}M/I^{i + 1}M,
\end{equation*}
making $\gr_{I}(R)$ a graded ring, and $\gr_{I}(M)$ a graded $\gr_{I}(R)$-module.

If $I = (x_{1}, \ldots, x_{n})$, then we have a natural surjective graded ring homomorphism
\begin{equation} \label{eq:008}
	R[X_{1}, \ldots, X_{n}] \onto \gr_{I}(R)
\end{equation}
given by $X_{i} \mapsto \overline{x_{i}} \in I/I^{2}$. (Elements of $R$ mapped via the natural map $R \to R/I$.) To see that this is a surjection, note that $\gr_{I}(R)$ is generated (as an $R/I$-algebra) by $I/I^{2}$.

Similarly, there is an epimorphism (of graded abelian groups)
\begin{equation*} 
	\psi : M[X_{1}, \ldots, X_{n}] \onto \gr_{I}(M)
\end{equation*}
defined as following: a homogeneous polynomial $F \in M[\mathbf{X}]$ of degree $d$ is mapped to $\overline{F(\mathbf{x})} \in I^{d} M/I^{d + 1} M$. $\psi$ is then extended additively. Surjectivity is clear since any element of $I^{d} M$ is an additive linear combination of elements of the form $\mathbf{x}^{\alpha} m$, where $m \in M$ and $\md{\alpha} = d$.

Now, note that \Cref{eq:008} makes $\gr_{I}(R)$ into an $R[\mathbf{X}]$-algebra. Thus, $\gr_{I}(M)$ has the structure of a graded $R[\mathbf{X}]$-module as well. With this structure, one checks $\psi$ is a map of graded $R[\mathbf{X}]$-modules.

Note that $IM[\mathbf{X}] \subset \ker \psi$. Thus, we get an induced epimorphism
\begin{equation*} 
	\varphi : (M/IM)[\mathbf{X}] \onto \gr_{I}(M),
\end{equation*}
where we have used the isomorphism $M[\mathbf{X}]/IM[\mathbf{X}] \cong (M/IM)[\mathbf{X}]$ since $R[\mathbf{X}]$ is a flat (free even) $R$-module. Note that $\varphi$ is an isomorphism iff $IM[\mathbf{X}] = \ker \psi$. Since $\psi$ is a graded map, $\ker \psi$ is determined by its homogeneous components. Note that $F \in M[\mathbf{X}]$ of degree $d$ is in the kernel iff $F(\mathbf{x}) \in I^{d + 1} M$. Thus, a reformulation of \Cref{thm:rees-regular-sequence}, we get the following.

\begin{thm} \label{thm:regular-polynomial-graded-isomorphism}
	Let $R$ be a ring, $M$ an $R$-module, $\mathbf{x} = x_{1}, \ldots, x_{n}$ an $M$-sequence, and $I = (\mathbf{x})$. Then, the map
	\begin{equation*} 
		(M/IM)[X_{1}, \ldots, X_{n}] \to \gr_{I}(M)
	\end{equation*}
	induced by $X_{i} \mapsto \overline{x_{i}} \in I/I^{2}$ is an isomorphism.
\end{thm}

\begin{defn}
	Let $R$ be a ring, $M$ an $R$-module, and $\mathbf{x} = x_{1}, \ldots, x_{n} \subset R$ a sequence of elements of $R$. \newline
	We say that $\mathbf{x}$ is \deff{$M$-quasi-regular} if $\mathbf{x} M \neq M$ and the conclusion of \Cref{thm:regular-polynomial-graded-isomorphism}.
\end{defn}

\textbf{Exercises.}

\begin{exe}
	Let $0 \to U \to M \to N \to 0$ be an exact sequence of $R$-modules, and $\mathbf{x}$ a sequence which is weakly $U$-regular and (weakly) $N$-regular. Prove that $\mathbf{x}$ is (weakly) $M$-regular too.
\end{exe}
\begin{soln}
	Write $\mathbf{x} = x_{1}, \ldots, x_{n}$. We have a commutative diagram with exact rows:
	\begin{equation*} 
		\begin{tikzcd}
			0 \arrow[r] & U \arrow[d, "x_{1}"] \arrow[r] & M \arrow[d, "x_{1}"] \arrow[r] & N \arrow[d, "x_{1}"] \arrow[r] & 0 \\
			0 \arrow[r] & U \arrow[r] & M \arrow[r] & N \arrow[r] & 0
		\end{tikzcd}
	\end{equation*}

	The outer vertical arrows are injections by hypothesis. The Five Lemma now implies the same for the middle arrow. By \Cref{prop:regular-sequence-tensor-strong}, we see that the sequence
	\begin{equation*} 
		0 \to U/x_{1} U \to M/x_{1} M \to N/x_{1} N \to 0
	\end{equation*}
	is again exact. Induction now proves the statement involving ``weakly''.

	Now, if $\mathbf{x} M = M$, then it follows that $\mathbf{x} N = N$. This finishes the proof.
\end{soln}

\begin{exe}
	\begin{enumerate}[label=(\alph*)]
		\item Let $x_{1}, \ldots, x_{i}, \ldots, x_{n}$ and $x_{1}, \ldots, x_{i} x_{i}', \ldots, x_{n}$ be (weakly) $M$-regular. Show that $x_{1}, \ldots, x_{i} x_{i}', \ldots, x_{n}$ is (weakly) $M$-regular.
		\item Prove that $x_{1}^{e_{1}}, \ldots, x_{n}^{e_{n}}$ is (weakly) $M$-regular for all $e_{i} \ge 1$.
	\end{enumerate}
\end{exe}
\begin{soln}
	It is clear that (b) follows from (a). We prove (a). It suffices to assume $i = 1$. \newline
	If $x_{1}$ and $x_{1}'$ are nonzerodivisors, then so is $x_{1} x_{1}'$. We now wish to prove that $\mathbf{x}_{> 1}$ is a (weakly) regular sequence on $M/x_{1} x_{1}' M$. 

	We have a short sequence
	\begin{equation*} 
		0 \to M/x_{1}'M \xrightarrow{\iota} M/x_{1} x_{1}' M \xrightarrow{\pi} M/x_{1} M \to 0
	\end{equation*}
	where $\pi$ is the natural surjection and $\iota$ is given by $\overline{m} \mapsto \overline{x_{1} m}$. It is not difficult to check that $\iota$ is well-defined and that $\ker \pi = \im \iota$. \newline
	To see that $\iota$ is injective, one uses that $x_{1}$ is a nonzerodivisor.

	Now, by the previous exercise, the statement follows.
\end{soln}

\begin{exe}
	Prove that the converse of \Cref{prop:regularity-flat-tensor} holds if, in the situation of \ref{prop:regularity-flat-tensor}, $N$ is faithfully flat over $R$.
\end{exe}
\begin{soln}
	We wish to prove the following statement: \newline
	
	\begin{blockquote}
		Let $R$ be a ring, $M$ an $R$-module, and $\mathbf{x} \subset R$. Suppose $\varphi : R \to S$ is a ring homomorphism, and $N$ an $S$-module which is faithfully flat as an $R$-module. \newline
		If $\mathbf{x} \subset R$ (and $\varphi(x) \subset S$) are (weak) $(M \otimes_{R} N)$-sequences, then $\mathbf{x} \subset R$ is a (weak) $M$-sequence.
	\end{blockquote}

	Let $\mathbf{x} = x_{1}, \ldots, x_{n}$. First, we wish to show that $M \xrightarrow{x_{1}} M$ is injective. We are given that the map is injective after tensoring with $N$. Since $N$ is faithfully flat, it must have been injective to begin with.

	Now, note that by flatness, we have
	\begin{equation*} 
		(M \otimes_{R} N)/(x_{1} (M \otimes_{R} N)) \cong (M/x_{1} M) \otimes_{R} N.
	\end{equation*}

	Thus, injectivity of $M/x_{1} M \xrightarrow{x_{2}} M/x_{1} M$ also follows similarly and so on.

	Lastly, if $\mathbf{x} M = M$, then we must have $\mathbf{x} (M \otimes_{R} N) = M \otimes_{R} N$.
\end{soln}

\begin{exe}
	\begin{enumerate}
		\item Prove that if $\mathbf{x}$ is a weak $M$-sequence, then $\Tor^{R}_{1}(M, R/(\mathbf{x})) = 0$.
		\item Prove that if, in addition, $\mathbf{x}$ is a weak $R$-sequence, then $\Tor^{R}_{i}(M, R/(\mathbf{x})) = 0$ for all $i \ge 1$.
	\end{enumerate}
\end{exe}
\begin{soln}
	?? Need Koszul.
\end{soln}

\begin{exe}
	Let $R = k[X, Y, Z]$, $k$ a field. Show that $X$, $Y(1 - X)$, $Z(1 - X)$ is an $R$-sequence, but $Y(1 - X)$, $Z(1 - X)$, $X$ is not.
\end{exe}
\begin{soln}
	Direct.
\end{soln}

\begin{exe}
	Prove that $x_{1}, \ldots, x_{n}$ is $M$-quasi-regular if and only if $\overline{x_{1}}, \ldots, \overline{x_{n}} \in I/I^{2}$ is a $\gr_{I}(M)$-regular sequence where $I = (x_{1}, \ldots, x_{n})$.
\end{exe}
\begin{soln}
	Let $\varphi$ denote the map
	\begin{equation*} 
		\varphi : (M/IM)[\mathbf{X}] \onto \gr_{I}(M)
	\end{equation*}

	\forward Suppose $\overline{\mathbf{x}}$ is $M$-quasi-regular, i.e., $\varphi$ is an isomorphism, and $\overline{\mathbf{x}} \gr_{I}(M) \neq \gr_{I}(M)$. Note that $\overline{\mathbf{x}} \subset \gr_{I}(R)$ acts on $\gr_{I}(M)$ via $\mathbf{X}$. Since $\varphi$ is an isomorphism, it suffices to show that $\mathbf{X}$ is $(M/IM)[\mathbf{X}]$-regular. But this is clear.

	\backward We just need to show that $\varphi$ is one-one. Since $\varphi$ is graded, it suffices to show that there is no nonzero homogeneous element in the kernel. To this end, let $F \in \ker \varphi$ be homogeneous of degree $d$. Then, we can write
	\begin{equation*} 
		F  = \sum_{\md{\alpha} = d} \overline{m_{\alpha}} \mathbf{X}^{\alpha},
	\end{equation*}
	for $\overline{m_{\alpha}} \in M/IM$. We wish to show that $\overline{m_{\alpha}} = 0 \in M/IM$ for all $\alpha$. Note that $F$ being in the kernel gives us that
	\begin{equation*} 
		\sum_{\md{\alpha} = d} \mathbf{\overline{x}}^{\alpha} \overline{m_{\alpha}}= 0.
	\end{equation*}
	Now, \Cref{thm:rees-regular-sequence} tells us that $\overline{\mathfrak{m}_{\alpha}} \in J \gr_{I}(M)$ for all $\alpha$, where $J \vcentcolon= (\overline{\mathbf{x}}) \gr_{I}(R)$. But note that $\overline{m_{\alpha}}$ (as an element of $\gr_{I}(M)$) has degree zero, whereas every nonzero element of $J \gr_{I}(M)$ has positive degree. Thus, it follows that $\overline{m_{\alpha}} = 0$ in $M/IM$, as desired.
\end{soln}

\begin{exe}
	Suppose that $\mathbf{x}$ is $M$-quasi-regular, and let $I = (x_{1}, \ldots, x_{n})$. Prove
	\begin{enumerate}[label=(\alph*)]
		\item if $x_{1} z \in I^{i + 1} M$ for $z \in M$, then $z \in I^{i} M$,
		\item $x_{2}, \ldots, x_{n}$ is $(M/x_{1} M)$-quasi-regular,
		\item if $R$ is noetherian local and $M$ is finite, then $\mathbf{x}$ is an $M$-sequence.
	\end{enumerate}
\end{exe}
\begin{soln}
	As before, we let $\varphi$ denote the map
	\begin{equation*} 
		\varphi : (M/IM)[\mathbf{X}] \xrightarrow{\cong} \gr_{I}(M)
	\end{equation*}
	\begin{enumerate}[label=(\alph*)]
		\item Suppose $z \notin I^{i} M$. Pick the largest $j$ such that $z \in I^{j} M$.\footnote{Such a $j$ exists since $z \in I^{0}M$.} By hypothesis, $j \le i - 1$ and $\overline{z} \in I^{j} M/I^{j + 1} M$ is nonzero. Let $G \vcentcolon= \varphi^{-1}(\overline{z}) \neq 0$. 

		Then,
		\begin{equation*} 
			\varphi(X_{1} \cdot G) = X_{1} \cdot \varphi(G) = \overline{x_{1} z} = 0.
		\end{equation*}
		The last equality follows since $x_{1} z \in I^{i + 1} M \subset I^{j + 2} M$, giving us $\overline{x_{1} z} = 0 \in I^{j + 1} M/I^{j + 2} M$. 

		But this is a contradiction because $\varphi$ is an isomorphism and $X_{1} G \neq 0$ in $(M/IM)[\mathbf{X}]$.
		%
		\item Let $J \vcentcolon= (x_{2}, \ldots, x_{n})$. By the previous exercise, we know that $\overline{x_{1}}, \ldots, \overline{x_{n}} \in \gr_{I}(R)$ is regular on $\gr_{I}(M)$, and that it suffices to show that $\overline{x_{2}}, \ldots, \overline{x_{n}} \in \gr_{J}(R)$ is regular on $\gr_{J}(M/x_{1} M)$.

		??
		% By definition of regularity, we know that $\overline{x_{2}}, \ldots, \overline{x_{n}} \in \gr_{I}(R)$ is regular on $\gr_{I}(M)/x_{1} \gr_{I}(M)$. 
		%
		\item By part (b), it suffices to prove this in the case $\mathbf{x} = x$ is a single element. Necessarily, $I = (x) \subset \mathfrak{m}$.

		Suppose that $m \in M$ is such that $x m = 0$. Then, $x m \in I^{i + 1} M$ for all $i$. By (a), this implies that $m \in \bigcap_{i \ge 0} I^{i} M$. But by \mynameref{thm:KIT}, we get that $m = 0$, as desired. \qedhere
	\end{enumerate}
\end{soln}

\subsection{Grade and depth}

\begin{defn}
	Let $R$ be a ring, $M$ an $R$-module, and $I \subset R$ an ideal. An $M$-sequence $x_{1}, \ldots, x_{n}$ (contained in $I$) is \deff{maximal (in $I$)}, if $x_{1}, \ldots, x_{n + 1}$ is not an $M$-sequence for any $x_{n + 1} \in R$ ($x_{n + 1} \in I$).	
\end{defn}

Note that if $\mathbf{x}$ is an $M$-sequence, then the sequence $(x_{1}) \subsetneq (x_{1}, x_{2}) \cdots (x_{1}, \ldots, x_{n})$ strictly increases. Thus, every $M$-sequence (contained in $I$) can be extended to a maximal such sequence if the ring is noetherian.

We recall the following fact regarding associated primes for noetherian rings and modules.

\begin{prop}
	Let $R$ be a noetherian ring, and $M \neq 0$ a finite $R$-module. If an ideal $I \subset R$ consists of zerodivisors of $M$, then $I \subset \mathfrak{p}$ for some $\mathfrak{p} \in \Ass(M)$.
\end{prop}
\begin{proof} 
	Recall $\mathcal{Z}(M) = \bigcup_{\mathfrak{p} \in \Ass M} \mathfrak{p}$, and that $\Ass(M)$ is nonempty and finite. By prime avoidance, the result now follows.
\end{proof}

\begin{prop} \label{prop:Hom-N-M-zero-regular}
	Let $R$ be a ring, and $M \neq 0$, $N$ be $R$-modules. Set $I \vcentcolon= \ann_{R}(N)$.
	\begin{enumerate}[label=(\alph*)]
		\item If $I$ contains an $M$-regular element, then $\Hom_{R}(N, M) = 0$.
		\item Conversely, if $R$ is noetherian, and $M$, $N$ are finite, $\Hom_{R}(N, M) = 0$ implies that $I$ contains an $M$-regular element.
	\end{enumerate}
\end{prop}
\begin{proof} 
	\begin{enumerate}[label=(\alph*)]
		\item Let $\varphi \in \Hom_{R}(N, M) = 0$, and $r \in I$ be $M$-regular. We wish to show that $\varphi(n) = 0$ for all $n$. To this end, note that
		\begin{equation*} 
			r \varphi(n) = \varphi(r n) = \varphi(0) = 0
		\end{equation*}
		for all $n \in N$. Since $r$ is $M$-regular, we may cancel $r$ to get the result.
		%
		\item Suppose that $I$ does not contain any $M$-regular element. Then, $I \subset \mathfrak{p}$ for some $\mathfrak{p} \in \Ass M$. Since $N$ is finite, we get that $\mathfrak{p} \in \Supp N$ and that $N_{\mathfrak{p}} \otimes_{R_{\mathfrak{p}}} k(\mathfrak{p})$ is nonzero. Since we are working over a field, we have an epimorphism 
		\begin{equation*} 
			N_{\mathfrak{p}} \otimes_{R_{\mathfrak{p}}} k(\mathfrak{p}) \onto k(\mathfrak{p}).
		\end{equation*} 
		Note that $\mathfrak{p} R_{\mathfrak{p}} \in \Ass(M_{\mathfrak{p}})$. This means that we have an inclusion $k(\mathfrak{p}) \into M_{\mathfrak{p}}$. Composing with the map above gives us a nonzero map $N_{\mathfrak{p}} \to M_{\mathfrak{p}}$. Since
		\begin{equation*} 
			\Hom_{R_{\mathfrak{p}}}(M_{\mathfrak{p}}, N_{\mathfrak{p}}) \cong \Hom_{R}(M, N)_{\mathfrak{p}},
		\end{equation*}
		we are done. \qedhere
	\end{enumerate}
\end{proof}

\begin{lem} \label{lem:Hom-Ext-regular-sequence}
	Let $R$ be a ring, $M$, $N$ be $R$-modules, and $\mathbf{x} = x_{1}, \ldots, x_{n}$ a weak $M$-sequence in $\ann_{R}(N)$. Then,
	\begin{equation*} 
		\Hom_{R}(N, M/\mathbf{x}M) \cong \Ext_{R}^{n}(N, M).
	\end{equation*}
\end{lem}
\begin{proof} 
	We induct on $n$. The case $n = 0$ is clear. Now, assume $n \ge 1$. By induction, we have
	\begin{equation*} 
		\Ext_{R}^{n - 1}(N, M) \cong \Hom_{R}(N, M/\mathbf{x}_{< n} M).
	\end{equation*}
	Since $x_{n} \in \ann_{R}(N)$ is regular on $M/\mathbf{x}_{< n} M$, the above object is zero, by the previous result.

	Note that we have the short exact sequence
	\begin{equation*} 
		0 \to M \xrightarrow{x_{1}} M \to M/x_{1} M \to 0.
	\end{equation*}
	Applying (the derived) $\Hom_{R}(N, -)$ to the above gives the long exact sequence
	\begin{equation*} 
		0 \to \Ext_{R}^{n - 1}(N, M/x_{1} M) \xrightarrow{\psi} \Ext_{R}^{n}(N, M) \xrightarrow{x_{1}} \Ext_{R}^{n}(N, M).
	\end{equation*}
	However, multiplication by $x_{1}$ above is zero since $x_{1} \in \ann_{R}(N)$. Thus, $\psi$ is an isomorphism. Using induction again proves the result.
\end{proof}

Let $R$ be noetherian, $I$ an ideal, $M$ a finite $R$-module with $M \neq IM$, and $\mathbf{x} = x_{1}, \ldots, x_{n}$ a maximal $M$-sequence contained in $I$. Using \Cref{prop:Hom-N-M-zero-regular} and \Cref{lem:Hom-Ext-regular-sequence}, we get that
\begin{equation*} 
	\Ext_{R}^{i - 1}(R/I, M) \cong \Hom_{R}(R/I, M/(x_{1}, \ldots, x_{i - 1})M) = 0 \qquad \text{for all $i = 1, \ldots, n$},
\end{equation*}
since $I$ contains an $M/(\mathbf{x_{< i}})M$-regular sequence (and $\ann_{R}(R/I) = I$). On the other hand, since $\mathbf{x}$ is a maximal $M$-sequence in $I$ and $IM \neq I$, $I$ must consist of zerodivisors of $M/\mathbf{x} M$.\footnote{Note that a different reason for $\mathbf{x}$ not being maximal could have been that $(\mathbf{x}, y)M = M$ for all $y \in I$. But $IM \neq M$ ensures that that is not the case.} Thus, $\Ext_{R}^{n}(R/I, M/\mathbf{x}M) \cong \Hom_{R}(R/I, M/\mathbf{x}M) \neq 0$.

We have therefore proved the following.

\begin{thm}[Rees] \label{thm:grade-ext}
	Let $R$ be a noetherian ring, $M$ a finite $R$-module, and $I$ an ideal such that $IM \neq M$. Then, all maximal $M$-sequences in $I$ have the same length $n$ given by
	\begin{equation*} 
		n \vcentcolon= \inf \Ext_{R}^{\ast}(R/I, M).
	\end{equation*}
\end{thm}

Notation: If $\langle V^{i} \rangle_{i \in \mathbb{Z}}$ is a sequence of $R$-modules, we set
\begin{equation*} 
	\inf V^{\ast} \vcentcolon= \inf\{i : V^{i} \neq 0\}.
\end{equation*}
Note that $\inf V^{\ast} = \infty$ iff $V^{i} = 0$ for all $i$.

\begin{defn}
	Let $R$ be a noetherian ring, $M$ a finite $R$-module, and $I$ an ideal such that $IM \neq M$. Then, the common length of the maximal $M$-sequences in $I$ is called the \deff{grade of $I$ on $M$}, denoted by $\grade(I, M)$.

	If $IM = M$, we define $\grade(I, M) \vcentcolon= \infty$. (Including the possibility $M = 0$.)
\end{defn}

\begin{lem} 
	If $R$ is noetherian, $M$ a finite $R$-module, and $I$ an ideal, then $IM = M$ iff $\Ext_{R}^{i}(R/I, M) = 0$ for all $i$. Thus, the convention for grade is consistent with $\inf \Ext_{R}^{\ast}(R/I, M)$.
\end{lem}
\begin{proof} 
	\forward Assume $IM = M$. Then, $\Supp(M) \cap \Supp(R/I) = \emptyset$ by Nakayama's lemma,\footnote{Indeed, if not then there exists $\mathfrak{p} \in \Supp M$ such that $I \subset \mathfrak{p}$. Then, $IM = M$ implies $(I R_{\mathfrak{p}}) M_{\mathfrak{p}} = M_{\mathfrak{p}}$, a contradiction since $M_{\mathfrak{p}} \neq 0$.} hence
	\begin{equation*} 
		\Supp \Ext_{R}^{i}(R/I, M) \subset \Supp M \cap \Supp R/I = \emptyset
	\end{equation*}
	for all $i$. The inclusion above follows from the natural isomorphism
	\begin{equation*} 
		\Ext_{R_{\mathfrak{p}}}^{i}((R/I)_{\mathfrak{p}}, M_{\mathfrak{p}}) \cong \Ext_{R}^{i}(R/I, M)_{\mathfrak{p}}.
	\end{equation*}

	\backward If $IM \neq M$, then we have already seen $\grade(I, M)$ to be finite.
\end{proof}

\begin{defn}
	Let $(R, \mathfrak{m})$ be a noetherian local ring, and $M$ a finite $R$-module. Then the \deff{depth of $M$} is defined as
	\begin{equation*} 
		\depth(M) \vcentcolon= \grade(\mathfrak{m}, M).
	\end{equation*}
\end{defn}
We restate \Cref{thm:grade-ext} in term of depth.

\begin{thm}
	Let $(R, \mathfrak{m}, k)$ be a noetherian local ring, and $M$ a finite module. Then,
	\begin{equation*} 
		\depth M = \inf \Ext_{R}^{\ast}(k, M).
	\end{equation*}
\end{thm}

The following also follows from the $\Ext$ characterisation.

\begin{cor} \label{cor:depth-direct-sum}
	Let $(R, \mathfrak{m}, k)$ be a noetherian local ring, and $M$, $M'$ finite $R$-modules. Then,
	\begin{equation*} 
		\depth(M \oplus M') = \min(\depth(M), \depth(M')).
	\end{equation*}
	In particular, if $F$ is a nonzero finite free $R$-module, then $\depth(F) = \depth(R)$.
\end{cor}

\begin{prop} \label{prop:grade-exact-sequence}
	Let $R$ be a noetherian ring, $I \subset R$ an ideal, and $0 \to U \to M \to N \to 0$ an exact sequence of finite $R$-modules. Then,
	\begin{align*} 
		\grade(I, M) &\ge \min\{\grade(I, U), \grade(I, N)\}, \\
		\grade(I, U) &\ge \min\{\grade(I, M), \grade(I, N) + 1\}, \\
		\grade(I, N) &\ge \min\{\grade(I, U) - 1, \grade(I, M)\}.
	\end{align*}
\end{prop}
\begin{proof}
	Follows from the long exact sequence of $\Ext_{R}^{i}(R/I, -)$. For the first one, we have the exact sequence
	\begin{equation*} 
		\Ext_{R}^{i}(R/I, U) \to \Ext_{R}^{i}(R/I, M) \to \Ext_{R}^{i}(R/I, N).
	\end{equation*}
	Thus, if the outer two terms are zero, then so is the middle one. This proves the inequality.
\end{proof}

\begin{rem} \label{rem:grade-equalities-exact-sequences}
	We can sometimes comment about equality if we know some more information. For example, if $\grade(I, U) < \grade(I, N)$, then for $i = \depth(I, U)$, we note that we have the exact sequence
	\begin{equation*} 
		0 = \Ext_{R}^{i - 1}(R/I, N) \to \Ext_{R}^{i}(R/I, U) \to \Ext_{R}^{i}(R/I, M) \to \Ext_{R}^{i}(R/I, N) = 0.
	\end{equation*}
	Thus, $\Ext_{R}^{i}(R/I, M) \cong \Ext_{R}^{i}(R/I, U) \neq 0$. 

	This shows that $\grade(I, M) = \grade(I, U) = \min(\grade(I, U), \grade(I, N))$.

	Similarly, if $\grade(I, N) < \grade(I, M)$, then for $i = \grade(I, N)$, we have
	\begin{equation*} 
		0 = \Ext_{R}^{i}(R/I, M) \to \Ext_{R}^{i}(R/I, N) \into \Ext_{R}^{i + 1}(R/I, U),
	\end{equation*}
	showing $\Ext_{R}^{i + 1}(R/I, U) \neq 0$. Coupled with
	\begin{equation*} 
		0 = \Ext_{R}^{i - 1}(R/I, N) \to \Ext_{R}^{i}(R/I, U) \to \Ext_{R}^{i}(R/I, M) = 0,
	\end{equation*}
	we get that $\grade(I, U) = \grade(I, N) + 1$.
\end{rem}

\begin{prop} \label{prop:grade-properties}
	Let $R$ be a noetherian ring, $I$, $J$ ideals of $R$, and $M$ a finite $R$-module. Then,
	\begin{enumerate}[label=(\alph*)]
		\item $\grade(I, M) = \inf\{\depth_{R_{\mathfrak{p}}}(M_{\mathfrak{p}}) : \mathfrak{p} \in V(I)\}$,
		\item $\grade(I, M) = \grade(\sqrt{I}, M)$,
		\item $\grade(I \cap J, M) = \min\{\grade(I, M), \grade(J, M)\}$,
		\item if $\mathbf{x} = x_{1}, \ldots, x_{n}$ is an $M$-sequence in $I$, then $\grade(I/(\mathbf{x}), M/\mathbf{x}M) = \grade(I, M/\mathbf{x} M) = \grade(I, M) - n$,
		\item if $N$ is a finite $R$-module with $\Supp N = V(I)$, then
		\begin{equation*} 
			\grade(I, M) = \inf \Ext_{R}^{\ast}(N, M).
		\end{equation*}
	\end{enumerate}
\end{prop}
The last property generalises the equation $\grade(I, M) = \inf \Ext_{R}^{\ast}(N, M)$.

\begin{proof} 
	(a): we may assume that $I \neq R$. Note that if $IM = M$, then the same is true for all primes containing $I$ and both sides are $\infty$. Thus, we may assume $IM \neq M$. In this case, grade is given by the length of the longest $M$-sequence in the ideal. This gives us $\grade(I, M) \le \inf\{\depth(M_{\mathfrak{p}}) : \mathfrak{p} \in V(I)\}$ (using \Cref{cor:regularity-localisation-completion}). \newline
	We now show that equality is achieved: pick $\mathbf{x} \subset I$ to be a maximal $M$-sequence. Since $IM \neq M$, this tells us that $I$ consists of zerodivisors on $M/\mathbf{x} M$. Thus, $I \subset \mathfrak{p}$ for some $\mathfrak{p} \in \Ass(M)$. By definition, we have $\mathfrak{p} \in V(I)$. Moreover, $\mathbf{x} \subset \mathfrak{p} R_{\mathfrak{p}}$ is a regular sequence on $M_{\mathfrak{p}}$. But $\mathfrak{p} R_{\mathfrak{p}}$ is now an associated prime of $(M/\mathbf{x} M)_{\mathfrak{p}} = M_{\mathfrak{p}}/\mathbf{x} M_{\mathfrak{p}}$ showing that $\mathfrak{p} R_{\mathfrak{p}}$ consists of zerodivisors on $M_{\mathfrak{p}}/\mathbf{x} M_{\mathfrak{p}}$ and thus, $\mathbf{x}$ is a maximal $M_{\mathfrak{p}}$-sequence.

	(b) and (c): Follow from (a) since $V(I) = V(\sqrt{I})$ and $V(I \cap J) = V(I) \cup V(J)$.

	(d): Let $\overline{\cdot}$ denote going modulo $\mathbf{x}$. Note that
	\begin{equation*} 
		IM = M \Leftrightarrow I \overline{M} = \overline{M} \Leftrightarrow \overline{I} \, \overline{M} = \overline{M}.
	\end{equation*}
	Thus, we may only concern ourselves with the case of finite grade. The second equality follows since any regular sequence can be extended to a maximal one, whose length is the grade (and that $\mathbf{y}$ is regular on $M/\mathbf{x}$ iff $\mathbf{x}, \mathbf{y}$ is regular on $M$). For the first equality, one notes that $\mathbf{y} \subset I$ is an $\overline{M}$-sequence iff $\overline{\mathbf{y}} \subset \overline{I}$ is so.

	(e): The hypothesis tells us that $V(\ann_{R}(N)) = V(I)$. By (a), we may assume that $I = \ann_{R}(N)$. Now, note that in the proof of \Cref{thm:grade-ext}, we only used that $\ann_{R}(R/I) = I$. 
\end{proof}

\begin{rem}
	The name `grade' was originally used by Rees for a different invariant: given a noetherian ring $R$, and $M$ a finite $R$-module, the \deff{grade of $M$} is given by
	\begin{equation*} 
		\grade(M) \vcentcolon= \inf \Ext_{R}^{i}(M, R).
	\end{equation*}
	(Thus, grade of the zero module is $\infty$.)

	Now, by \Cref{prop:grade-properties} (e), we know that $\inf \Ext_{R}^{i}(M, R) = \grade(\ann_{R}(M), R)$. Thus, $\grade(M) = \grade(\ann_{R}(M), R)$. 

	It is customary to set
	\begin{equation*} 
		\grade(I) \vcentcolon= \grade(R/I) = \grade(I, R),
	\end{equation*}
	for an ideal $I \subset R$. ($\grade(I)$ now has two meanings, but we shall never use it to denote the grade of $I$ as an $R$-module.)

	Note that if $I \neq R$, then $\grade(I)$ is the length of the longest ($R$-)regular sequence in $I$.
\end{rem}

\subsubsection{Depth and dimension} 

Let $(R, \mathfrak{m})$ be noetherian local and $M \neq 0$ a finite $R$-module. By \Cref{thm:nonzerodivisor-dimension-one-drop}, we see that if $\mathbf{x}$ is an $M$-sequence (necessarily contained in $\mathfrak{m}$), then $\dim(M/\mathbf{x} M) = \dim(M) - n$. Since a regular sequence cuts down the dimension by the correct amount, we get the following.

\begin{prop} \label{prop:depth-le-dim}
	Let $(R, \mathfrak{m})$ be a noetherian local ring and $M \neq 0$ a finite $R$-module. Then every $M$-sequence is a part of a system of parameters of $M$. In particular, $\depth M \le \dim M$.
\end{prop}

In fact, something stronger can be proven.

\begin{prop}
	With the same notation as above, one has $\depth M \le \dim R/\mathfrak{p}$ for all $\mathfrak{p} \in \Ass M$.
\end{prop}
\begin{proof} 
	We induct on $\depth M$. The base case $\depth M = 0$ is trivial. \newline
	If $\depth M > 0$, there exists $x \in \mathfrak{m}$ which is $M$-regular. By \Cref{prop:grade-properties}, we have $\depth(M/xM) = \depth(M) - 1$ and thus, we may apply the inductive hypothesis.

	Now, let $\mathfrak{p} \in \Ass M$ be arbitrary. We wish to show that $\depth M \le \dim(R/\mathfrak{p})$. Choose $z \in M$ such that $Rz$ is maximal among the cyclic submodules of $M$ annihilated by $\mathfrak{p}$.

	\claim{} $\mathfrak{p}$ consists of zerodivisors of $M/xM$.
	\begin{proof} 
		Note that $\mathfrak{p}$ kills $\overline{z} \in M/xM$. We just need to show that $\overline{z} \neq 0 \in M/xM$, i.e., $z \notin xM$. \newline
		To the contrary, assume that $z = xm$ for some $m \in M$. Then,
		\begin{equation*} 
			\mathfrak{p} z = x(\mathfrak{p} m) = 0
		\end{equation*}
		implies that $\mathfrak{p} m = 0$ since $x$ is $M$-regular.

		But then, $\mathfrak{p}$ annihilates $Rm \supsetneq Rz$, a contradiction.
	\end{proof}

	Thus, $\mathfrak{p} \subset \mathfrak{q}$ for some $\mathfrak{q} \in \Ass(M/xM)$. 

	Note that $x \notin \mathfrak{p}$ since $\mathfrak{p}$ is associated to $M$ whereas $x$ is regular on $M$. Consequently, $(M/xM)_{\mathfrak{p}} = 0$. Thus, $\mathfrak{p} \neq \mathfrak{q}$ since the latter is actually in the support of $M/xM$. 

	Thus, we get
	\begin{equation*} 
		\dim(R/\mathfrak{p}) - 1 \ge \dim(R/\mathfrak{q}) \ge \depth(M/xM) = \depth(M) - 1,
	\end{equation*}
	as desired.
\end{proof}

The global analogue of the above says the following.

\begin{prop}
	Let $R$ be a noetherian ring, and $I \subset R$ an ideal. Then, $\grade I \le \htt I$.
\end{prop}
\begin{proof} 
	We have $\grade(I) = \inf\{\depth R_{\mathfrak{p}} : \mathfrak{p} \in V(I)\}$ by \Cref{prop:grade-properties}, and $\htt(I) \vcentcolon= \inf\{\dim R_{\mathfrak{p}} : \mathfrak{p} \in V(I)\}$ by definition. The assertion now follows from \Cref{prop:depth-le-dim}.
\end{proof}

\subsubsection{Depth, type, and flat extensions}

\begin{defn}
	Let $(R, \mathfrak{m}, k)$ be a noetherian local ring, and $M \neq 0$ a finite $R$-module of depth $t$. The number
	\begin{equation*} 
		\type(M) \vcentcolon= \dim_{k} \Ext_{R}^{t}(k, M)
	\end{equation*}
	is called the \deff{type of $M$}.
\end{defn}

\begin{prop} \label{prop:local-algebra-depth-type-tensor}
	Let $\varphi : (R, \mathfrak{m}, k) \to (S, \mathfrak{n}, \ell)$ be a homomorphism of noetherian local rings. Suppose $M$ is a finite $R$-module, and $N$ is a finite $S$-module which is flat over $R$; both nonzero. Then,
	\begin{enumerate}[label=(\alph*)]
		\item $\depth_{S}(M \otimes_{R} N) = \depth_{R}(M) + \depth_{S}(N/\mathfrak{m} N)$,
		\item $\type_{R}(M \otimes_{R} N) = \type_{R}(M) \cdot \type_{S}(N/\mathfrak{m} N)$.
	\end{enumerate}
\end{prop}
Note: the hypothesis above ensures $M \otimes_{R} N \neq 0$. Recall that $\varphi$ being a local map means $\varphi(\mathfrak{m}) \subset \mathfrak{n}$ (equivalently, $\varphi^{-1}(\mathfrak{n}) = \mathfrak{m}$). 
\begin{lem} 
	Under the same setup as above, the following hold:
	\begin{enumerate}[label=(\alph*)]
		\item $\dim_{\ell} \Hom_{S}(\ell, M \otimes_{R} N) = \dim_{k} \Hom_{R}(k, M) \cdot \dim_{\ell} \Hom_{S}(\ell, N/\mathfrak{m} N)$,
		\item if $\mathbf{y}$ is an $(N/\mathfrak{m} N)$-sequence in $S$, then $\mathbf{y}$ is an $(M \otimes_{R} N)$-sequence, and $N/\mathbf{y} N$ is flat over $R$.
	\end{enumerate}
\end{lem}
\begin{proof} 
	Set $T \vcentcolon= S/\mathfrak{m} S = k \otimes_{R} S$. There is a natural isomorphism
	\begin{equation} \label{eq:009}
		\Hom_{S}(\ell, M \otimes_{R} N) \cong \Hom_{S}(\ell, \Hom_{S}(T, M \otimes_{R} N)),
	\end{equation}
	since both sides can be identified with the submodule of $M \otimes_{R} N$ consisting of elements annihilated by $\mathfrak{n}$. 

	As $N$ is flat over $R$, we have
	\[\begin{WithArrows}[displaystyle]
		\Hom_{S}(T, M \otimes_{R} N) &= \Hom_{S}(k \otimes_{R} S, M \otimes_{R} N) \\
		&\cong \Hom_{R}(k, M \otimes_{R} N) \Arrow{$N$ flat, $k$ finite} \\
		&\cong \Hom_{R}(k, M) \otimes_{R} N.
	\end{WithArrows}\]

	Now, $\Hom_{R}(k, M) \cong k^{s}$ for some finite $s \ge 0$, and so $\Hom_{R}(k, M) \otimes_{R} N \cong (N/\mathfrak{m} N)^{s}$. Combined with \Cref{eq:009}, this proves (a).

	One has a natural isomorphism $(M \otimes_{R} N)/J(M \otimes_{R} N) \cong M \otimes_{R} (N/JN)$ for an arbitrary ideal $J \subset S$.\footnote{Both modules are isomorphic to $M \otimes_{R} N \otimes_{S} (S/J)$.}	Thus, it suffices it suffices to consider the case that $\mathbf{y} = y$ is a single element in $S$.

	For the sake of contradiction, assume that $y$ is a zerodivisor on $M \otimes_{R} N$. Then, there exists nonzero $z \in M \otimes_{R} N$ such that $yz = 0$. By \mynameref{thm:KIT}, there exists $i \ge 0$ such that $z \in \mathfrak{m}^{i} (M \otimes_{R} N) \setminus \mathfrak{m}^{i + 1} (M \otimes_{R} N)$, but then $y$ would be a zerodivisor on 
	\begin{equation*} 
		\mathfrak{m}^{i} (M \otimes_{R} N) / \mathfrak{m}^{i + 1} (M \otimes_{R} N) \cong (\mathfrak{m}^{i} M/\mathfrak{m}^{m + 1}M) \otimes_{R} N \cong k^{t} \otimes_{R} N \cong (N/\mathfrak{m}N)^{t},
	\end{equation*}
	for some $t \ge 1$, contradicting the fact that $y$ is a zerodivisor on $N/\mathfrak{m} N$. (The first isomorphism above follows by flatness of $N$.)

	In order to test flatness for $N/yN$, it suffices to consider exact sequences
	\begin{equation*} 
		0 \to M_{1} \to M_{2} \to M_{3} \to 0
	\end{equation*}
	of finite $R$-modules. By flatness of $N$, the sequence
	\begin{equation*} 
		0 \to M_{1} \otimes_{R} N \to M_{2} \otimes_{R} N \to M_{3} \otimes_{R} N \to 0
	\end{equation*}
	is exact. By what we just showed, $y$ is a regular sequence on $M_{3} \otimes_{R} N$. By \Cref{prop:regular-sequence-tensor}, the sequence above is exact even after tensoring with $S/yS$. But the obtained sequence is precisely
	\begin{equation*} 
		0 \to M_{1} \otimes_{R} (N/y N) \to M_{2} \otimes_{R} (N/y N) \to M_{3} \otimes_{R} (N/y N) \to 0. \qedhere
	\end{equation*}
\end{proof}

\begin{proof}[Proof of \Cref{prop:local-algebra-depth-type-tensor}]
	Let $x_{1}, \ldots, x_{m}$ be a maximal $M$-sequence, and $y_{1}, \ldots, y_{n}$ a maximal $(N/\mathfrak{m} N)$-sequence. We will show that $\varphi(\mathbf{x}), \mathbf{y}$ is an $M \otimes_{R} N$-sequence. Moreover, showing $\Ext_{S}^{m + n}(\ell, M \otimes_{R} N) \neq 0$ will then prove (a).

	By \Cref{prop:regularity-flat-tensor}, we already know that $\varphi(\mathbf{x})$ is an $(M \otimes_{R} N)$-sequence. Now, by part (b) of the previous lemma, we get that $\mathbf{y}$ is an $(\overline{M} \otimes_{R} N)$-sequence, where $\overline{M} \vcentcolon= M/\mathbf{x} M$. Since
	\begin{equation*} 
		\overline{M} \otimes_{R} N \cong (M \otimes_{R} N)/\varphi(\mathbf{x})(M \otimes_{R} N),
	\end{equation*}
	this proves that $\varphi(\mathbf{x}), \mathbf{y}$ is an $M \otimes_{R} N$-sequence.

	Next, set $N' \vcentcolon= N/\mathbf{y} N$. We then see that going modulo the above regular sequence, we get
	\begin{equation*} 
		(M \otimes_{R} N)/(\varphi(\mathbf{x}), \mathbf{y})(M \otimes_{R} N) \cong \overline{M} \otimes_{R} N'.
	\end{equation*}
	Now, using \Cref{lem:Hom-Ext-regular-sequence}, we get
	\begin{align*} 
		\Hom_{R}(k, \overline{M}) \cong \Ext_{R}^{m}(k, M), \quad \Hom_{S}(\ell, N'/\mathfrak{m} N') \cong \Ext_{S}^{n}(\ell, N/\mathfrak{m} N), \\
		\Hom_{S}(\ell, \overline{M} \otimes_{R} N') \cong \Ext_{R}^{m + n}(\ell, M \otimes_{R} N).
	\end{align*}
	Now, by the previous lemma, we get that
	\begin{align*} 
		\dim_{\ell} \Ext_{R}^{m + n}(\ell, M \otimes_{R} N) &= \dim_{\ell} \Hom_{S}(\ell, \overline{M} \otimes_{R} N') \\
		&= \dim_{k} \Hom_{R}(k, \overline{M}) \cdot \dim_{\ell} \Hom_{S}(\ell, N') \\
		&= \type_{R}(M) \cdot \type_{S}(N).
	\end{align*}
	In particular, the above $\Ext_{R}^{m + n}$ is nonzero. Thus, the depth is the desired one and the above quantity is the desired type.
\end{proof}

\begin{defn}
	Let $M$ be a module over a local ring $(R, \mathfrak{m}, k)$. Then the \deff{socle of $M$} is defined as
	\begin{equation*} 
		\soc(M) \vcentcolon= (0 :_{M} \mathfrak{m}) = \Hom_{R}(k, M).
	\end{equation*}
\end{defn}
The socle is the largest $R$-submodule of $M$ which has the structure of a $k$-module. The proof above showed us the following intermediate calculation.

\begin{por}
	Let $(R, \mathfrak{m}, k)$ be a noetherian local ring, $M$ a finite $R$-module, and $\mathbf{x}$ a maximal $M$-sequence. Then, $\type(M) = \dim_{k} \soc(M/\mathbf{x} M)$.
\end{por}

\textbf{Exercises.}

\begin{exe}
	Let $k$ be a field and $R = k[\![X]\!][Y]$. Deduce that $X$, $Y$ and $1 - XY$ are maximal $R$-sequences. (This example shows that $IM \neq M$ in \Cref{thm:grade-ext} is relevant.)
\end{exe}
\begin{soln}
	It is clear that both sequences written are actually regular. Moreover, the ideal generated is maximal in either case. Thus, these sequences cannot be extended.
\end{soln}

??

\subsection{Depth and projective dimension}

Let $R$ be a ring, $M$ an $R$-module; $M$ has a(n augmented) projective resolution
\begin{equation*} 
	\cdots \to P_{n} \xrightarrow{\varphi_{n}} P_{n - 1} \to \cdots \to P_{1} \xrightarrow{\varphi_{1}} P_{0} \xrightarrow{\varphi_{0}} M \to 0.
\end{equation*}

Set $M_{0} \vcentcolon= M$ and $M_{i} \vcentcolon= \ker(\varphi_{i - 1})$ for $i \ge 1$. The modules $M_{i}$ are determined up to projective equivalence.\footnote{Modules $M$ and $N$ are said to be \deff{projectively equivalent} if there exist projectives $P$ and $Q$ with $A \oplus P \cong B \oplus Q$.} $M_{i}$ is called the \deff{$i$-th syzygy} of $M$. Since being projective is preserved by projective equivalence, the following definition makes sense.

\begin{defn}
	The \deff{projective dimension of $M$}, abbreviated $\projdim M$, is infinity if no syzygy of $M$ is projective; otherwise, it is the least integer $n$ for which the $n$-th syzygy is projective.
\end{defn}

If $n \vcentcolon= \projdim M$, then replacing $P_{n}$ by $M_{n}$, we get a finite projective resolution as follows:
\begin{equation*} 
	0 \to M_{n} \to P_{n - 1} \to \cdots \to P_{0} \to M \to 0.
\end{equation*}

Thus, one could equivalently define $\projdim M$ as the infimum of the lengths of all of its projective resolutions.

Now, if $(R, \mathfrak{m}, k)$ is a noetherian local ring, and $M$ a finitely generated $R$-module, then the quantity
\begin{equation*} 
	\mu(M) \vcentcolon= \dim_{k}(M/\mathfrak{m} M)
\end{equation*}
is finite. This is the number of minimal generators of $M$. Set $\beta_{0} \vcentcolon= \mu(M)$. Let $x_{1}, \ldots, x_{\beta_{0}} \in M$ be a system of generators of $M$. Then, we get a surjection $\varphi_{0} : R^{\beta_{0}} \to M$ by mapping $e_{i} \mapsto x_{i}$. Repeating this procedure with $\ker(\varphi_{0})$ and so on, we get a resolution as
\begin{equation*} 
	F_{\bullet} : \quad \cdots \to R^{\beta_{n}} \xrightarrow{\varphi_{n}} R^{\beta_{n - 1}} \to \cdots \to R^{\beta_{1}} \xrightarrow{\varphi_{1}} R^{\beta_{0}} \to M \to 0.
\end{equation*}

\begin{exe}
	$F_{\bullet}$ is determined up to isomorphism of complexes.
\end{exe}
\begin{soln}
	Suppose that $G_{\bullet}$ is another resolution built in the same way. Note that necessarily, $G_{0} \cong R^{\beta_{0}}$. \newline
	Let $x_{1}, \ldots, x_{\beta_{0}}$ be as before, and let $y_{1}, \ldots, y_{\beta_{0}}$ be a minimal generating set corresponding to $G_{0}$. Then, there exists an $n \times n$ matrix $A \in M_{n}(R)$ relating $\mathbf{x}$ and $\mathbf{y}$. Moreover, going modulo $\mathfrak{m}$ shows that $\overline{A}$ is related two bases of $k^{n}$. Thus, $\det(\overline{A}) \neq 0$ in $k$. Consequently, $\det(A)$ is a unit in $R$. This gives us an invertible map making the following diagram commute
	\begin{equation*} 
		\begin{tikzcd}
			F_{0} \arrow[r, "\varphi_{0}"] \arrow[d, "\cong", "\eta_{0}"'] & M \arrow[d, equals] \arrow[r] & 0 \\
			G_{0} \arrow[r, "\psi_{0}"] & M \arrow[r] & 0.
		\end{tikzcd}
	\end{equation*}
	Now, a diagram chase shows that we have an induced map as shown
	\begin{equation*} 
		\begin{tikzcd}
			\ker(\varphi_{0}) \arrow[d, dotted] \arrow[r] & F_{0} \arrow[r, "\varphi_{0}"] \arrow[d, "\eta_{0}"] & M \arrow[d, equals] \arrow[r] & 0 \\
			\ker(\psi_{0}) \arrow[r] & G_{0} \arrow[r, "\psi_{0}"] & M \arrow[r] & 0.
		\end{tikzcd}
	\end{equation*}
	The map above is just the restriction of $\eta_{0}$. By symmetry, $\eta_{0}^{-1}$ also restricts to a map in the other direction. Since the compositions are identity, we see that the kernels are isomorphic.

	Now, $F_{1}$ and $G_{1}$ were constructed by mapping onto these kernels. The same argument as before shows that a dotted arrow below exists, making the diagram commute:

	\begin{equation*} 
		\begin{tikzcd}
			F_{1} \arrow[d, "\eta_{1}", dotted] \arrow[r] & \ker(\varphi_{0}) \arrow[d, "\eta_{0}|_{\ker}"] \arrow[r] & 0 \\
			G_{1} \arrow[r] & \ker(\psi_{0}) \arrow[r] & 0.
		\end{tikzcd}
	\end{equation*}

	Induction finishes the job.
\end{soln}

\begin{defn}
	The resolution built in the above way is called the \deff{minimal free resolution of $M$} (and is well-defined up to isomorphism of $R$-complexes). The number $\beta_{i}$ as above is called the \deff{$i$-th Betti number} of $M$, denoted $\beta_{i}(M)$.
\end{defn}
Note that projectives are free over a local ring.

\begin{prop} \label{prop:free-resolution-minimal-equivalence}
	Let $(R, \mathfrak{m}, k)$ be a local ring, $M$ a finite $R$-module, and
	\begin{equation*} 
		F_{\bullet} : \quad \cdots \to F_{n} \xrightarrow{\varphi_{n}} F_{n - 1} \to \cdots \to F_{1} \xrightarrow{\varphi_{1}} F_{0} \to 0
	\end{equation*}
	a free resolution of $M$. Then the following are equivalent:
	\begin{enumerate}[label=(\alph*)]
		\item $F_{\bullet}$ is minimal,
		\item $\varphi_{i}(F_{i}) \subset \mathfrak{m} F_{i - 1}$ for all $i \ge 1$,
		\item $\rank F_{i} = \dim_{k} \Tor^{R}_{i}(M, k)$ for all $i \ge 0$,
		\item $\rank F_{i} = \dim_{k} \Ext_{R}^{i}(M, k)$ for all $i \ge 0$.
	\end{enumerate}
\end{prop}
\begin{proof} 
	(a) $\Leftrightarrow$ (b) follows at once from \Cref{prop:minimal-epimorphism}, using our definition (/construction) of the minimal free resolution.

	Note that the above free resolution comes with a surjection $F_{0} \xrightarrow{\varphi_{0}} M$ such that the augmented complex is exact. 

	By definition, we have $\Tor^{R}_{i}(M, k) \cong H_{i}(F_{\bullet} \otimes_{R} k)$. \newline
	
	(b) $\Rightarrow$ (c), (d):  By the assumption of (b), we see that
	\begin{equation*} 
		F_{\bullet} : \quad \cdots \to F_{n}/\mathfrak{m} F_{n} \xrightarrow{0} F_{n - 1}/\mathfrak{m} F_{n - 1} \to \cdots \to F_{1}/\mathfrak{m} F_{1} \xrightarrow{0} F_{0}/\mathfrak{m} F_{0} \to 0.
	\end{equation*}
	Thus, the $i$-th homology is simply $F_{i}/\mathfrak{m} F_{i}$. Its rank as a $k$-vector space is precisely the same as $\rank F_{i}$. This proves (c). (d) follows in the same way.

	(c) $\Rightarrow$ (b): After tensoring with $k$, we note that we have
	\begin{equation*} 
		\cdots \xrightarrow{\overline{\varphi_{i + 1}}} \overline{F_{i}} \xrightarrow{\overline{\varphi_{i}}} \cdots,
	\end{equation*}
	where $\overline{\cdot}$ denotes going mod $\mathfrak{m}$. 

	Note that 
	\begin{equation*} 
		\dim_{k} \Tor^{R}_{i}(M, k) = \dim_{k}(\ker(\overline{\varphi_{i}})/\im(\overline{\varphi_{i + 1}})) \le \dim_{k}(\overline{F_{i}}) = \rank F_{i}.
	\end{equation*}
	Thus, for equality to hold, we must have $\ker(\overline{\varphi_{i}}) = \overline{F_{i}}$ and $\im(\overline{\varphi_{i + 1}}) = 0$. Thus, $\overline{\varphi_{i}} = 0$ for all $i$, giving us (b).

	(d) $\Rightarrow$ (b): Follows the same way as above. Note that $\Hom_{R}(F_{i}, k) \cong k^{\rank F_{i}}$, as $R$-modules (and $k$-modules).
\end{proof}

\begin{cor} \label{cor:projdim-Tor-local}
	Let $(R, \mathfrak{m}, k)$ be a noetherian local ring, and $M$ a finite $R$-module. Then, $\beta_{i}(M) = \Tor^{R}_{i}(M, k)$ for all $i$ and
	\begin{equation*} 
		\projdim M = \sup \Tor^{R}_{\ast}(M, k).
	\end{equation*}
\end{cor}

\begin{cor} \label{cor:projdim-mod-regular-sequence}
	Let $(R, \mathfrak{m})$ be a noetherian local ring, and $M$ a finite $R$-module. If $x \in \mathfrak{m}$ is $M$-regular and $R$-regular, then
	\begin{equation*} 
		\projdim_{R} M = \projdim_{R/(x)} M/x M.
	\end{equation*}
\end{cor}
\begin{proof} 
	Let $F_{\bullet} \to M$ be a minimal free resolution. Note that $x$ is regular on each $F_{i}$. By \Cref{prop:regular-sequence-tensor-strong}, it follows that we still have a resolution after going mod $(x)$. This continues to be minimal by \Cref{prop:free-resolution-minimal-equivalence}. Using that again with \Cref{cor:projdim-Tor-local}, we get the result.
\end{proof}

\begin{lem} \label{lem:injective-associated-tensor}
	Let $(R, \mathfrak{m}, k)$ be a local ring, and $\varphi : F \to G$ a homomorphism of finite $R$-modules. Suppose that $F$ is free, and let $M$ be an $R$-module with $\mathfrak{m} \in \Ass M$. Suppose that $\varphi \otimes_{R} M$ is injective. Then,
	\begin{enumerate}[label=(\alph*)]
		\item $\varphi \otimes_{R} k$ is injective,
		\item if $G$ is a free $R$-module, then $\varphi$ is injective, and $\varphi(F)$ is a direct summand of $G$.
	\end{enumerate}
\end{lem}
\begin{proof} \phantom{h}
	\begin{enumerate}[label=(\alph*)]
		\item Since $\mathfrak{m} \in \Ass M$, there exists an embedding $\iota : k \into M$. $F$ being free implies that $F \otimes_{R} \iota$ is also injective. We have a commutative diagram as
		\begin{equation*} 
			\begin{tikzcd}
				F \otimes_{R} k \arrow[d, "\varphi \otimes k"'] \arrow[r, "F \otimes \iota", hook] & F \otimes_{R} M \arrow[d, "\varphi \otimes M", hook] \\
				G \otimes_{R} k \arrow[r, "G \otimes \iota"'] & G \otimes_{R} M,
			\end{tikzcd}
		\end{equation*}
		proving that the left map is an injection.
		%
		\item We are given that $\varphi : R^{n} \to R^{m}$ is a map such that $\overline{\varphi} : k^{n} \to k^{m}$ is an injection. \newline
		We wish to show that $\varphi$ is an injection and splits. 

		Let $e_{1}, \ldots, e_{n}$ be the standard basis of $R^{n}$, and put $x_{i} \vcentcolon= \varphi(e_{i})$ for $i \in [n]$. Then, we are given that $\overline{x_{1}}, \ldots, \overline{x_{n}}$ are $k$-linearly independent. Thus, we may extend it to a $k$-basis $\overline{x_{1}}, \ldots, \overline{x_{m}}$ of $k^{m}$. Then, $x_{1}, \ldots, x_{m}$ is an $R$-basis for $R^{m}$. One can now define an inverse to $\varphi$ in the obvious way. \qedhere
	\end{enumerate}
\end{proof}

\begin{thm}[Auslander-Buchsbaum] \label{thm:auslander-buchsbaum}
	Let $(R, \mathfrak{m})$ be a noetherian local ring, and $M \neq 0$ a finite $R$-module. If $\projdim M < \infty$, then
	\begin{equation*} 
		\projdim M + \depth M = \depth R.
	\end{equation*}
\end{thm}
\begin{proof} 
	We proceed by induction on $\depth R$.

	First, let $\depth R = 0$. We wish to show $\projdim M = \depth M = 0$. Suppose $n \vcentcolon= \projdim M > 0$. Then, $M$ has a minimal free resolution
	\begin{equation*} 
		0 \to F_{n} \xrightarrow{\varphi_{n}} F_{n - 1} \to \cdots \to F_{0} \xrightarrow{\varphi_{0}} \to M \to 0.
	\end{equation*}
	Now, $\depth R = 0$ tells us that $\mathfrak{m}$ consists of zero divisors, i.e., $\mathfrak{m} \in \Ass R$. Applying \Cref{lem:injective-associated-tensor} to $M = R$, we see that $\varphi_{n}$ maps $F_{n}$ isomorphically onto a free summand of $F_{n - 1}$, contradicting minimality of the above resolution. \newline
	Thus, $n = 0$, proving that $M$ is projective and hence free. Consequently, $\depth M = \depth R = 0$.

	Now, assume $\depth R > 0$. Suppose first that $\depth M = 0$. Let $M_{1}$ be the first syzygy of $M$. Note that $M_{1} \neq 0$ since $M$ is not free (since $\depth M \neq \depth R$). Now, by \Cref{rem:grade-equalities-exact-sequences}, we see that $\depth M' = 1$. Since $\projdim M' = \projdim M - 1$, it is enough to prove the result for $M'$. Thus, we may assume $\depth M > 0$. \newline
	Now, this means that $\mathfrak{m} \notin \Ass M$ and $\mathfrak{m} \in \Ass R$. By prime avoidance, we may pick $x \in \mathfrak{m}$ which is both $\mathfrak{m}$-regular and $R$-regular.

	Using \Cref{prop:grade-properties} and \Cref{cor:projdim-mod-regular-sequence}, induction now finishes the job.
\end{proof}

\textbf{Exercises.}

\begin{ex}
	Let $R$ be a noetherian local ring, $M$ a finite $R$-module, and $\mathbf{x}$ a $M$-sequence of length $n$. Show $\projdim_{R}(M/\mathbf{x} M) = \projdim_{R}(M) + n$.
\end{ex}
\begin{proof} 
	Note that $\depth(M/\mathbf{x} M) = \depth(M) - n$ by \Cref{prop:grade-properties}. Thus, \mynameref{thm:auslander-buchsbaum} gives the result if both $M$ and $M/\mathbf{x} M$ have finite projective dimensions.

	??
\end{proof}

\begin{ex}
	Let $R$ be a noetherian local ring, and $N$ an $n$-th syzygy of a finite $R$-module in a finite free resolution. Prove that $\depth N \ge \min(n, \depth R)$.
\end{ex}
\begin{proof} 
	Let $F_{\bullet} \to M \to 0$ be the finite free resolution mentioned. Let $M_{n}$ denote the $n$-th syzygy (with $M_{0} = M$). We prove by induction on $n$, that $\depth M_{n} \ge \min(n, \depth R)$. The statement is clear for $n = 0$. 

	We have the exact sequence
	\begin{equation*} 
		0 \to M_{n} \to F_{n - 1} \to M_{n - 1} \to 0.
	\end{equation*}
	Note that $\depth(F_{n - 1}) = \depth(R)$ since $F_{n - 1}$ is a (nonzero) finite free module (\Cref{cor:depth-direct-sum}).\footnotetext{If $F_{n - 1} = 0$, then $\depth = \infty$ and there is nothing to prove.} Now, by \Cref{prop:grade-exact-sequence}, we see that
	\begin{equation*} 
		\depth M_{n} \ge \min(\depth(F_{n - 1}), \depth(M_{n - 1}) + 1) = \min(\depth(R), n). \qedhere
	\end{equation*}
\end{proof}

\subsection{Some linear algebra}

\subsubsection{Torsionfree and reflexive modules}

Recall that $\mathcal{Z}(R)$ is the set of zerodivisors of $R$.
\begin{defn}
	Let $R$ be a ring, $M$ an $R$-module. An element $x \in M$ is said to be \deff{torsion} if there exists $r \in R \setminus \mathcal{Z}(R)$ such that $r x = 0$. \newline
	$M$ is said to be \deff{torsionfree} if $M$ has no nonzero torsion elements. \newline
	$M$ is said to be \deff{torsion} if every element of $M$ is torsion.
\end{defn}
The zero module is both torsion and torsionfree.

Recall that the \deff{total ring of fractions} of a ring $R$, is the ring $W^{-1} R$, where $W$ consists of nonzerodivisors of $R$.
\begin{prop}
	Let $R$ be a ring, $Q$ its total ring of fractions, and $M$ an $R$-module.
	\begin{enumerate}[label=(\alph*)]
		\item $M$ is torsionfree iff the natural map $M \to M \otimes_{R} Q$ is injective.
		\item $M$ is torsion iff $M \otimes_{R} Q = 0$.
	\end{enumerate}
\end{prop}
\begin{proof} 
	Let $W$ denote the set of nonzerodivisors of $R$. Note that $M \otimes_{R} Q = W^{-1} M$ and the map $M \to M \otimes_{R} Q$ is simply $m \mapsto \frac{m}{1}$. 

	This map is injective iff no nonzero element of $M$ is killed by an element of $W$. (a) follows.

	Similarly, $W^{-1} M = 0$ iff every element of $M$ is killed by an element of $W$. (b) follows.
\end{proof}

\begin{defn}
	Let $R$ be a ring, $M$ a module. 

	The \deff{dual} of $M$ is the module $\Hom_{R}(M, R)$, denoted $M^{\ast}$; the \deff{bidual} is $M^{\ast \ast}$. \newline
	The bilinear map $M \times M^{\ast} \to R$ given by $(x, \varphi) \mapsto \varphi(x)$ induces a natural (evaluation) map $h : M \to M^{\ast \ast}$. 

	$M$ is \deff{torsionless} if $h$ is injective; $M$ is \deff{reflexive} if $h$ is an isomorphism.
\end{defn}
Note that $(-)^{\ast}$ is in fact a functor, with the obvious definition for homomorphisms.

Some implications between the above terms are discussed in \Cref{exe:noetherian-torsion-reflexive-implications}.

Note that if $R$ is noetherian, $M$ a finite $R$-module, $\mathfrak{p} \in \Spec R$, then
\begin{equation*} 
	\Hom_{R}(M, R)_{\mathfrak{p}} \cong \Hom_{R_{\mathfrak{p}}}(M_{\mathfrak{p}}, R_{\mathfrak{p}}).
\end{equation*}
Thus, $(M^{\ast})_{\mathfrak{p}} \cong (M_{\mathfrak{p}})^{\ast}$, where the latter dual is considered with respect to $R_{\mathfrak{p}}$. 

Similarly, $(M^{\ast \ast})_{\mathfrak{p}} \cong (M_{\mathfrak{p}})^{\ast \ast}$. Now, as $R_{\mathfrak{p}}$-modules, we have a map
\begin{equation*} 
	M_{\mathfrak{p}} \to M_{\mathfrak{p}}^{\ast \ast}.
\end{equation*}
We claim that the above is just the localisation of
\begin{equation*} 
	h : M \to M_{\mathfrak{p}},
\end{equation*}
under the identification mentioned earlier.

\begin{obs} \label{obs:depth-and-ass}
	Let $(R, \mathfrak{m})$ be a local ring, $M$ a finite $R$-module. 

	Note that $\depth M = 0$ iff $\mathfrak{m}$ consists of zerodivisors on $M$ iff $\mathfrak{m} \in \Ass M$. 

	Thus,
	\begin{equation*} 
		\depth M = 0 \Leftrightarrow \mathfrak{m} \in \Ass M; \qquad \depth M \ge 1 \Leftrightarrow \mathfrak{m} \notin \Ass M.
	\end{equation*}

	Now, let $R$ be an arbitrary noetherian ring, and $M$ a finite $R$-module. Since localisation behaves well with associated primes, we see that given any $\mathfrak{p} \in \Spec R$, we have
	\begin{equation*} 
		\depth_{R_{\mathfrak{p}}} M_{\mathfrak{p}} = 0 \Leftrightarrow \mathfrak{p} \in \Ass M; \qquad \depth_{R_{\mathfrak{p}}} M_{\mathfrak{p}} \ge 1 \Leftrightarrow \mathfrak{p} \notin \Ass M.
	\end{equation*}
	(We have used that $\mathfrak{p} \in \Ass M \Leftrightarrow \mathfrak{p} R_{\mathfrak{p}} \in \Ass M_{\mathfrak{p}}$.)
\end{obs}

\begin{prop}
	Let $R$ be a noetherian ring, and $M$ a finite $R$-module. Then:
	\begin{enumerate}[label=(\alph*)]
		\item $M$ is torsionless if and only if
		\begin{enumerate}[label=(\roman*)]
			\item $M_{\mathfrak{p}}$ is torsionless for all $\mathfrak{p} \in \Ass R$, and
			\item $\depth M_{\mathfrak{p}} \ge 1$ for $\mathfrak{p} \in \Spec R$ with $\depth R_{\mathfrak{p}} \ge 1$.
		\end{enumerate}
		\item $M$ is reflexive if and only if
		\begin{enumerate}[label=(\roman*)]
			\item $M_{\mathfrak{p}}$ is reflexive for all $\mathfrak{p}$ with $\depth R_{\mathfrak{p}} \le 1$, and
			\item $\depth M_{\mathfrak{p}} \ge 2$ for $\mathfrak{p} \in \Spec R$ with $\depth R_{\mathfrak{p}} \ge 2$.
		\end{enumerate}
	\end{enumerate}
\end{prop}
In points (i) and (ii), $M_{\mathfrak{p}}$ and $R_{\mathfrak{p}}$ are being considered are $R_{\mathfrak{p}}$-modules.

\begin{proof} 
	Let $h : M \to M^{\ast \ast}$ be the evaluation map. Put $K \vcentcolon= \ker(h)$, and $C \vcentcolon= \coker(h)$. Note that $M$ ($M_{\mathfrak{p}}$) it torsionless iff $K$ ($K_{\mathfrak{p}}$) is zero; furthermore, reflexive iff $C$ ($C_{\mathfrak{p}}$) is zero. As noticed, $h$ behaves well with localisation. This proves that points (i) in (a) and (b) are necessary. 

	By \Cref{exe:grade-Hom-min-2-grade}, we 
	\begin{equation} \label{eq:010}
		\depth M_{\mathfrak{p}}^{\ast \ast} \ge \min(2, \depth R_{\mathfrak{p}}).
	\end{equation}
	This proves necessity of (b) (ii). Next, if $M$ is torsionless, then $M_{\mathfrak{p}}$ is a submodule of $M_{\mathfrak{p}}^{\ast \ast}$. \Cref{prop:grade-exact-sequence} then tells us that
	\begin{equation*} 
		\depth(M_{\mathfrak{p}}) \ge \min(\depth(M_{\mathfrak{p}}^{\ast \ast}), 1).
	\end{equation*}
	Combined with \Cref{eq:010}, this proves the necessity of (a) (ii).

	We now need to prove the sufficiency directions of (a) and (b). We will make use of \Cref{obs:depth-and-ass} repeatedly.

	(a): It suffices to prove that $\Ass K = \emptyset$. Let $\mathfrak{p} \in \Spec R$. If $\depth R_{\mathfrak{p}} = 0$, then $\mathfrak{p} \in \Ass R$. For such $\mathfrak{p}$, (a) (i) tells us that $K_{\mathfrak{p}} = 0$ and thus, $\mathfrak{p} \notin \Ass K$. \newline
	Now, if $\depth(R_{\mathfrak{p}}) \ge 1$, then $\depth(M_{\mathfrak{p}}) \ge 1$, proving that $\mathfrak{p} \notin \Ass(M) \supset \Ass(K)$.

	(b): Suppose b (i) and (ii) hold. Check that this implies that (a) is true, i.e, $K = 0$. Thus, we have a short exact sequence
	\begin{equation*} 
		0 \to M \to M^{\ast \ast} \to C \to 0.
	\end{equation*} 
	As before, we show that $\Ass C = \emptyset$. \newline
	Let $\mathfrak{p} \in \Spec R$. If $\depth R_{\mathfrak{p}} \le 1$, then we are done by (i). If $\depth R_{\mathfrak{p}} \ge 2$, then $\depth M_{\mathfrak{p}} \ge 2$. By \Cref{eq:010}, $\depth M_{\mathfrak{p}}^{\ast \ast} \ge 2$ as well. By \Cref{prop:grade-exact-sequence}, we get $\depth(C_{\mathfrak{p}}) \ge 1$. Thus, $\mathfrak{p} \notin \Ass C$.
\end{proof}

\subsubsection{Rank}

\begin{defn}
	Let $R$ be a ring, $Q$ its total ring of fractions, and $M$ an $R$-module. We say $M$ \deff{has a rank} if $M \otimes_{R} Q$ is a free $Q$-module. In this case, we define the \deff{rank} of $M$ to be $\rank_{Q}(M \otimes_{R} Q)$.

	If $\varphi : M \to N$ is a homomorphism of $R$-modules, then $\varphi$ has \deff{rank} $r$ if $\im(\varphi)$ has rank $r$.
\end{defn}
We shall often just say ``$M$ has rank $r$'' to mean that $M$ has a rank, and that this rank is $r$. Note that not all modules have a rank. On the other hand, any free module has a rank, which coincides with its usual notion of a rank. At the same time, there are non-free modules which have a rank in the above sense. For example, the $\mathbb{Z}$-module $\mathbb{Z}/(2)$ has rank $0$.

Recall that a ring $R$ is said to be \deff{semilocal} if $R$ has finitely many maximal ideals. (The zero ring is also a semilocal ring.)

\begin{lem} \label{lem:semilocal-localisations-free}
	Let $R$ be a semilocal ring, $M$ a finite projective $R$-module. Then, $M$ is free of rank $r$ iff the localisations $M_{\mathfrak{m}}$ (are free) have the same rank $r$ for all maximal ideals $\mathfrak{m}$ of $R$.
\end{lem}
Note that $M$ is assumed to be projective to begin with, so the localisations $M_{\mathfrak{m}}$ are automatically free since projective modules over local rings are free.
\begin{proof} 
	Only the direction \backward is to be proven. We prove this by induction. If $r = 0$, then $M = 0$ and the result is true. 

	Now, assume $r > 0$. In particular $M \neq 0$ and thus, $M_{\mathfrak{m}} \not\subset \mathfrak{m} M_{\mathfrak{m}}$ for all the maximal ideals $\mathfrak{m}$. By \mynameref{prop:gen-prime-avoidance}, there exists $x \in M$ such that $x \notin \mathfrak{m} M_{\mathfrak{m}}$ for all $\mathfrak{m}$. Thus, $x$ is a part of a basis of $M_{\mathfrak{m}}$, for each $\mathfrak{m}$. In particular, $(M/Rx)_{\mathfrak{m}}$ is free of rank $r - 1$, for every $\mathfrak{m}$.  By \Cref{thm:projective-locally-free}, $M/Rx$ is again projective. \newline
	Thus, the inductive hypothesis now tells us that $M/Rx$ is free of rank $r - 1$. In particular, $M \onto M/Rx$ splits, giving us $M \cong (M/Rx) \oplus Rx$. It now suffices to prove that $Rx$ is free of rank $1$. 

	Note that the natural map $R \onto Rx$ is injective since it is injective after localisation at every maximal ideal. 
\end{proof}

\begin{prop} \label{prop:rank-equivalences}
	Let $R$ be a noetherian ring, $M$ an $R$-module with a finite free presentation $F_{1} \xrightarrow{\varphi} F_{0} \to M \to 0$. Then the following are equivalent:
	\begin{enumerate}[label=(\alph*)]
		\item $M$ has rank $r$;
		\item $M$ has a free submodule $N$ of rank $r$ such that $M/N$ is a torsion module;
		\item for all prime ideals $\mathfrak{p} \in \Ass R$ the $R_{\mathfrak{p}}$-module $M_{\mathfrak{p}}$ is free of rank $r$;
		\item $\rank \varphi = \rank F_{0} - r$.
	\end{enumerate}
\end{prop}
\begin{proof} 
	(a) $\Rightarrow$ (b): By clearing denominators, there is a $Q$-basis $\frac{x_{1}}{1}, \ldots, \frac{x_{r}}{1}$ of $M \otimes_{R} Q$, where $x_{i} \in M$. Put $N \vcentcolon= \sum R x_{i}$. We claim that $N$ has the desired properties. \newline 
	Note that $(M/N) \otimes_{R} Q = (M \otimes Q)/(N \otimes Q) = 0$ by construction. Thus, $M/N$ is indeed torsion. \newline
	We claim that $x_{1}, \ldots, x_{r}$ are $R$-linearly independent. Suppose 
	\begin{equation*} 
		a_{1} x_{1} + \cdots + a_{r} x_{r} = 0.
	\end{equation*}
	Viewing that as an equation in $M \otimes Q$, we get that $a_{i} = 0$ for all $i$. (Note that $a_{i} = 0$ in $Q$ implies $a_{i} = 0$ in $R$.)

	(b) $\Rightarrow$ (a): We have the short exact sequence
	\begin{equation*} 
		0 \to N \to M \to M/N \to 0.
	\end{equation*}
	Since $Q$ is a flat $R$-module, tensoring with $Q$ is exact. By hypothesis, the tensored sequence looks like
	\begin{equation*} 
		0 \to Q^{r} \to M \otimes_{R} Q \to 0 \to 0.
	\end{equation*}
	Thus, $M$ has rank $r$.

	(a) $\Rightarrow$ (c): Note that $\mathcal{Z}(R) = \bigcup_{\mathfrak{p} \in \Ass R} \mathfrak{p}$. Thus, if $\mathfrak{p} \in \Ass R$, then $M_{\mathfrak{p}}$ is just a further localisation of $M \otimes_{R} Q$.

	(c) $\Rightarrow$ (a): $Q$ is a semilocal ring with $\MaxSpec Q = \Max(\Ass R)$. By \Cref{thm:projective-locally-free}, we see that $M \otimes_{R} Q$ is $Q$-projective. Now, by \Cref{lem:semilocal-localisations-free}, this module is free of rank $r$.

	(c) $\Leftrightarrow$ (d): In view of (a) $\Leftrightarrow$ (c), we can replace (d) by the condition that $(\im \varphi)_{\mathfrak{p}}$ is free and $\rank(\im \varphi)_{\mathfrak{p}} = \rank F_{0} - r$ for all $\mathfrak{p} \in \Ass R$. We have the exact sequence
	\begin{equation*} 
		0 \to (\im \varphi)_{\mathfrak{p}} \to (F_{0})_{\mathfrak{p}} \to M_{\mathfrak{p}} \to 0.
	\end{equation*}
	If $M_{\mathfrak{p}}$ is free, then the sequence splits, showing that $(\im \varphi)_{\mathfrak{p}}$ is projective and hence, free. Since $\mathfrak{p} \in \Ass R$. Conversely, if $(\im \varphi)_{\mathfrak{p}}$ is free, then too the sequence splits since $\mathfrak{p} \in \Ass R$, by \Cref{lem:injective-associated-tensor}.
\end{proof}

\begin{prop} \label{prop:rank-two-out-of-three}
	Let $R$ be a noetherian ring, and $0 \to U \to M \to N \to 0$ an exact sequence of finite $R$-modules. If two of $U$, $M$, $N$ have a rank, then so does the third, and $\rank M = \rank U + \rank N$.
\end{prop}
\begin{proof} 
	In view of \Cref{prop:rank-equivalences} (and \Cref{obs:depth-and-ass}), we may assume $(R, \mathfrak{m})$ is local and $\depth R = 0$. 
	\begin{itemize}
		\item If $N$ is free then, $M \cong U \oplus N$. Now freeness of $M$ implies that of $U$ and conversely (since projectives are free over local rings).
		\item If $M$ and $U$ are free, then again $M \cong U \oplus N$ by \Cref{lem:injective-associated-tensor} ($\mathfrak{m} \in \Ass R$ since $\depth R = 0$). Again, $N$ is free.
	\end{itemize}
	The result now follows.
\end{proof}

\begin{cor}
	Let $R$ be a noetherian ring, $M$ an $R$-module with a finite free resolution 
	\begin{equation*} 
		F_{\bullet}: \quad 0 \to F_{s} \to F_{s - 1} \to \cdots \to F_{0}.
	\end{equation*}
	Then, $M$ has a rank and $\rank M = \sum_{j = 0}^{s} (-1)^{j} \rank F_{j}$.
\end{cor}
\begin{proof}
	Use the previous result and induction on $s$.
\end{proof}
Note that the hypothesis above assumes that $M$ has a finite length finite free resolution. This need not always be true. For example, consider $R = k[x]/(x^{2})$, with $k$ a field. This is a local artinian ring. In particular, every nonzerodivisor is already a unit. Thus, its total field of fraction is $R$ itself. However, not every finitely generated $R$-module is free. Indeed, $k = R/(x)$ is not. Consequently, $k$ has no rank and no finite length finite free resolution either.

\begin{cor}
	Let $R$ be a noetherian ring, and $I \neq 0$ an ideal such that $I$ has a finite free resolution. Then, $I$ contains an $R$-regular element.
\end{cor}
\begin{proof} 
	We have a short exact sequence $0 \to I \to R \to R/I \to 0$. By the previous result, $I$ has a rank. By \Cref{prop:rank-two-out-of-three}, so does $R/I$ and $\rank I + \rank R/I = 1$. Note that $I$ is torsionfree and nonzero; thus, $\rank I = 1$ and $\rank R/I = 0$. Thus, $R/I$ is torsion, i.e., annihilated by an $R$-regular element. This element is necessarily in $I$.
\end{proof}


\textbf{Exercises.}

\begin{exe}
	Let $R$ be a ring, and $M$ a finite torsionfree module. Prove that if $M$ has a rank, then $M$ is isomorphic to a submodule of a finite free $R$-module of the same rank.
\end{exe}
\begin{proof} 
	Let $W \vcentcolon= R \setminus \mathcal{Z}(R)$. Then, the total ring of fractions is $W^{-1}R =\vcentcolon Q$.

	Since $M$ is torsionfree, the map $\varphi : M \to W^{-1} M$ is injective. Since $M$ has a rank (say $r$), we know that $W^{-1} M \cong Q^{r}$. \newline
	By clearing denominators, we may assume that $\frac{x_{1}}{1}, \ldots, \frac{x_{r}}{1}$ is a $Q$-basis for $W^{-1} M$, with $x_{i} \in M$. 

	Then, it is clear that $F \vcentcolon= \sum R \frac{x_{i}}{1} \subset Q^{r}$ is a free $R$-module of rank $r$. We show that there exists $w \in W$ such that $\varphi(M) \subset \frac{1}{w} F$. Note that $\frac{1}{w} F$ is again a free $R$-module of rank $r$, which would prove the result.

	\claim{} For every $x \in M$, there exists $w \in W$ such that $\frac{x}{1} \in \frac{1}{w} F$.
	\begin{proof} 
		By hypothesis, we can write
		\begin{equation*} 
			\frac{x}{1} = \sum \frac{a_{i} x_{i}}{w_{i}}
		\end{equation*}
		with $a_{i} \in R$ and $w_{i} \in W$. By clearing denominators, the result follows.
	\end{proof}

	The desired result now follows from the claim using finite generation of $M$.
\end{proof}

\begin{exe} \label{exe:grade-Hom-min-2-grade}
	Let $R$ be a noetherian ring, $I$ an ideal, $M$, $N$ finite $R$-modules. Show that $\grade(I, \Hom_{R}(M, N)) \ge \min(2, \grade(I, N))$.
\end{exe}
\begin{soln}
	Put $L \vcentcolon= \Hom_{R}(M, N)$. This is a finite $R$-module.

	Edge cases: 
	\begin{enumerate}[label=(\alph*)]
		\item If $IL = L$, then there is nothing to prove.
		\item $IN = N$. In this case, there exists $i \in I$ such that $in = n$ for all $n \in N$. \newline
		Consequently, $i \varphi = \varphi$ for all $\varphi \in L$. We are back in case (a).
		\item If $\grade(I, N) = 0$, then there is nothing to prove.
	\end{enumerate}

	Thus, we may now assume $IN \neq N$ and $IL \neq L$. Thus, both the relevant grades are given in terms of lengths of regular sequences.

	\textbf{Case 1.} $\grade(I, N) = 1$. We wish to prove $\grade(I, L) \ge 1$. \newline
	By hypothesis, there exists $x \in I$ which is regular on $N$. Consequently, $x$ is regular on $L$. Thus, $\grade(I, L) \ge 1$.

	\textbf{Case 2.} $\grade(I, N) \ge 2$. We wish to prove $\grade(I, L) \ge 2$. \newline
	Let $x, y \in I$ be regular on $N$. We show that $x, y$ is an $L$-sequence. As noted earlier, $x$ is regular on $L$. Suppose $\varphi \in L$ is such that $y \varphi \in x L$. We wish to show that $\varphi \in x L$. \newline
	Writing $y \varphi = x \psi$, we see that
	\begin{equation*} 
		y \varphi(m) = x \psi(m)
	\end{equation*}
	for all $m \in M$. By hypothesis of regularity, $\varphi(m) \in x N$ for all $m \in M$. \newline
	Thus, there is some function $\eta : M \to N$ such that $\varphi(m) = x \eta(m)$ for all $m$. \newline
	In fact, there is a unique such $\eta$ since $x$ is $N$-regular. Using this, one gets that $\eta$ is actually $R$-linear, i.e., $\eta \in L$. \newline
	Thus, $\varphi = x \eta \in x L$, as desired.
\end{soln}

\begin{exe} \label{exe:noetherian-torsion-reflexive-implications}
	Let $R$ be a noetherian ring, and $M$ a finite $R$-module. Prove
	\begin{enumerate}[label=(\alph*)]
		\item if $M$ is torsionless, then it is torsionfree,
		\item $M$ is torsionless if and only if it is a submodule of a finite free module,
		\item if $M$ is reflexive, then it is a second syzygy, i.e., there is an exact sequence $0 \to M \to F_{0} \to F_{1}$ with $F_{i}$ finite and free.
	\end{enumerate}
\end{exe}
\begin{proof} 
	\phantom{h}
	\begin{enumerate}[label=(\alph*)]
		\item Suppose $M \into M^{\ast \ast}$. It suffices to show that $M^{\ast}$ is torsionfree for any $M$. \newline
		To this end, let $r \in R \setminus \mathcal{Z}(R)$ and $\varphi \in M^{\ast}$ be such that $r \varphi = 0$. Then, $r \varphi(m) = 0$ for all $m \in M$. Since $r$ is regular on $R$, it follows that $\varphi(m) = 0$ for all $m \in M$, as desired.
		%
		\item \forward Suppose that $M$ is torsionless

		\backward \claim{1} A submodule of a torsionless module is torsionless.
		\begin{proof} 
			Let $N \le M$ be modules with $M$ torsionless. Let $x \in N$ be nonzero. Then, there exists $\varphi \in M^{\ast}$ with $\varphi(x) \neq 0$. Consequently, $\psi \vcentcolon= \varphi|_{N} \in N^{\ast}$ satisfies $\psi(x) \neq 0$, as desired.
		\end{proof}

		\claim{2} Any finite free module $F$ is torsionless.
		\begin{proof} 
			Let $\{e_{i}\}_{i}$ be a basis for $F$. Then, there exists a dual basis $\{e_{i}^{\ast}\}_{i}$ for $F^{\ast}$. Now, given $x \in F \setminus \{0\}$, we can write $x = \sum a_{i} e_{i}$ with some $a_{i}$ nonzero. Then,
			\begin{equation*} 
				e_{i}^{\ast}(x) = a_{i} \neq 0. \qedhere
			\end{equation*}
		\end{proof}
	\end{enumerate}
\end{proof}

\newpage
\input{appendix}

\end{document}